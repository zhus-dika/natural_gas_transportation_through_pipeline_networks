(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    434099,       9431]
NotebookOptionsPosition[    433714,       9416]
NotebookOutlinePosition[    434140,       9433]
CellTagsIndexPosition[    434097,       9430]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
     "**"}], "******)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"writeDataToDataInfo", "[", 
      RowBox[{"direction_", ",", "arrNo_", ",", "arrData_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"len", "=", 
          RowBox[{"Length", "[", "arrNo", "]"}]}], ",", "k"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"k", "=", "1"}], ",", 
          RowBox[{"k", "<=", "len"}], ",", 
          RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"dataInfo", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"direction", "+", "1"}], ",", 
               RowBox[{"arrNo", "[", 
                RowBox[{"[", "k", "]"}], "]"}]}], "]"}], "]"}], "=", 
            RowBox[{"arrData", "[", 
             RowBox[{"[", "k", "]"}], "]"}]}], ";"}]}], "\[IndentingNewLine]",
          "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", 
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**"}], "******)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"writeTemperatures", "[", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"direction", ",", 
         RowBox[{"TstartArr", "=", 
          RowBox[{"{", "}"}]}], ",", 
         RowBox[{"TendArr", "=", 
          RowBox[{"{", "}"}]}], ",", "T"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"direction", "=", "1"}], ",", 
          RowBox[{"direction", "<=", "numDirections"}], ",", 
          RowBox[{"direction", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"T", "=", 
            RowBox[{"totalData", "[", 
             RowBox[{"direction", ",", "\"\<Tstart\>\""}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"TstartArr", "=", 
            RowBox[{"Insert", "[", 
             RowBox[{"TstartArr", ",", "T", ",", 
              RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"T", "=", 
            RowBox[{"totalData", "[", 
             RowBox[{"direction", ",", "\"\<Tend\>\""}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"TendArr", "=", 
            RowBox[{"Insert", "[", 
             RowBox[{"TendArr", ",", "T", ",", 
              RowBox[{"-", "1"}]}], "]"}]}], ";"}]}], "\[IndentingNewLine]", 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"{", 
          RowBox[{"TstartArr", ",", "TendArr"}], "}"}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", 
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**"}], "******)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"writePressures", "[", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"direction", ",", 
         RowBox[{"PstartArr", "=", 
          RowBox[{"{", "}"}]}], ",", 
         RowBox[{"PendArr", "=", 
          RowBox[{"{", "}"}]}], ",", "p"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"direction", "=", "1"}], ",", 
          RowBox[{"direction", "<=", "numDirections"}], ",", 
          RowBox[{"direction", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"p", "=", 
            RowBox[{"totalData", "[", 
             RowBox[{"direction", ",", "\"\<Pstart\>\""}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"PstartArr", "=", 
            RowBox[{"Insert", "[", 
             RowBox[{"PstartArr", ",", "p", ",", 
              RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"p", "=", 
            RowBox[{"totalData", "[", 
             RowBox[{"direction", ",", "\"\<Pend\>\""}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"PendArr", "=", 
            RowBox[{"Insert", "[", 
             RowBox[{"PendArr", ",", "p", ",", 
              RowBox[{"-", "1"}]}], "]"}]}], ";"}]}], "\[IndentingNewLine]", 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"{", 
          RowBox[{"PstartArr", ",", "PendArr"}], "}"}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", 
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**"}], "******)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"writeMassFluxes", "[", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"direction", ",", 
         RowBox[{"MstartArr", "=", 
          RowBox[{"{", "}"}]}], ",", 
         RowBox[{"MendArr", "=", 
          RowBox[{"{", "}"}]}], ",", "M"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"direction", "=", "1"}], ",", 
          RowBox[{"direction", "<=", "numDirections"}], ",", 
          RowBox[{"direction", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"M", "=", 
            RowBox[{"totalData", "[", 
             RowBox[{"direction", ",", "\"\<Mstart\>\""}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"MstartArr", "=", 
            RowBox[{"Insert", "[", 
             RowBox[{"MstartArr", ",", "M", ",", 
              RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"M", "=", 
            RowBox[{"totalData", "[", 
             RowBox[{"direction", ",", "\"\<Mend\>\""}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"MendArr", "=", 
            RowBox[{"Insert", "[", 
             RowBox[{"MendArr", ",", "M", ",", 
              RowBox[{"-", "1"}]}], "]"}]}], ";"}]}], "\[IndentingNewLine]", 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"{", 
          RowBox[{"MstartArr", ",", "MendArr"}], "}"}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", 
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**"}], "******)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"updateTotalData", "[", "iter_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "m", ",", "len", ",", "direction", ",", "M", ",", "rhon", ",", 
         "Rspecific", ",", "Z", ",", "rho", ",", "p", ",", "T"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"len", "=", 
         RowBox[{"Length", "[", "inDirections", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"m", "=", "1"}], ",", 
          RowBox[{"m", "<=", "len"}], ",", 
          RowBox[{"m", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"direction", "=", 
            RowBox[{"inDirections", "[", 
             RowBox[{"[", "m", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"get", " ", "data", " ", "from", " ", "totalData"}], 
            "*)"}], "\[IndentingNewLine]", 
           RowBox[{"rhon", "=", 
            RowBox[{"totalData", "[", 
             RowBox[{"direction", ",", "\"\<rhon\>\""}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Rspecific", "=", 
            RowBox[{"totalData", "[", 
             RowBox[{"direction", ",", "\"\<Rspecific\>\""}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"update", " ", "totalData"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"totalData", "[", 
             RowBox[{"direction", ",", "\"\<Q\>\""}], "]"}], "=", 
            RowBox[{
             RowBox[{
              RowBox[{"splineQIns", "[", 
               RowBox[{"[", "m", "]"}], "]"}], "[", 
              RowBox[{"tau", "*", 
               RowBox[{"iter", "/", 
                RowBox[{"(", 
                 RowBox[{"24", "*", "3600"}], ")"}]}]}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"totalData", "[", 
             RowBox[{"direction", ",", "\"\<Mstart\>\""}], "]"}], "=", 
            RowBox[{
             RowBox[{
              RowBox[{"totalData", "[", 
               RowBox[{"direction", ",", "\"\<Q\>\""}], "]"}], "*", 
              RowBox[{"rhon", "/", "3600"}]}], "//", "N"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"totalData", "[", 
             RowBox[{"direction", ",", "\"\<Mend\>\""}], "]"}], "=", 
            RowBox[{"totalData", "[", 
             RowBox[{"direction", ",", "\"\<Mstart\>\""}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"totalData", "[", 
             RowBox[{"direction", ",", "\"\<Pstart\>\""}], "]"}], "=", 
            RowBox[{
             RowBox[{
              RowBox[{"splinePIns", "[", 
               RowBox[{"[", "m", "]"}], "]"}], "[", 
              RowBox[{"tau", "*", 
               RowBox[{"iter", "/", 
                RowBox[{"(", 
                 RowBox[{"24", "*", "3600"}], ")"}]}]}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"totalData", "[", 
             RowBox[{"direction", ",", "\"\<Tstart\>\""}], "]"}], "=", 
            RowBox[{
             RowBox[{
              RowBox[{"splineTIns", "[", 
               RowBox[{"[", "m", "]"}], "]"}], "[", 
              RowBox[{"tau", "*", 
               RowBox[{"iter", "/", 
                RowBox[{"(", 
                 RowBox[{"24", "*", "3600"}], ")"}]}]}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"p", "=", 
            RowBox[{"kg2pa", "[", 
             RowBox[{"totalData", "[", 
              RowBox[{"direction", ",", "\"\<Pstart\>\""}], "]"}], "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"T", "=", 
            RowBox[{
             RowBox[{"totalData", "[", 
              RowBox[{"direction", ",", "\"\<Tstart\>\""}], "]"}], "+", 
             "273.15"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"Z", "=", 
            RowBox[{"calculateZ", "[", 
             RowBox[{"rhon", ",", 
              RowBox[{"p", "*", 
               RowBox[{"10", "^", 
                RowBox[{"(", 
                 RowBox[{"-", "6"}], ")"}]}]}], ",", "T", ",", "Rspecific"}], 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"rho", "=", 
            RowBox[{"p", "/", 
             RowBox[{"(", 
              RowBox[{"Z", "*", "Rspecific", "*", "T"}], ")"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"totalData", "[", 
             RowBox[{"direction", ",", "\"\<rhostart\>\""}], "]"}], "=", 
            "rho"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"len", "=", 
         RowBox[{"Length", "[", "outDirections", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"m", "=", "1"}], ",", 
          RowBox[{"m", "<=", "len"}], ",", 
          RowBox[{"m", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"direction", "=", 
            RowBox[{"outDirections", "[", 
             RowBox[{"[", "m", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"get", " ", "data", " ", "from", " ", "totalData"}], 
            "*)"}], "\[IndentingNewLine]", 
           RowBox[{"rhon", "=", 
            RowBox[{"totalData", "[", 
             RowBox[{"direction", ",", "\"\<rhon\>\""}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Rspecific", "=", 
            RowBox[{"totalData", "[", 
             RowBox[{"direction", ",", "\"\<Rspecific\>\""}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"update", " ", "totalData"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"totalData", "[", 
             RowBox[{"direction", ",", "\"\<Q\>\""}], "]"}], "=", 
            RowBox[{
             RowBox[{
              RowBox[{"splineQOuts", "[", 
               RowBox[{"[", "m", "]"}], "]"}], "[", 
              RowBox[{"tau", "*", 
               RowBox[{"iter", "/", 
                RowBox[{"(", 
                 RowBox[{"24", "*", "3600"}], ")"}]}]}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"totalData", "[", 
             RowBox[{"direction", ",", "\"\<Mstart\>\""}], "]"}], "=", 
            RowBox[{
             RowBox[{
              RowBox[{"totalData", "[", 
               RowBox[{"direction", ",", "\"\<Q\>\""}], "]"}], "*", 
              RowBox[{"rhon", "/", "3600"}]}], "//", "N"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"totalData", "[", 
             RowBox[{"direction", ",", "\"\<Mend\>\""}], "]"}], "=", 
            RowBox[{"totalData", "[", 
             RowBox[{"direction", ",", "\"\<Mstart\>\""}], "]"}]}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", 
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**"}], "******)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"updateDataTable", "[", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"m", ",", "len", ",", "direction"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"len", "=", 
         RowBox[{"Length", "[", "inDirections", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"m", "=", "1"}], ",", 
          RowBox[{"m", "<=", "len"}], ",", 
          RowBox[{"m", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"direction", "=", 
            RowBox[{"inDirections", "[", 
             RowBox[{"[", "m", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"writeDataToDataInfo", "[", 
            RowBox[{"direction", ",", 
             RowBox[{"{", 
              RowBox[{
              "5", ",", "17", ",", "18", ",", "3", ",", "4", ",", "15"}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"totalData", "[", 
                RowBox[{"direction", ",", "\"\<Q\>\""}], "]"}], ",", 
               RowBox[{"totalData", "[", 
                RowBox[{"direction", ",", "\"\<Mstart\>\""}], "]"}], ",", 
               RowBox[{"totalData", "[", 
                RowBox[{"direction", ",", "\"\<Mend\>\""}], "]"}], ",", 
               RowBox[{"totalData", "[", 
                RowBox[{"direction", ",", "\"\<Pstart\>\""}], "]"}], ",", 
               RowBox[{"totalData", "[", 
                RowBox[{"direction", ",", "\"\<Tstart\>\""}], "]"}], ",", 
               RowBox[{"totalData", "[", 
                RowBox[{"direction", ",", "\"\<rhostart\>\""}], "]"}]}], 
              "}"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"len", "=", 
         RowBox[{"Length", "[", "outDirections", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"m", "=", "1"}], ",", 
          RowBox[{"m", "<=", "len"}], ",", 
          RowBox[{"m", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"direction", "=", 
            RowBox[{"outDirections", "[", 
             RowBox[{"[", "m", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"writeDataToDataInfo", "[", 
            RowBox[{"direction", ",", 
             RowBox[{"{", 
              RowBox[{"5", ",", "17", ",", "18"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"totalData", "[", 
                RowBox[{"direction", ",", "\"\<Q\>\""}], "]"}], ",", 
               RowBox[{"totalData", "[", 
                RowBox[{"direction", ",", "\"\<Mstart\>\""}], "]"}], ",", 
               RowBox[{"totalData", "[", 
                RowBox[{"direction", ",", "\"\<Mend\>\""}], "]"}]}], "}"}]}], 
            "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", 
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**"}], "******)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"forwardProcedure", "[", 
      RowBox[{"m_", ",", 
       RowBox[{"(*", 
        RowBox[{"total", " ", "data"}], "*)"}], "directions_", ",", 
       "distances_", ",", "diameters_", ",", "kLCoef_", ",", "TSoilValues_", 
       ",", "hydraulicResistance_", ",", "M_", ",", 
       RowBox[{"(*", 
        RowBox[{"gas", " ", "properties"}], "*)"}], "rhon_", ",", 
       "Rspecific_", ",", "p1_", ",", "T1_", ",", "roughness_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "p2", ",", "T2", ",", "mu", ",", "L", ",", "Diaminner", ",", "kL", 
         ",", "Tsoil", ",", "S", ",", "Reyn", ",", "f", ",", "n", ",", 
         RowBox[{"k", "=", "roughness"}], ",", "Zcurrent", ",", "cp", ",", 
         "beta", ",", "JouleThomsonCoef", ",", "Kcoef", ",", "nLIM", ",", 
         RowBox[{"p11", "=", "p1"}], ",", 
         RowBox[{"T11", "=", "T1"}], ",", "rho"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"nLIM", "=", 
         RowBox[{"Length", "[", 
          RowBox[{"directions", "[", 
           RowBox[{"[", "m", "]"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"totalData", "[", 
          RowBox[{"m", ",", "\"\<T\>\"", ",", "1"}], "]"}], "=", 
         RowBox[{"T1", "-", "273.15"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"totalData", "[", 
          RowBox[{"m", ",", "\"\<P\>\"", ",", "1"}], "]"}], "=", 
         RowBox[{"pa2kg", "[", "p1", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
           RowBox[{"++", 
            RowBox[{"++", 
             RowBox[{"++", "Main"}]}]}], " ", 
           RowBox[{
            RowBox[{"calculations", "++"}], "++"}]}], "+"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "Print", "[", 
           "\"\<***********************************************\>\"", "]"}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<        \>\"", ",", 
            RowBox[{"directions", "[", 
             RowBox[{"[", "m", "]"}], "]"}], ",", "\"\<--direction\>\""}], 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{
          "Print", "[", 
           "\"\<***********************************************\>\"", "]"}], 
          ";"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"p2", "=", "p11"}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"n", "=", "1"}], ",", 
          RowBox[{"n", "<", "nLIM"}], ",", 
          RowBox[{"n", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"++", 
             RowBox[{"++", 
              RowBox[{"+", " ", "n"}]}]}], "-", 
            RowBox[{"th", " ", 
             RowBox[{
              RowBox[{"segment", " ", "++"}], "++"}]}], "+"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{
            "Print", "[", "\"\<--------------------------------\>\"", "]"}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"Print", "[", 
             RowBox[{"\"\<STEP: \>\"", ",", " ", 
              RowBox[{"directions", "[", 
               RowBox[{"[", 
                RowBox[{"m", ",", "n"}], "]"}], "]"}], ",", "\"\< --> \>\"", 
              ",", 
              RowBox[{"directions", "[", 
               RowBox[{"[", 
                RowBox[{"m", ",", 
                 RowBox[{"n", "+", "1"}]}], "]"}], "]"}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
            "Print", "[", "\"\<--------------------------------\>\"", "]"}], 
            ";"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"Set", " ", "data"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Diaminner", "=", 
            RowBox[{"diameters", "[", 
             RowBox[{
              RowBox[{"directions", "[", 
               RowBox[{"[", 
                RowBox[{"m", ",", "n"}], "]"}], "]"}], ",", 
              RowBox[{"directions", "[", 
               RowBox[{"[", 
                RowBox[{"m", ",", 
                 RowBox[{"n", "+", "1"}]}], "]"}], "]"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"L", "=", 
            RowBox[{"distances", "[", 
             RowBox[{
              RowBox[{"directions", "[", 
               RowBox[{"[", 
                RowBox[{"m", ",", "n"}], "]"}], "]"}], ",", 
              RowBox[{"directions", "[", 
               RowBox[{"[", 
                RowBox[{"m", ",", 
                 RowBox[{"n", "+", "1"}]}], "]"}], "]"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"kL", "=", 
            RowBox[{"kLCoef", "[", 
             RowBox[{
              RowBox[{"directions", "[", 
               RowBox[{"[", 
                RowBox[{"m", ",", "n"}], "]"}], "]"}], ",", 
              RowBox[{"directions", "[", 
               RowBox[{"[", 
                RowBox[{"m", ",", 
                 RowBox[{"n", "+", "1"}]}], "]"}], "]"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Tsoil", "=", 
            RowBox[{"273.15", "+", 
             RowBox[{"TSoilValues", "[", 
              RowBox[{
               RowBox[{"directions", "[", 
                RowBox[{"[", 
                 RowBox[{"m", ",", "n"}], "]"}], "]"}], ",", 
               RowBox[{"directions", "[", 
                RowBox[{"[", 
                 RowBox[{"m", ",", 
                  RowBox[{"n", "+", "1"}]}], "]"}], "]"}]}], "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"S", "=", 
            RowBox[{"Pi", "*", 
             RowBox[{
              RowBox[{"Diaminner", "^", "2"}], "/", "4"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Zcurrent", "=", 
            RowBox[{"calculateZ", "[", 
             RowBox[{"rhon", ",", 
              RowBox[{"p11", "*", 
               RowBox[{"10", "^", 
                RowBox[{"(", 
                 RowBox[{"-", "6"}], ")"}]}]}], ",", "T11", ",", 
              "Rspecific"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{"\"\<Z: \>\"", ",", "Zcurrent"}], "]"}], ";"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"Reyn", "=", 
            RowBox[{"calculateReynolds", "[", 
             RowBox[{"rhon", ",", "p11", ",", "T11", ",", "Rspecific", ",", 
              RowBox[{
               RowBox[{"M", "/", "rhon"}], "//", "N"}], ",", "Diaminner"}], 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"f", "=", 
            RowBox[{
             RowBox[{"calculateFanningFrictionFactor", "[", 
              RowBox[{"Reyn", ",", "k", ",", "Diaminner"}], "]"}], "+", 
             RowBox[{"hydraulicResistance", "[", 
              RowBox[{
               RowBox[{"directions", "[", 
                RowBox[{"[", 
                 RowBox[{"m", ",", "n"}], "]"}], "]"}], ",", 
               RowBox[{"directions", "[", 
                RowBox[{"[", 
                 RowBox[{"m", ",", 
                  RowBox[{"n", "+", "1"}]}], "]"}], "]"}]}], "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"cp", "=", 
            RowBox[{"calculateCp", "[", 
             RowBox[{"rhon", ",", 
              RowBox[{"p11", "*", 
               RowBox[{"10", "^", 
                RowBox[{"(", 
                 RowBox[{"-", "6"}], ")"}]}]}], ",", "T11", ",", 
              "Rspecific"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"beta", "=", 
            RowBox[{"kL", "/", 
             RowBox[{"(", 
              RowBox[{"cp", "*", "M"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"JouleThomsonCoef", "=", 
            RowBox[{"calculateJouleThomsonCoef", "[", 
             RowBox[{"T11", ",", "cp"}], "]"}]}], ";", "\[IndentingNewLine]", 
           
           RowBox[{"T2", "=", 
            RowBox[{"Tsoil", "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"T11", "-", "Tsoil"}], ")"}], "*", 
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "beta"}], "*", "L"}], "]"}]}], "-", 
             RowBox[{"JouleThomsonCoef", "*", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"p11", "-", "p2"}], ")"}], "/", 
               RowBox[{"(", 
                RowBox[{"beta", "*", "L"}], ")"}]}], "*", 
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"Exp", "[", 
                 RowBox[{
                  RowBox[{"-", "beta"}], "*", "L"}], "]"}]}], ")"}]}]}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"totalData", "[", 
             RowBox[{"m", ",", "\"\<T\>\"", ",", 
              RowBox[{"n", "+", "1"}]}], "]"}], "=", 
            RowBox[{"T2", "-", "273.15"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{"\"\<Temperature in Kelvin: \>\"", ",", " ", "T2"}], 
              "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"Print", "[", 
              RowBox[{"\"\<Temperature in Celsius: \>\"", ",", " ", 
               RowBox[{"T2", "-", "273.15"}]}], "]"}], ";"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"Kcoef", "=", 
            RowBox[{"Zcurrent", "*", 
             RowBox[{"Rspecific", "/", 
              RowBox[{"S", "^", "2"}]}], "*", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"4", "*", 
                RowBox[{"f", "/", "Diaminner"}], "*", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Tsoil", "*", "L"}], "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"T11", "-", "Tsoil"}], ")"}], "/", "beta"}], "-", 
                  
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"T11", "-", "Tsoil"}], ")"}], "/", "beta"}], "*", 
                   
                   RowBox[{"Exp", "[", 
                    RowBox[{
                    RowBox[{"-", "beta"}], "*", "L"}], "]"}]}]}], ")"}]}], 
               "-", 
               RowBox[{"2", "*", 
                RowBox[{"(", 
                 RowBox[{"T11", "-", "T2"}], ")"}]}]}], ")"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"p2", "=", 
            RowBox[{
             RowBox[{"Sqrt", "[", 
              RowBox[{
               RowBox[{"p11", "^", "2"}], "-", 
               RowBox[{"Kcoef", "*", 
                RowBox[{"M", "^", "2"}]}]}], "]"}], "//", "N"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"totalData", "[", 
             RowBox[{"m", ",", "\"\<P\>\"", ",", 
              RowBox[{"n", "+", "1"}]}], "]"}], "=", 
            RowBox[{"pa2kg", "[", "p2", "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"rho", "=", 
            RowBox[{"p11", "/", 
             RowBox[{"(", 
              RowBox[{"Zcurrent", "*", "Rspecific", "*", "T11"}], ")"}]}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"totalData", "[", 
             RowBox[{"m", ",", "\"\<rho\>\"", ",", "n"}], "]"}], "=", "rho"}],
            ";", "\[IndentingNewLine]", 
           RowBox[{"Which", "[", 
            RowBox[{
             RowBox[{"n", "==", "1"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"totalData", "[", 
               RowBox[{"m", ",", "\"\<rhostart\>\""}], "]"}], "=", "rho"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"n", "==", 
              RowBox[{"nLIM", "-", "1"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"rho", "=", 
               RowBox[{"p2", "/", 
                RowBox[{"(", 
                 RowBox[{"Zcurrent", "*", "Rspecific", "*", "T2"}], ")"}]}]}],
               ";", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"totalData", "[", 
                RowBox[{"m", ",", "\"\<rhoend\>\""}], "]"}], "=", "rho"}], 
              ";", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"totalData", "[", 
                RowBox[{"m", ",", "\"\<rho\>\"", ",", "nLIM"}], "]"}], "=", 
               "rho"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{"\"\<Pressure Pa: \>\"", ",", " ", "p2"}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"Print", "[", 
              RowBox[{"\"\<Pressure kgs/cm2: \>\"", ",", " ", 
               RowBox[{"pa2kg", "[", "p2", "]"}]}], "]"}], ";"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"p11", "=", "p2"}], ";", "\[IndentingNewLine]", 
           RowBox[{"T11", "=", "T2"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"{", 
          RowBox[{"p2", ",", "T2"}], "}"}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", 
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**"}], "******)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"calculateOutDirections", "[", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "direction", ",", "Rspecific", ",", "rho", ",", "Z", ",", "rhon", ",",
          "p2", ",", "T2", ",", "p1", ",", "T1", ",", "M"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"direction", "=", "1"}], ",", 
          RowBox[{"direction", "<=", "numDirections"}], ",", 
          RowBox[{"direction", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"totalData", "[", 
               RowBox[{"direction", ",", "\"\<Type\>\""}], "]"}], "==", 
              "\"\<out\>\""}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"rhon", "=", 
               RowBox[{"totalData", "[", 
                RowBox[{"direction", ",", "\"\<rhon\>\""}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"Rspecific", "=", 
               RowBox[{"totalData", "[", 
                RowBox[{"direction", ",", "\"\<Rspecific\>\""}], "]"}]}], ";",
               "\[IndentingNewLine]", 
              RowBox[{"M", "=", 
               RowBox[{"totalData", "[", 
                RowBox[{"direction", ",", "\"\<Mstart\>\""}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"p1", "=", 
               RowBox[{"kg2pa", "[", 
                RowBox[{"totalData", "[", 
                 RowBox[{"direction", ",", "\"\<Pstart\>\""}], "]"}], "]"}]}],
               ";", "\[IndentingNewLine]", 
              RowBox[{"T1", "=", 
               RowBox[{
                RowBox[{"totalData", "[", 
                 RowBox[{"direction", ",", "\"\<Tstart\>\""}], "]"}], "+", 
                "273.15"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"p2", ",", "T2"}], "}"}], "=", 
               RowBox[{"forwardProcedure", "[", 
                RowBox[{
                "direction", ",", "directions", ",", "distances", ",", 
                 "diameters", ",", "kLCoef", ",", "TSoilValues", ",", 
                 "hydraulicResistance", ",", "M", ",", "rhon", ",", 
                 "Rspecific", ",", "p1", ",", "T1", ",", "kRoughness"}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"totalData", "[", 
                RowBox[{"direction", ",", "\"\<Tend\>\""}], "]"}], "=", 
               RowBox[{"T2", "-", "273.15"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"totalData", "[", 
                RowBox[{"direction", ",", "\"\<Pend\>\""}], "]"}], "=", 
               RowBox[{"pa2kg", "[", "p2", "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"writeDataToDataInfo", "[", 
               RowBox[{"direction", ",", 
                RowBox[{"{", 
                 RowBox[{"16", ",", "7", ",", "8"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"totalData", "[", 
                   RowBox[{"direction", ",", "\"\<rhoend\>\""}], "]"}], ",", 
                  RowBox[{"totalData", "[", 
                   RowBox[{"direction", ",", "\"\<Pend\>\""}], "]"}], ",", 
                  RowBox[{"totalData", "[", 
                   RowBox[{"direction", ",", "\"\<Tend\>\""}], "]"}]}], 
                 "}"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", 
            "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
         "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", 
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**"}], "******)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"gasMixingTemperature", "[", "mixThetaDirections_", "]"}], ":=", 
     
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"len", "=", 
          RowBox[{"Length", "[", "mixThetaDirections", "]"}]}], ",", "lenDir",
          ",", "k", ",", "l", ",", "direction", ",", 
         RowBox[{"MArr", "=", 
          RowBox[{"{", "}"}]}], ",", 
         RowBox[{"sum", "=", "0"}], ",", 
         RowBox[{"TResult", "=", "0"}], ",", 
         RowBox[{"TResultSum", "=", "0"}], ",", "gasFraction", ",", "cp", ",",
          "TValue", ",", "commonStartPoint"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"k", "=", "1"}], ",", 
          RowBox[{"k", "<=", "len"}], ",", 
          RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"direction", "=", 
            RowBox[{"mixThetaDirections", "[", 
             RowBox[{"[", "k", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"MArr", "=", 
            RowBox[{"Insert", "[", 
             RowBox[{"MArr", ",", 
              RowBox[{"totalData", "[", 
               RowBox[{"direction", ",", "\"\<Mend\>\""}], "]"}], ",", 
              RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"sum", "+=", 
            RowBox[{"MArr", "[", 
             RowBox[{"[", "k", "]"}], "]"}]}], ";"}]}], "\[IndentingNewLine]",
          "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"k", "=", "1"}], ",", 
          RowBox[{"k", "<=", "len"}], ",", 
          RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"direction", "=", 
            RowBox[{"mixThetaDirections", "[", 
             RowBox[{"[", "k", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"lenDir", "=", 
            RowBox[{"Length", "[", 
             RowBox[{"directions", "[", 
              RowBox[{"[", "direction", "]"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"gasFraction", "=", 
            RowBox[{
             RowBox[{"MArr", "[", 
              RowBox[{"[", "k", "]"}], "]"}], "/", "sum"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"TValue", "=", 
            RowBox[{
             RowBox[{"totalData", "[", 
              RowBox[{"direction", ",", "\"\<T\>\"", ",", "lenDir"}], "]"}], 
             "+", "273.15"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"cp", "=", 
            RowBox[{"calculateCp", "[", 
             RowBox[{
              RowBox[{"totalData", "[", 
               RowBox[{"direction", ",", "\"\<rhon\>\""}], "]"}], ",", 
              RowBox[{
               RowBox[{"kg2pa", "[", 
                RowBox[{"totalData", "[", 
                 RowBox[{"direction", ",", "\"\<Pend\>\""}], "]"}], "]"}], 
               "*", 
               RowBox[{"10", "^", 
                RowBox[{"(", 
                 RowBox[{"-", "6"}], ")"}]}]}], ",", "TValue", ",", 
              RowBox[{"totalData", "[", 
               RowBox[{"direction", ",", "\"\<Rspecific\>\""}], "]"}]}], 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"TResult", "+=", 
            RowBox[{"gasFraction", "*", "cp", "*", "TValue"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"TResultSum", "+=", 
            RowBox[{"gasFraction", "*", "cp"}]}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"TValue", "=", 
         RowBox[{"TResult", "/", "TResultSum"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "write", " ", "result", " ", "temperature", " ", "in", " ", 
          "totalData", " ", "and", " ", "in", " ", "the", " ", "table"}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"direction", "=", 
         RowBox[{"mixThetaDirections", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"commonStartPoint", "=", 
         RowBox[{"commonTotalStartPoint", "[", 
          RowBox[{"[", "direction", "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"len", "=", 
         RowBox[{"Length", "[", "commonStartPoint", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"k", "=", "1"}], ",", 
          RowBox[{"k", "<=", "len"}], ",", 
          RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"direction", "=", 
            RowBox[{"commonStartPoint", "[", 
             RowBox[{"[", "k", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"totalData", "[", 
             RowBox[{"direction", ",", "\"\<Tstart\>\""}], "]"}], "=", 
            RowBox[{"TValue", "-", "273.15"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"totalData", "[", 
             RowBox[{"direction", ",", "\"\<T\>\"", ",", "1"}], "]"}], "=", 
            RowBox[{"totalData", "[", 
             RowBox[{"direction", ",", "\"\<Tstart\>\""}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"writeDataToDataInfo", "[", 
            RowBox[{"direction", ",", 
             RowBox[{"{", "4", "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"totalData", "[", 
               RowBox[{"direction", ",", "\"\<Tstart\>\""}], "]"}], "}"}]}], 
            "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", 
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**"}], "******)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"printData", "[", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"k", ",", "l", ",", "direction", ",", "lenDir", ",", 
         RowBox[{"thetaSpace", "=", 
          RowBox[{"{", "}"}]}], ",", 
         RowBox[{"rhoSpace", "=", 
          RowBox[{"{", "}"}]}], ",", 
         RowBox[{"pSpace", "=", 
          RowBox[{"{", "}"}]}], ",", "p", ",", "theta", ",", "rho"}], "}"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"direction", "=", "1"}], ",", 
          RowBox[{"direction", "<=", "numDirections"}], ",", 
          RowBox[{"direction", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"lenDir", "=", 
            RowBox[{"Length", "[", 
             RowBox[{"directions", "[", 
              RowBox[{"[", "direction", "]"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"thetaSpace", "=", 
            RowBox[{"{", "}"}]}], ";", 
           RowBox[{"rhoSpace", "=", 
            RowBox[{"{", "}"}]}], ";", 
           RowBox[{"pSpace", "=", 
            RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"k", "=", "1"}], ",", 
             RowBox[{"k", "<=", "lenDir"}], ",", 
             RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"p", "=", 
               RowBox[{"totalData", "[", 
                RowBox[{"direction", ",", "\"\<P\>\"", ",", "k"}], "]"}]}], 
              ";", "\[IndentingNewLine]", 
              RowBox[{"theta", "=", 
               RowBox[{"totalData", "[", 
                RowBox[{"direction", ",", "\"\<T\>\"", ",", "k"}], "]"}]}], 
              ";", "\[IndentingNewLine]", 
              RowBox[{"rho", "=", 
               RowBox[{"totalData", "[", 
                RowBox[{"direction", ",", "\"\<rho\>\"", ",", "k"}], "]"}]}], 
              ";", "\[IndentingNewLine]", 
              RowBox[{"pSpace", "=", 
               RowBox[{"Insert", "[", 
                RowBox[{"pSpace", ",", "p", ",", 
                 RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"thetaSpace", "=", 
               RowBox[{"Insert", "[", 
                RowBox[{"thetaSpace", ",", "theta", ",", 
                 RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"rhoSpace", "=", 
               RowBox[{"Insert", "[", 
                RowBox[{"rhoSpace", ",", "rho", ",", 
                 RowBox[{"-", "1"}]}], "]"}]}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<direction-\>\"", ",", "direction"}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<pSpace=\>\"", ",", "pSpace"}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<thetaSpace=\>\"", ",", "thetaSpace"}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<rhoSpace=\>\"", ",", "rhoSpace"}], "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", 
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**"}], "******)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"calculateDynamicParams", "[", 
      RowBox[{
      "direction_", ",", "vCoef_", ",", "tau_", ",", "thetaSpace_", ",", 
       "rhoSpace_", ",", "MSpace_", ",", "pSpace_", ",", "display_"}], "]"}], 
     ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"a", "=", 
          RowBox[{"{", "}"}]}], ",", 
         RowBox[{"b", "=", 
          RowBox[{"{", "}"}]}], ",", 
         RowBox[{"d", "=", 
          RowBox[{"{", "}"}]}], ",", 
         RowBox[{"f", "=", 
          RowBox[{"{", "}"}]}], ",", "nSpace", ",", "k", ",", 
         "thetaSpaceArrPrev", ",", "thetaSpaceArr", ",", "rhoSpaceArr", ",", 
         "pSpaceArr", ",", "MSpaceArr", ",", "hSpaceArr", ",", "distance", 
         ",", "Z", ",", "wHat", ",", "thetaTildeBar", ",", "Z1", ",", "Z2", 
         ",", "wTildezSquared", ",", "rhoTilde", ",", "cP", ",", "beta", ",", 
         "betaCoef", ",", "thetaTilde", ",", "deltaTheta", ",", 
         "deltaThetaBar", ",", "deltaHValue", ",", "rhoHatOverWZSquared", ",",
          "Reyn", ",", "lambda", ",", "alpha1", ",", "alpha2", ",", "bStar", 
         ",", "r", ",", "rBar", ",", "vFraction", ",", "aCoef", ",", "fCoef", 
         ",", "dCoef", ",", "eCoef", ",", "S", ",", "S2", ",", "Rspecific", 
         ",", "diamInner", ",", "rhon", ",", "TSoilValue", ",", 
         "kLCoefValue"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"nSpace", "=", 
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{"directions", "[", 
            RowBox[{"[", "direction", "]"}], "]"}], "]"}], "-", "1"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"thetaSpaceArrPrev", "=", "thetaSpace"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"thetaSpaceArr", "=", "thetaSpace"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"rhoSpaceArr", "=", "rhoSpace"}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"MSpaceArr", "=", "MSpace"}], ";", "\[IndentingNewLine]", 
        RowBox[{"pSpaceArr", "=", "pSpace"}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"k", "=", "1"}], ",", 
          RowBox[{"k", "<=", "nSpace"}], ",", 
          RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Rspecific", "=", 
            RowBox[{"totalData", "[", 
             RowBox[{"direction", ",", "\"\<Rspecific\>\""}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"diamInner", "=", 
            RowBox[{"diameters", "[", 
             RowBox[{
              RowBox[{"directions", "[", 
               RowBox[{"[", 
                RowBox[{"direction", ",", "k"}], "]"}], "]"}], ",", 
              RowBox[{"directions", "[", 
               RowBox[{"[", 
                RowBox[{"direction", ",", 
                 RowBox[{"k", "+", "1"}]}], "]"}], "]"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"deltaHValue", "=", 
            RowBox[{"deltaH", "[", 
             RowBox[{
              RowBox[{"directions", "[", 
               RowBox[{"[", 
                RowBox[{"direction", ",", "k"}], "]"}], "]"}], ",", 
              RowBox[{"directions", "[", 
               RowBox[{"[", 
                RowBox[{"direction", ",", 
                 RowBox[{"k", "+", "1"}]}], "]"}], "]"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"S", "=", 
            RowBox[{
             RowBox[{"Pi", "*", 
              RowBox[{
               RowBox[{"diamInner", "^", "2"}], "/", "4"}]}], "//", "N"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"k", ">", "1"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"diamInner", "=", 
               RowBox[{"diameters", "[", 
                RowBox[{
                 RowBox[{"directions", "[", 
                  RowBox[{"[", 
                   RowBox[{"direction", ",", 
                    RowBox[{"k", "-", "1"}]}], "]"}], "]"}], ",", 
                 RowBox[{"directions", "[", 
                  RowBox[{"[", 
                   RowBox[{"direction", ",", "k"}], "]"}], "]"}]}], "]"}]}], 
              ";", "\[IndentingNewLine]", 
              RowBox[{"distance", "=", 
               RowBox[{"distances", "[", 
                RowBox[{
                 RowBox[{"directions", "[", 
                  RowBox[{"[", 
                   RowBox[{"direction", ",", 
                    RowBox[{"k", "-", "1"}]}], "]"}], "]"}], ",", 
                 RowBox[{"directions", "[", 
                  RowBox[{"[", 
                   RowBox[{"direction", ",", "k"}], "]"}], "]"}]}], "]"}]}], 
              ";", "\[IndentingNewLine]", 
              RowBox[{"S2", "=", 
               RowBox[{
                RowBox[{"Pi", "*", 
                 RowBox[{
                  RowBox[{"diamInner", "^", "2"}], "/", "4"}]}], "//", 
                "N"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"distance", "=", 
               RowBox[{"distances", "[", 
                RowBox[{
                 RowBox[{"directions", "[", 
                  RowBox[{"[", 
                   RowBox[{"direction", ",", "k"}], "]"}], "]"}], ",", 
                 RowBox[{"directions", "[", 
                  RowBox[{"[", 
                   RowBox[{"direction", ",", 
                    RowBox[{"k", "+", "1"}]}], "]"}], "]"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"beta", "=", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"S", "+", "S2"}], ")"}], "/", "2"}], "//", 
                "N"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"distance", "=", 
               RowBox[{"distances", "[", 
                RowBox[{
                 RowBox[{"directions", "[", 
                  RowBox[{"[", 
                   RowBox[{"direction", ",", "k"}], "]"}], "]"}], ",", 
                 RowBox[{"directions", "[", 
                  RowBox[{"[", 
                   RowBox[{"direction", ",", 
                    RowBox[{"k", "+", "1"}]}], "]"}], "]"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"beta", "=", 
               RowBox[{"distance", "*", "S"}]}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"rhon", "=", 
            RowBox[{"totalData", "[", 
             RowBox[{"direction", ",", "\"\<rhon\>\""}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"TSoilValue", "=", 
            RowBox[{
             RowBox[{"TSoilValues", "[", 
              RowBox[{
               RowBox[{"directions", "[", 
                RowBox[{"[", 
                 RowBox[{"direction", ",", "k"}], "]"}], "]"}], ",", 
               RowBox[{"directions", "[", 
                RowBox[{"[", 
                 RowBox[{"direction", ",", 
                  RowBox[{"k", "+", "1"}]}], "]"}], "]"}]}], "]"}], "+", 
             "273.15"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"kLCoefValue", "=", 
            RowBox[{"kLCoef", "[", 
             RowBox[{
              RowBox[{"directions", "[", 
               RowBox[{"[", 
                RowBox[{"direction", ",", "k"}], "]"}], "]"}], ",", 
              RowBox[{"directions", "[", 
               RowBox[{"[", 
                RowBox[{"direction", ",", 
                 RowBox[{"k", "+", "1"}]}], "]"}], "]"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"wHat", "=", 
            RowBox[{
             RowBox[{"MSpaceArr", "[", 
              RowBox[{"[", "k", "]"}], "]"}], "/", 
             RowBox[{"(", 
              RowBox[{"S", "*", 
               RowBox[{"rhoSpaceArr", "[", 
                RowBox[{"[", "k", "]"}], "]"}]}], ")"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"thetaTildeBar", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"thetaSpaceArr", "[", 
                 RowBox[{"[", "k", "]"}], "]"}], "+", 
                RowBox[{"thetaSpaceArr", "[", 
                 RowBox[{"[", 
                  RowBox[{"k", "+", "1"}], "]"}], "]"}]}], ")"}], "/", "2"}], 
             "//", "N"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"Z1", "=", 
            RowBox[{"calculateZ", "[", 
             RowBox[{"rhon", ",", 
              RowBox[{
               RowBox[{"pSpaceArr", "[", 
                RowBox[{"[", "k", "]"}], "]"}], "*", 
               RowBox[{"10", "^", 
                RowBox[{"(", 
                 RowBox[{"-", "6"}], ")"}]}]}], ",", 
              RowBox[{"thetaSpaceArr", "[", 
               RowBox[{"[", "k", "]"}], "]"}], ",", "Rspecific"}], "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"Z2", "=", 
            RowBox[{"calculateZ", "[", 
             RowBox[{"rhon", ",", 
              RowBox[{
               RowBox[{"pSpaceArr", "[", 
                RowBox[{"[", 
                 RowBox[{"k", "+", "1"}], "]"}], "]"}], "*", 
               RowBox[{"10", "^", 
                RowBox[{"(", 
                 RowBox[{"-", "6"}], ")"}]}]}], ",", 
              RowBox[{"thetaSpaceArr", "[", 
               RowBox[{"[", 
                RowBox[{"k", "+", "1"}], "]"}], "]"}], ",", "Rspecific"}], 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"wTildezSquared", "=", 
            RowBox[{
            "Rspecific", "*", "thetaTildeBar", "*", "Z1", "*", "Z2"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"rhoTilde", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"rhoSpaceArr", "[", 
                 RowBox[{"[", "k", "]"}], "]"}], "+", 
                RowBox[{"rhoSpaceArr", "[", 
                 RowBox[{"[", 
                  RowBox[{"k", "+", "1"}], "]"}], "]"}]}], ")"}], "/", "2"}], 
             "//", "N"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"pSpaceArr", "[", 
             RowBox[{"[", "k", "]"}], "]"}], "=", 
            RowBox[{"Rspecific", "*", 
             RowBox[{"rhoSpaceArr", "[", 
              RowBox[{"[", "k", "]"}], "]"}], "*", 
             RowBox[{"thetaSpaceArr", "[", 
              RowBox[{"[", "k", "]"}], "]"}], "*", "Z1"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"pSpaceArr", "[", 
             RowBox[{"[", 
              RowBox[{"k", "+", "1"}], "]"}], "]"}], "=", 
            RowBox[{"Rspecific", "*", 
             RowBox[{"rhoSpaceArr", "[", 
              RowBox[{"[", 
               RowBox[{"k", "+", "1"}], "]"}], "]"}], "*", 
             RowBox[{"thetaSpaceArrPrev", "[", 
              RowBox[{"[", 
               RowBox[{"k", "+", "1"}], "]"}], "]"}], "*", "Z2"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"cP", "=", 
            RowBox[{"calculateCp", "[", 
             RowBox[{"rhon", ",", 
              RowBox[{
               RowBox[{"pSpaceArr", "[", 
                RowBox[{"[", "k", "]"}], "]"}], "*", 
               RowBox[{"10", "^", 
                RowBox[{"(", 
                 RowBox[{"-", "6"}], ")"}]}]}], ",", 
              RowBox[{"thetaSpaceArr", "[", 
               RowBox[{"[", "k", "]"}], "]"}], ",", "Rspecific"}], "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"betaCoef", "=", 
            RowBox[{"kLCoefValue", "/", 
             RowBox[{"(", 
              RowBox[{"cP", "*", 
               RowBox[{"MSpaceArr", "[", 
                RowBox[{"[", "k", "]"}], "]"}]}], ")"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"thetaSpaceArr", "[", 
             RowBox[{"[", 
              RowBox[{"k", "+", "1"}], "]"}], "]"}], "=", 
            RowBox[{"TSoilValue", "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"thetaSpaceArr", "[", 
                 RowBox[{"[", "k", "]"}], "]"}], "-", "TSoilValue"}], ")"}], 
              "*", 
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "betaCoef"}], "*", "distance"}], "]"}]}]}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"thetaTilde", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"thetaSpaceArr", "[", 
                 RowBox[{"[", "k", "]"}], "]"}], "+", 
                RowBox[{"thetaSpaceArr", "[", 
                 RowBox[{"[", 
                  RowBox[{"k", "+", "1"}], "]"}], "]"}]}], ")"}], "/", "2"}], 
             "//", "N"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"deltaTheta", "=", 
            RowBox[{
             RowBox[{"thetaSpaceArr", "[", 
              RowBox[{"[", 
               RowBox[{"k", "+", "1"}], "]"}], "]"}], "-", 
             RowBox[{"thetaSpaceArr", "[", 
              RowBox[{"[", "k", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
           
           RowBox[{"deltaThetaBar", "=", 
            RowBox[{
             RowBox[{"thetaSpaceArrPrev", "[", 
              RowBox[{"[", 
               RowBox[{"k", "+", "1"}], "]"}], "]"}], "-", 
             RowBox[{"thetaSpaceArrPrev", "[", 
              RowBox[{"[", "k", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
           
           RowBox[{"rhoHatOverWZSquared", "=", 
            RowBox[{
             RowBox[{"2", "*", 
              RowBox[{"rhoSpaceArr", "[", 
               RowBox[{"[", "k", "]"}], "]"}], "*", 
              RowBox[{
               RowBox[{"rhoSpaceArr", "[", 
                RowBox[{"[", 
                 RowBox[{"k", "+", "1"}], "]"}], "]"}], "/", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"pSpaceArr", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "+", 
                   RowBox[{"pSpaceArr", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", "+", "1"}], "]"}], "]"}]}], ")"}], "*", 
                 RowBox[{"Sqrt", "[", 
                  RowBox[{"Z1", "*", "Z2"}], "]"}]}], ")"}]}]}], "//", 
             "N"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"Reyn", "=", 
            RowBox[{"calculateReynolds", "[", 
             RowBox[{"rhon", ",", 
              RowBox[{"pSpaceArr", "[", 
               RowBox[{"[", "k", "]"}], "]"}], ",", 
              RowBox[{"thetaSpaceArr", "[", 
               RowBox[{"[", "k", "]"}], "]"}], ",", "Rspecific", ",", 
              RowBox[{
               RowBox[{"MSpaceArr", "[", 
                RowBox[{"[", "k", "]"}], "]"}], "/", "rhon"}], ",", 
              "diamInner"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"lambda", "=", 
            RowBox[{"lambdaCoef", "*", 
             RowBox[{"Re", "[", 
              RowBox[{"calculateFanningFrictionFactor", "[", 
               RowBox[{"Reyn", ",", "kRoughness", ",", "diamInner"}], "]"}], 
              "]"}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"calculateFrictionFactorColebrookWhite", "[", 
              RowBox[{"Reyn", ",", "kRoughness", ",", "diamInner"}], "]"}], 
             ";"}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"alpha1", "=", 
            RowBox[{
             RowBox[{"lambda", "*", 
              RowBox[{"Abs", "[", "wHat", "]"}], "*", 
              RowBox[{"distance", "/", 
               RowBox[{"(", 
                RowBox[{
                "2", "*", "diamInner", "*", "S", "*", "wTildezSquared"}], 
                ")"}]}]}], "//", "N"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"alpha2", "=", 
            RowBox[{
             RowBox[{"distance", "/", 
              RowBox[{"(", 
               RowBox[{"S", "*", "wTildezSquared"}], ")"}]}], "//", "N"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"bStar", "=", 
            RowBox[{"calculateBStar", "[", 
             RowBox[{"rhon", ",", "Rspecific"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"r", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "gGrav"}], "*", "deltaHValue", "*", 
              "rhoHatOverWZSquared"}], "-", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"rhoTilde", "+", 
                RowBox[{"bStar", "*", 
                 RowBox[{"rhoSpaceArr", "[", 
                  RowBox[{"[", "k", "]"}], "]"}], "*", 
                 RowBox[{"rhoSpaceArr", "[", 
                  RowBox[{"[", 
                   RowBox[{"k", "+", "1"}], "]"}], "]"}]}]}], ")"}], "*", 
              RowBox[{"deltaThetaBar", "/", "thetaTildeBar"}]}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"rBar", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "gGrav"}], "*", "deltaHValue", "*", 
              "rhoHatOverWZSquared"}], "-", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"rhoTilde", "+", 
                RowBox[{"bStar", "*", 
                 RowBox[{"rhoSpaceArr", "[", 
                  RowBox[{"[", "k", "]"}], "]"}], "*", 
                 RowBox[{"rhoSpaceArr", "[", 
                  RowBox[{"[", 
                   RowBox[{"k", "+", "1"}], "]"}], "]"}]}]}], ")"}], "*", 
              RowBox[{"deltaTheta", "/", "thetaTilde"}]}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"vFraction", "=", 
            RowBox[{
             RowBox[{"vCoef", "/", 
              RowBox[{"(", 
               RowBox[{"1", "-", "vCoef"}], ")"}]}], "//", "N"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"aCoef", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"alpha2", "/", 
               RowBox[{"(", 
                RowBox[{"1", "-", "vCoef"}], ")"}]}], "/", "tau"}], "+", 
             "alpha1"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"fCoef", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"r", "+", "rBar"}], ")"}], "/", 
              RowBox[{"(", 
               RowBox[{"2", "*", 
                RowBox[{"(", 
                 RowBox[{"1", "-", "vCoef"}], ")"}]}], ")"}]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"alpha2", "/", 
                  RowBox[{"(", 
                   RowBox[{"1", "-", "vCoef"}], ")"}]}], "/", "tau"}], "+", 
                RowBox[{"vFraction", "*", "alpha1"}]}], ")"}], "*", 
              RowBox[{"MSpaceArr", "[", 
               RowBox[{"[", "k", "]"}], "]"}]}], "+", 
             RowBox[{"vFraction", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"rhoSpaceArr", "[", 
                 RowBox[{"[", "k", "]"}], "]"}], "-", 
                RowBox[{"rhoSpaceArr", "[", 
                 RowBox[{"[", 
                  RowBox[{"k", "+", "1"}], "]"}], "]"}]}], ")"}]}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"dCoef", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"beta", "/", 
               RowBox[{"(", 
                RowBox[{"1", "-", "vCoef"}], ")"}]}], "/", "tau"}], "//", 
             "N"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"k", "==", "1"}], ",", "\[IndentingNewLine]", 
             RowBox[{"f", "=", 
              RowBox[{"Insert", "[", 
               RowBox[{"f", ",", "fCoef", ",", 
                RowBox[{"-", "1"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"eCoef", "=", 
               RowBox[{
                RowBox[{"dCoef", "*", 
                 RowBox[{"rhoSpaceArr", "[", 
                  RowBox[{"[", "k", "]"}], "]"}]}], "+", 
                RowBox[{"vFraction", "*", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"MSpaceArr", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", "-", "1"}], "]"}], "]"}], "-", 
                   RowBox[{"MSpaceArr", "[", 
                    RowBox[{"[", "k", "]"}], "]"}]}], ")"}]}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"f", "=", 
               RowBox[{"Insert", "[", 
                RowBox[{"f", ",", "eCoef", ",", 
                 RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"f", "=", 
               RowBox[{"Insert", "[", 
                RowBox[{"f", ",", "fCoef", ",", 
                 RowBox[{"-", "1"}]}], "]"}]}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"k", "<", "nSpace"}], "||", 
              RowBox[{"k", "==", "1"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"k", "==", "1"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"f", "[", 
                  RowBox[{"[", "k", "]"}], "]"}], "+=", 
                 RowBox[{"rhoSpaceArr", "[", 
                  RowBox[{"[", "k", "]"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"d", "=", 
                 RowBox[{"Insert", "[", 
                  RowBox[{"d", ",", "aCoef", ",", 
                   RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                
                RowBox[{"b", "=", 
                 RowBox[{"Insert", "[", 
                  RowBox[{"b", ",", "1", ",", 
                   RowBox[{"-", "1"}]}], "]"}]}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"d", "=", 
                 RowBox[{"Insert", "[", 
                  RowBox[{"d", ",", "dCoef", ",", 
                   RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                
                RowBox[{"d", "=", 
                 RowBox[{"Insert", "[", 
                  RowBox[{"d", ",", "aCoef", ",", 
                   RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                
                RowBox[{"a", "=", 
                 RowBox[{"Insert", "[", 
                  RowBox[{"a", ",", 
                   RowBox[{"-", "1"}], ",", 
                   RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                
                RowBox[{"a", "=", 
                 RowBox[{"Insert", "[", 
                  RowBox[{"a", ",", 
                   RowBox[{"-", "1"}], ",", 
                   RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                
                RowBox[{"b", "=", 
                 RowBox[{"Insert", "[", 
                  RowBox[{"b", ",", "1", ",", 
                   RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                
                RowBox[{"b", "=", 
                 RowBox[{"Insert", "[", 
                  RowBox[{"b", ",", "1", ",", 
                   RowBox[{"-", "1"}]}], "]"}]}], ";"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"d", "=", 
               RowBox[{"Insert", "[", 
                RowBox[{"d", ",", "dCoef", ",", 
                 RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"d", "=", 
               RowBox[{"Insert", "[", 
                RowBox[{"d", ",", "aCoef", ",", 
                 RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"b", "=", 
               RowBox[{"Insert", "[", 
                RowBox[{"b", ",", "1", ",", 
                 RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"a", "=", 
               RowBox[{"Insert", "[", 
                RowBox[{"a", ",", 
                 RowBox[{"-", "1"}], ",", 
                 RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"a", "=", 
               RowBox[{"Insert", "[", 
                RowBox[{"a", ",", 
                 RowBox[{"-", "1"}], ",", 
                 RowBox[{"-", "1"}]}], "]"}]}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"f", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"2", "*", "nSpace"}], "-", "1"}], "]"}], "]"}], "-=", 
         RowBox[{"rhoSpaceArr", "[", 
          RowBox[{"[", 
           RowBox[{"nSpace", "+", "1"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"writeTemperatureValues", "[", 
         RowBox[{"direction", ",", "thetaSpaceArr"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"{", 
          RowBox[{"a", ",", "b", ",", "d", ",", "f"}], "}"}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", 
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**"}], "******)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"writeTemperatureValues", "[", 
      RowBox[{"directionNo_", ",", "thetaSpace_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"k", ",", "nSpace"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"nSpace", "=", 
         RowBox[{"Length", "[", 
          RowBox[{"directions", "[", 
           RowBox[{"[", "directionNo", "]"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"k", "=", "1"}], ",", 
          RowBox[{"k", "<=", "nSpace"}], ",", 
          RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"totalData", "[", 
             RowBox[{"directionNo", ",", "\"\<T\>\"", ",", "k"}], "]"}], "=", 
            
            RowBox[{
             RowBox[{"thetaSpace", "[", 
              RowBox[{"[", "k", "]"}], "]"}], "-", "273.15"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"write", " ", "Tend"}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"k", "==", "nSpace"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"totalData", "[", 
                RowBox[{"directionNo", ",", "\"\<Tend\>\""}], "]"}], "=", 
               RowBox[{
                RowBox[{"thetaSpace", "[", 
                 RowBox[{"[", "k", "]"}], "]"}], "-", "273.15"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"writeDataToDataInfo", "[", 
               RowBox[{"directionNo", ",", 
                RowBox[{"{", "8", "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"totalData", "[", 
                  RowBox[{"directionNo", ",", "\"\<Tend\>\""}], "]"}], 
                 "}"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
           ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", 
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**"}], "******)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"writeCrossingRhos", "[", "crossingRhos_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "crossingNo", ",", "k", ",", "crossingIns", ",", "crossingOuts", ",", 
         "lenIn", ",", "lenOut", ",", "direction", ",", "pStart", ",", "pEnd",
          ",", "TStart", ",", "TEnd", ",", "Z", ",", "Rspecific", ",", 
         "rhon"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"crossingNo", "=", "1"}], ",", 
          RowBox[{"crossingNo", "<=", "numCrossings"}], ",", 
          RowBox[{"crossingNo", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"crossingIns", "=", 
            RowBox[{"crossings", "[", 
             RowBox[{"crossingNo", ",", "\"\<in\>\""}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"crossingOuts", "=", 
            RowBox[{"crossings", "[", 
             RowBox[{"crossingNo", ",", "\"\<out\>\""}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"lenIn", "=", 
            RowBox[{"Length", "[", "crossingIns", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"k", "=", "1"}], ",", 
             RowBox[{"k", "<=", "lenIn"}], ",", 
             RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"direction", "=", 
               RowBox[{"crossingIns", "[", 
                RowBox[{"[", "k", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
              
              RowBox[{"pEnd", "=", 
               RowBox[{"kg2pa", "[", 
                RowBox[{"totalData", "[", 
                 RowBox[{"direction", ",", "\"\<Pend\>\""}], "]"}], "]"}]}], 
              ";", "\[IndentingNewLine]", 
              RowBox[{"Rspecific", "=", 
               RowBox[{"totalData", "[", 
                RowBox[{"direction", ",", "\"\<Rspecific\>\""}], "]"}]}], ";",
               "\[IndentingNewLine]", 
              RowBox[{"rhon", "=", 
               RowBox[{"totalData", "[", 
                RowBox[{"direction", ",", "\"\<rhon\>\""}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"TEnd", "=", 
               RowBox[{
                RowBox[{"totalData", "[", 
                 RowBox[{"direction", ",", "\"\<Tend\>\""}], "]"}], "+", 
                "273.15"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"Z", "=", 
               RowBox[{"calculateZ", "[", 
                RowBox[{"rhon", ",", 
                 RowBox[{"pEnd", "*", 
                  RowBox[{"10", "^", 
                   RowBox[{"(", 
                    RowBox[{"-", "6"}], ")"}]}]}], ",", "TEnd", ",", 
                 "Rspecific"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"totalData", "[", 
                RowBox[{"direction", ",", "\"\<rhoend\>\""}], "]"}], "=", 
               RowBox[{"crossingRhos", "[", 
                RowBox[{"[", "crossingNo", "]"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"totalData", "[", 
                RowBox[{"direction", ",", "\"\<rho\>\"", ",", "1"}], "]"}], 
               "=", 
               RowBox[{"totalData", "[", 
                RowBox[{"direction", ",", "\"\<rhostart\>\""}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"totalData", "[", 
                RowBox[{"direction", ",", "\"\<rho\>\"", ",", 
                 RowBox[{"Length", "[", 
                  RowBox[{"directions", "[", 
                   RowBox[{"[", "direction", "]"}], "]"}], "]"}]}], "]"}], 
               "=", 
               RowBox[{"totalData", "[", 
                RowBox[{"direction", ",", "\"\<rhoend\>\""}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"pEnd", "=", 
               RowBox[{"Rspecific", "*", "TEnd", "*", "Z", "*", 
                RowBox[{"totalData", "[", 
                 RowBox[{"direction", ",", "\"\<rhoend\>\""}], "]"}]}]}], ";",
               "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"totalData", "[", 
                RowBox[{"direction", ",", "\"\<Pend\>\""}], "]"}], "=", 
               RowBox[{"pa2kg", "[", "pEnd", "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"writeDataToDataInfo", "[", 
               RowBox[{"direction", ",", 
                RowBox[{"{", 
                 RowBox[{"16", ",", "7"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"totalData", "[", 
                   RowBox[{"direction", ",", "\"\<rhoend\>\""}], "]"}], ",", 
                  RowBox[{"totalData", "[", 
                   RowBox[{"direction", ",", "\"\<Pend\>\""}], "]"}]}], 
                 "}"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"lenOut", "=", 
            RowBox[{"Length", "[", "crossingOuts", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"k", "=", "1"}], ",", 
             RowBox[{"k", "<=", "lenOut"}], ",", 
             RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"direction", "=", 
               RowBox[{"crossingOuts", "[", 
                RowBox[{"[", "k", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
              
              RowBox[{
               RowBox[{"totalData", "[", 
                RowBox[{"direction", ",", "\"\<rhostart\>\""}], "]"}], "=", 
               RowBox[{"crossingRhos", "[", 
                RowBox[{"[", "crossingNo", "]"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"totalData", "[", 
                RowBox[{"direction", ",", "\"\<rho\>\"", ",", "1"}], "]"}], 
               "=", 
               RowBox[{"totalData", "[", 
                RowBox[{"direction", ",", "\"\<rhostart\>\""}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"totalData", "[", 
                RowBox[{"direction", ",", "\"\<rho\>\"", ",", 
                 RowBox[{"Length", "[", 
                  RowBox[{"directions", "[", 
                   RowBox[{"[", "direction", "]"}], "]"}], "]"}]}], "]"}], 
               "=", 
               RowBox[{"totalData", "[", 
                RowBox[{"direction", ",", "\"\<rhoend\>\""}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"pStart", "=", 
               RowBox[{"kg2pa", "[", 
                RowBox[{"totalData", "[", 
                 RowBox[{"direction", ",", "\"\<Pstart\>\""}], "]"}], "]"}]}],
               ";", "\[IndentingNewLine]", 
              RowBox[{"Rspecific", "=", 
               RowBox[{"totalData", "[", 
                RowBox[{"direction", ",", "\"\<Rspecific\>\""}], "]"}]}], ";",
               "\[IndentingNewLine]", 
              RowBox[{"rhon", "=", 
               RowBox[{"totalData", "[", 
                RowBox[{"direction", ",", "\"\<rhon\>\""}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"TStart", "=", 
               RowBox[{
                RowBox[{"totalData", "[", 
                 RowBox[{"direction", ",", "\"\<Tstart\>\""}], "]"}], "+", 
                "273.15"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"Z", "=", 
               RowBox[{"calculateZ", "[", 
                RowBox[{"rhon", ",", 
                 RowBox[{"pStart", "*", 
                  RowBox[{"10", "^", 
                   RowBox[{"(", 
                    RowBox[{"-", "6"}], ")"}]}]}], ",", "TStart", ",", 
                 "Rspecific"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"pStart", "=", 
               RowBox[{"Rspecific", "*", "TStart", "*", "Z", "*", 
                RowBox[{"totalData", "[", 
                 RowBox[{"direction", ",", "\"\<rhostart\>\""}], "]"}]}]}], 
              ";", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"totalData", "[", 
                RowBox[{"direction", ",", "\"\<Pstart\>\""}], "]"}], "=", 
               RowBox[{"pa2kg", "[", "pStart", "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"writeDataToDataInfo", "[", 
               RowBox[{"direction", ",", 
                RowBox[{"{", 
                 RowBox[{"15", ",", "3"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"totalData", "[", 
                   RowBox[{"direction", ",", "\"\<rhostart\>\""}], "]"}], ",", 
                  RowBox[{"totalData", "[", 
                   RowBox[{"direction", ",", "\"\<Pstart\>\""}], "]"}]}], 
                 "}"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
           ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", 
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**"}], "******)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"printTable", "[", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
        "Print", "[", 
         "\"\<(*--------------------- PRINT TABLE WITH UPDATED VALUES \
-------------------------*)\>\"", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"CellPrint", "[", 
         RowBox[{"TextCell", "[", 
          RowBox[{"Grid", "[", 
           RowBox[{"dataInfo", ",", 
            RowBox[{"Alignment", "\[Rule]", "Left"}], ",", 
            RowBox[{"Spacings", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"2", ",", "1"}], "}"}]}], ",", 
            RowBox[{"Frame", "\[Rule]", "All"}], ",", 
            RowBox[{"ItemStyle", "\[Rule]", "\"\<Text\>\""}], ",", 
            RowBox[{"Background", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"LightCyan", ",", "None"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"LightGreen", ",", "None"}], "}"}]}], "}"}]}]}], 
           "]"}], "]"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", 
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**"}], "******)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"calculateMassFlux", "[", 
      RowBox[{"iter_", ",", "tableInfo_", ",", "vecInfo_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "crossingNo", ",", "k", ",", "l", ",", "crossingIns", ",", 
         "crossingOuts", ",", "lenIn", ",", "lenOut", ",", "direction", ",", 
         "a", ",", "b", ",", "d", ",", "f", ",", "thetaSpace", ",", 
         "rhoSpace", ",", "MSpace", ",", "pSpace", ",", "vec", ",", 
         "lenVec"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"crossingNo", "=", "1"}], ",", 
          RowBox[{"crossingNo", "<=", "numCrossings"}], ",", 
          RowBox[{"crossingNo", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"crossingIns", "=", 
            RowBox[{"crossings", "[", 
             RowBox[{"crossingNo", ",", "\"\<in\>\""}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"gasMixingTemperature", "[", "crossingIns", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"crossingOuts", "=", 
            RowBox[{"crossings", "[", 
             RowBox[{"crossingNo", ",", "\"\<out\>\""}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"lenIn", "=", 
            RowBox[{"Length", "[", "crossingIns", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"k", "=", "1"}], ",", 
             RowBox[{"k", "<=", "lenIn"}], ",", 
             RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"direction", "=", 
               RowBox[{"crossingIns", "[", 
                RowBox[{"[", "k", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
              
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                "thetaSpace", ",", "rhoSpace", ",", "MSpace", ",", "pSpace"}],
                 "}"}], "=", 
               RowBox[{"prepareData", "[", 
                RowBox[{"direction", ",", "iter"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{"vecInfo", ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Print", "[", 
                  RowBox[{"\"\<direction-\>\"", ",", "direction"}], "]"}], 
                 ";", "\[IndentingNewLine]", 
                 RowBox[{"Print", "[", 
                  RowBox[{"\"\<{thetaSpace,rhoSpace,MSpace,pSpace}=\>\"", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    "thetaSpace", ",", "rhoSpace", ",", "MSpace", ",", 
                    "pSpace"}], "}"}]}], "]"}], ";"}]}], 
               "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"a", ",", "b", ",", "d", ",", "f"}], "}"}], "=", 
               RowBox[{"calculateDynamicParams", "[", 
                RowBox[{
                "direction", ",", "vCoef", ",", "tau", ",", "thetaSpace", ",",
                  "rhoSpace", ",", "MSpace", ",", "pSpace", ",", "True"}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "[", "d", "]"}], "==", "1"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{"vecInfo", ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"Print", "[", 
                    RowBox[{"\"\<vec=\>\"", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"f", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "+", 
                    RowBox[{"totalData", "[", 
                    RowBox[{"direction", ",", "\"\<rhostart\>\""}], "]"}], 
                    "-", 
                    RowBox[{"totalData", "[", 
                    RowBox[{"direction", ",", "\"\<rhoend\>\""}], "]"}]}], 
                    ")"}], "/", 
                    RowBox[{"d", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "//", "N"}]}], "]"}], 
                   ";", "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{"direction", ",", "\"\<Type\>\""}], "]"}], "!=", 
                    "\"\<in\>\""}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{"direction", ",", "\"\<Mstart\>\""}], "]"}], "=", 
                    
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"f", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "+", 
                    RowBox[{"totalData", "[", 
                    RowBox[{"direction", ",", "\"\<rhostart\>\""}], "]"}], 
                    "-", 
                    RowBox[{"totalData", "[", 
                    RowBox[{"direction", ",", "\"\<rhoend\>\""}], "]"}]}], 
                    ")"}], "/", 
                    RowBox[{"d", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "//", "N"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{"direction", ",", "\"\<Mend\>\""}], "]"}], "=", 
                    RowBox[{"totalData", "[", 
                    RowBox[{"direction", ",", "\"\<Mstart\>\""}], "]"}]}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{"writeDataToDataInfo", "[", 
                    RowBox[{"direction", ",", 
                    RowBox[{"{", 
                    RowBox[{"17", ",", "18"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{"direction", ",", "\"\<Mstart\>\""}], "]"}], ",", 
                    
                    RowBox[{"totalData", "[", 
                    RowBox[{"direction", ",", "\"\<Mend\>\""}], "]"}]}], 
                    "}"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
                   ";"}]}], "\[IndentingNewLine]", "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"vec", "=", 
                  RowBox[{"Qualau", "[", 
                   RowBox[{"a", ",", "b", ",", "d", ",", "f", ",", "False"}], 
                   "]"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"lenVec", "=", 
                  RowBox[{"Length", "[", "vec", "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"For", "[", 
                  RowBox[{
                   RowBox[{"l", "=", "1"}], ",", 
                   RowBox[{"l", "<=", "lenVec"}], ",", 
                   RowBox[{"l", "++"}], ",", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"EvenQ", "[", "l", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{"direction", ",", "\"\<rho\>\"", ",", 
                    RowBox[{
                    RowBox[{"IntegerPart", "[", 
                    RowBox[{
                    RowBox[{"l", "/", "2"}], "//", "N"}], "]"}], "+", "1"}]}],
                     "]"}], "=", 
                    RowBox[{"vec", "[", 
                    RowBox[{"[", "l", "]"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{"direction", ",", "\"\<Type\>\""}], "]"}], "!=", 
                    "\"\<in\>\""}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Which", "[", 
                    RowBox[{
                    RowBox[{"l", "==", "1"}], ",", 
                    RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{"direction", ",", "\"\<Mstart\>\""}], "]"}], "=", 
                    
                    RowBox[{"vec", "[", 
                    RowBox[{"[", "l", "]"}], "]"}]}], ",", 
                    RowBox[{"l", "==", "lenVec"}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{"direction", ",", "\"\<Mend\>\""}], "]"}], "=", 
                    RowBox[{"vec", "[", 
                    RowBox[{"[", "l", "]"}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                    
                    RowBox[{"writeDataToDataInfo", "[", 
                    RowBox[{"direction", ",", 
                    RowBox[{"{", 
                    RowBox[{"17", ",", "18"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{"direction", ",", "\"\<Mstart\>\""}], "]"}], ",", 
                    
                    RowBox[{"totalData", "[", 
                    RowBox[{"direction", ",", "\"\<Mend\>\""}], "]"}]}], 
                    "}"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
                    ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
                  "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{"vecInfo", ",", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"Print", "[", 
                    RowBox[{"\"\<vec=\>\"", ",", "vec"}], "]"}], ";"}]}], 
                  "\[IndentingNewLine]", "]"}], ";"}]}], 
               "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"lenOut", "=", 
            RowBox[{"Length", "[", "crossingOuts", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"k", "=", "1"}], ",", 
             RowBox[{"k", "<=", "lenOut"}], ",", 
             RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"direction", "=", 
               RowBox[{"crossingOuts", "[", 
                RowBox[{"[", "k", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
              
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                "thetaSpace", ",", "rhoSpace", ",", "MSpace", ",", "pSpace"}],
                 "}"}], "=", 
               RowBox[{"prepareData", "[", 
                RowBox[{"direction", ",", "iter"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{"vecInfo", ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Print", "[", 
                  RowBox[{"\"\<direction-\>\"", ",", "direction"}], "]"}], 
                 ";", "\[IndentingNewLine]", 
                 RowBox[{"Print", "[", 
                  RowBox[{"\"\<{thetaSpace,rhoSpace,MSpace,pSpace}=\>\"", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    "thetaSpace", ",", "rhoSpace", ",", "MSpace", ",", 
                    "pSpace"}], "}"}]}], "]"}], ";"}]}], 
               "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"a", ",", "b", ",", "d", ",", "f"}], "}"}], "=", 
               RowBox[{"calculateDynamicParams", "[", 
                RowBox[{
                "direction", ",", "vCoef", ",", "tau", ",", "thetaSpace", ",",
                  "rhoSpace", ",", "MSpace", ",", "pSpace", ",", "True"}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "[", "d", "]"}], "==", "1"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{"vecInfo", ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"Print", "[", 
                    RowBox[{"\"\<vec=\>\"", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"f", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "+", 
                    RowBox[{"totalData", "[", 
                    RowBox[{"direction", ",", "\"\<rhostart\>\""}], "]"}], 
                    "-", 
                    RowBox[{"totalData", "[", 
                    RowBox[{"direction", ",", "\"\<rhoend\>\""}], "]"}]}], 
                    ")"}], "/", 
                    RowBox[{"d", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "//", "N"}]}], "]"}], 
                   ";", "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{"direction", ",", "\"\<Type\>\""}], "]"}], "!=", 
                    "\"\<out\>\""}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{"direction", ",", "\"\<Mstart\>\""}], "]"}], "=", 
                    
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"f", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "+", 
                    RowBox[{"totalData", "[", 
                    RowBox[{"direction", ",", "\"\<rhostart\>\""}], "]"}], 
                    "-", 
                    RowBox[{"totalData", "[", 
                    RowBox[{"direction", ",", "\"\<rhoend\>\""}], "]"}]}], 
                    ")"}], "/", 
                    RowBox[{"d", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "//", "N"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{"direction", ",", "\"\<Mend\>\""}], "]"}], "=", 
                    RowBox[{"totalData", "[", 
                    RowBox[{"direction", ",", "\"\<Mstart\>\""}], "]"}]}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{"writeDataToDataInfo", "[", 
                    RowBox[{"direction", ",", 
                    RowBox[{"{", 
                    RowBox[{"17", ",", "18"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{"direction", ",", "\"\<Mstart\>\""}], "]"}], ",", 
                    
                    RowBox[{"totalData", "[", 
                    RowBox[{"direction", ",", "\"\<Mend\>\""}], "]"}]}], 
                    "}"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
                   ";"}]}], "\[IndentingNewLine]", "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"vec", "=", 
                  RowBox[{"Qualau", "[", 
                   RowBox[{"a", ",", "b", ",", "d", ",", "f", ",", "False"}], 
                   "]"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"lenVec", "=", 
                  RowBox[{"Length", "[", "vec", "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"For", "[", 
                  RowBox[{
                   RowBox[{"l", "=", "1"}], ",", 
                   RowBox[{"l", "<=", "lenVec"}], ",", 
                   RowBox[{"l", "++"}], ",", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"EvenQ", "[", "l", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{"direction", ",", "\"\<rho\>\"", ",", 
                    RowBox[{
                    RowBox[{"IntegerPart", "[", 
                    RowBox[{
                    RowBox[{"l", "/", "2"}], "//", "N"}], "]"}], "+", "1"}]}],
                     "]"}], "=", 
                    RowBox[{"vec", "[", 
                    RowBox[{"[", "l", "]"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{"direction", ",", "\"\<Type\>\""}], "]"}], "!=", 
                    "\"\<out\>\""}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Which", "[", 
                    RowBox[{
                    RowBox[{"l", "==", "1"}], ",", 
                    RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{"direction", ",", "\"\<Mstart\>\""}], "]"}], "=", 
                    
                    RowBox[{"vec", "[", 
                    RowBox[{"[", "l", "]"}], "]"}]}], ",", 
                    RowBox[{"l", "==", "lenVec"}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{"direction", ",", "\"\<Mend\>\""}], "]"}], "=", 
                    RowBox[{"vec", "[", 
                    RowBox[{"[", "l", "]"}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                    
                    RowBox[{"writeDataToDataInfo", "[", 
                    RowBox[{"direction", ",", 
                    RowBox[{"{", 
                    RowBox[{"17", ",", "18"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{"direction", ",", "\"\<Mstart\>\""}], "]"}], ",", 
                    
                    RowBox[{"totalData", "[", 
                    RowBox[{"direction", ",", "\"\<Mend\>\""}], "]"}]}], 
                    "}"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
                    ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
                  "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{"vecInfo", ",", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"Print", "[", 
                    RowBox[{"\"\<vec=\>\"", ",", "vec"}], "]"}], ";"}]}], 
                  "\[IndentingNewLine]", "]"}], ";"}]}], 
               "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
            "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", 
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**"}], "******)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"constructFullSystem", "[", 
      RowBox[{"iter_", ",", "info_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x", ",", "rhoValue", ",", "k", ",", "mixThetaDirections"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"k", "=", "1"}], ",", 
          RowBox[{"k", "<=", "numCrossings"}], ",", 
          RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"mixThetaDirections", "=", 
            RowBox[{"crossings", "[", 
             RowBox[{"k", ",", "\"\<in\>\""}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"gasMixingTemperature", "[", "mixThetaDirections", "]"}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"rhoValue", "=", 
            RowBox[{"totalData", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"crossings", "[", 
                RowBox[{"k", ",", "\"\<out\>\""}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<rhostart\>\""}], 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"calculateEquationParams", "[", 
            RowBox[{
            "k", ",", "vCoef", ",", "tau", ",", "rhoValue", ",", "iter", ",", 
             "info"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"\"\<SMatrix=\>\"", ",", 
            RowBox[{"SMatrix", "//", "MatrixForm"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<RVector=\>\"", ",", 
            RowBox[{"RVector", "//", "MatrixForm"}]}], "]"}], ";"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"x", "=", 
         RowBox[{"LinearSolve", "[", 
          RowBox[{"SMatrix", ",", "RVector"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "x", "]"}], ";"}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", 
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**"}], "******)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"calculateEquationParams", "[", 
      RowBox[{
      "crossingNo_", ",", "vCoef_", ",", "tau_", ",", "rho_", ",", "iter_", 
       ",", "info_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"dAlpha", ",", "eAlpha", ",", 
         RowBox[{"beta", "=", "0"}], ",", "distance", ",", "S", ",", 
         "diamInner", ",", "direction", ",", "crossingIns", ",", 
         "crossingOuts", ",", "lenIn", ",", "lenOut", ",", "m", ",", "k", ",",
          "num", ",", "M", ",", "lenDirection", ",", "crossingNoComputed", 
         ",", "A", ",", "B", ",", "C", ",", "U", ",", "V", ",", "W", ",", 
         "thetaSpace", ",", "rhoSpace", ",", "MSpace", ",", "pSpace", ",", 
         "deltaHSpace", ",", "a", ",", "b", ",", "d", ",", "f"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"crossingIns", "=", 
         RowBox[{"crossings", "[", 
          RowBox[{"crossingNo", ",", "\"\<in\>\""}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"crossingOuts", "=", 
         RowBox[{"crossings", "[", 
          RowBox[{"crossingNo", ",", "\"\<out\>\""}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"lenIn", "=", 
         RowBox[{"Length", "[", "crossingIns", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"lenOut", "=", 
         RowBox[{"Length", "[", "crossingOuts", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"m", "=", "1"}], ",", 
          RowBox[{"m", "<=", "lenIn"}], ",", 
          RowBox[{"m", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"direction", "=", 
            RowBox[{"crossingIns", "[", 
             RowBox[{"[", "m", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"num", "=", 
            RowBox[{"Length", "[", 
             RowBox[{"directions", "[", 
              RowBox[{"[", "direction", "]"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"k", "=", "1"}], ",", 
             RowBox[{"k", "<", "num"}], ",", 
             RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"diamInner", "=", 
               RowBox[{"diameters", "[", 
                RowBox[{
                 RowBox[{"directions", "[", 
                  RowBox[{"[", 
                   RowBox[{"direction", ",", "k"}], "]"}], "]"}], ",", 
                 RowBox[{"directions", "[", 
                  RowBox[{"[", 
                   RowBox[{"direction", ",", 
                    RowBox[{"k", "+", "1"}]}], "]"}], "]"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"distance", "=", 
               RowBox[{"distances", "[", 
                RowBox[{
                 RowBox[{"directions", "[", 
                  RowBox[{"[", 
                   RowBox[{"direction", ",", "k"}], "]"}], "]"}], ",", 
                 RowBox[{"directions", "[", 
                  RowBox[{"[", 
                   RowBox[{"direction", ",", 
                    RowBox[{"k", "+", "1"}]}], "]"}], "]"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"S", "=", 
               RowBox[{
                RowBox[{"Pi", "*", 
                 RowBox[{
                  RowBox[{"diamInner", "^", "2"}], "/", "4"}]}], "//", 
                "N"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"beta", "+=", 
               RowBox[{"distance", "*", "S"}]}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"m", "=", "1"}], ",", 
          RowBox[{"m", "<=", "lenOut"}], ",", 
          RowBox[{"m", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"direction", "=", 
            RowBox[{"crossingOuts", "[", 
             RowBox[{"[", "m", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"num", "=", 
            RowBox[{"Length", "[", 
             RowBox[{"directions", "[", 
              RowBox[{"[", "direction", "]"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"k", "=", "1"}], ",", 
             RowBox[{"k", "<", "num"}], ",", 
             RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"diamInner", "=", 
               RowBox[{"diameters", "[", 
                RowBox[{
                 RowBox[{"directions", "[", 
                  RowBox[{"[", 
                   RowBox[{"direction", ",", "k"}], "]"}], "]"}], ",", 
                 RowBox[{"directions", "[", 
                  RowBox[{"[", 
                   RowBox[{"direction", ",", 
                    RowBox[{"k", "+", "1"}]}], "]"}], "]"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"distance", "=", 
               RowBox[{"distances", "[", 
                RowBox[{
                 RowBox[{"directions", "[", 
                  RowBox[{"[", 
                   RowBox[{"direction", ",", "k"}], "]"}], "]"}], ",", 
                 RowBox[{"directions", "[", 
                  RowBox[{"[", 
                   RowBox[{"direction", ",", 
                    RowBox[{"k", "+", "1"}]}], "]"}], "]"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"S", "=", 
               RowBox[{
                RowBox[{"Pi", "*", 
                 RowBox[{
                  RowBox[{"diamInner", "^", "2"}], "/", "4"}]}], "//", 
                "N"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"beta", "+=", 
               RowBox[{"distance", "*", "S"}]}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"num", "=", 
         RowBox[{"lenIn", "+", "lenOut"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"++", 
          RowBox[{"++", 
           RowBox[{"++", 
            RowBox[{"++", 
             RowBox[{"++", 
              RowBox[{"++", 
               RowBox[{"++", "+"}]}]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"dAlpha", "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"beta", "/", 
             RowBox[{"(", 
              RowBox[{"1", "-", "vCoef"}], ")"}]}], "/", "tau"}], "/", 
           "num"}], "//", "N"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"++", 
          RowBox[{"++", 
           RowBox[{"++", 
            RowBox[{"++", 
             RowBox[{"++", 
              RowBox[{"++", 
               RowBox[{"++", "+"}]}]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"eAlpha", "=", "0"}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"m", "=", "1"}], ",", 
          RowBox[{"m", "<=", "lenOut"}], ",", 
          RowBox[{"m", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"direction", "=", 
            RowBox[{"crossingOuts", "[", 
             RowBox[{"[", "m", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"M", "=", 
            RowBox[{"totalData", "[", 
             RowBox[{"direction", ",", "\"\<Mstart\>\""}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"eAlpha", "-=", "M"}], ";"}]}], "\[IndentingNewLine]", 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"m", "=", "1"}], ",", 
          RowBox[{"m", "<=", "lenIn"}], ",", 
          RowBox[{"m", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"direction", "=", 
            RowBox[{"crossingIns", "[", 
             RowBox[{"[", "m", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"M", "=", 
            RowBox[{"totalData", "[", 
             RowBox[{"direction", ",", "\"\<Mend\>\""}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"eAlpha", "+=", "M"}], ";"}]}], "\[IndentingNewLine]", 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"eAlpha", "*=", 
          RowBox[{"vCoef", "/", 
           RowBox[{"(", 
            RowBox[{"1", "-", "vCoef"}], ")"}]}]}], "//", "N"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"eAlpha", "+=", 
         RowBox[{"dAlpha", "*", "rho"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"compute", " ", "rhoAlpha", " ", "coef"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"SMatrix", "[", 
          RowBox[{"[", 
           RowBox[{"crossingNo", ",", "crossingNo"}], "]"}], "]"}], "=", 
         "dAlpha"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"compute", " ", "RVector", " ", "element"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"RVector", "[", 
          RowBox[{"[", "crossingNo", "]"}], "]"}], "=", "eAlpha"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"m", "=", "1"}], ",", 
          RowBox[{"m", "<=", "lenOut"}], ",", 
          RowBox[{"m", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"direction", "=", 
            RowBox[{"crossingOuts", "[", 
             RowBox[{"[", "m", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"totalData", "[", 
               RowBox[{"direction", ",", "\"\<Type\>\""}], "]"}], "==", 
              "\"\<out\>\""}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"M", "=", 
               RowBox[{"totalData", "[", 
                RowBox[{"direction", ",", "\"\<Mstart\>\""}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"RVector", "[", 
                RowBox[{"[", "crossingNo", "]"}], "]"}], "-=", "M"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"lenDirection", "=", 
               RowBox[{"Length", "[", 
                RowBox[{"directions", "[", 
                 RowBox[{"[", "direction", "]"}], "]"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "[", 
                  RowBox[{"Position", "[", 
                   RowBox[{"crossingValues", ",", 
                    RowBox[{"directions", "[", 
                    RowBox[{"[", 
                    RowBox[{"direction", ",", "lenDirection"}], "]"}], 
                    "]"}]}], "]"}], "]"}], ">", "0"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"crossingNoComputed", "=", 
                  RowBox[{
                   RowBox[{"Position", "[", 
                    RowBox[{"crossingValues", ",", 
                    RowBox[{"directions", "[", 
                    RowBox[{"[", 
                    RowBox[{"direction", ",", "lenDirection"}], "]"}], 
                    "]"}]}], "]"}], "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                   "thetaSpace", ",", "rhoSpace", ",", "MSpace", ",", 
                    "pSpace"}], "}"}], "=", 
                  RowBox[{"prepareData", "[", 
                   RowBox[{"direction", ",", "iter"}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"a", ",", "b", ",", "d", ",", "f"}], "}"}], "=", 
                  RowBox[{"calculateDynamicParams", "[", 
                   RowBox[{
                   "direction", ",", "vCoef", ",", "tau", ",", "thetaSpace", 
                    ",", "rhoSpace", ",", "MSpace", ",", "pSpace", ",", 
                    "info"}], "]"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"f", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "-=", 
                  RowBox[{"rhoSpace", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"f", "[", 
                   RowBox[{"[", 
                    RowBox[{"Length", "[", "f", "]"}], "]"}], "]"}], "+=", 
                  RowBox[{"rhoSpace", "[", 
                   RowBox[{"[", 
                    RowBox[{"Length", "[", "rhoSpace", "]"}], "]"}], "]"}]}], 
                 ";", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"A", ",", "B", ",", "C"}], "}"}], "=", 
                  RowBox[{"calculateABC", "[", 
                   RowBox[{"a", ",", "b", ",", "d", ",", "f"}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"SMatrix", "[", 
                   RowBox[{"[", 
                    RowBox[{"crossingNo", ",", "crossingNoComputed"}], "]"}], 
                   "]"}], "+=", "C"}], ";", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"SMatrix", "[", 
                   RowBox[{"[", 
                    RowBox[{"crossingNo", ",", "crossingNo"}], "]"}], "]"}], "+=",
                   "B"}], ";", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"RVector", "[", 
                   RowBox[{"[", "crossingNo", "]"}], "]"}], "-=", "A"}], 
                 ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"m", "=", "1"}], ",", 
          RowBox[{"m", "<=", "lenIn"}], ",", 
          RowBox[{"m", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"direction", "=", 
            RowBox[{"crossingIns", "[", 
             RowBox[{"[", "m", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"totalData", "[", 
               RowBox[{"direction", ",", "\"\<Type\>\""}], "]"}], "==", 
              "\"\<in\>\""}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"M", "=", 
               RowBox[{"totalData", "[", 
                RowBox[{"direction", ",", "\"\<Mend\>\""}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"RVector", "[", 
                RowBox[{"[", "crossingNo", "]"}], "]"}], "+=", "M"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "[", 
                  RowBox[{"Position", "[", 
                   RowBox[{"crossingValues", ",", 
                    RowBox[{"directions", "[", 
                    RowBox[{"[", 
                    RowBox[{"direction", ",", "1"}], "]"}], "]"}]}], "]"}], 
                  "]"}], ">", "0"}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"crossingNoComputed", "=", 
                  RowBox[{
                   RowBox[{"Position", "[", 
                    RowBox[{"crossingValues", ",", 
                    RowBox[{"directions", "[", 
                    RowBox[{"[", 
                    RowBox[{"direction", ",", "1"}], "]"}], "]"}]}], "]"}], 
                   "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                   "thetaSpace", ",", "rhoSpace", ",", "MSpace", ",", 
                    "pSpace"}], "}"}], "=", 
                  RowBox[{"prepareData", "[", 
                   RowBox[{"direction", ",", "iter"}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"a", ",", "b", ",", "d", ",", "f"}], "}"}], "=", 
                  RowBox[{"calculateDynamicParams", "[", 
                   RowBox[{
                   "direction", ",", "vCoef", ",", "tau", ",", "thetaSpace", 
                    ",", "rhoSpace", ",", "MSpace", ",", "pSpace", ",", 
                    "info"}], "]"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"f", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "-=", 
                  RowBox[{"rhoSpace", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"f", "[", 
                   RowBox[{"[", 
                    RowBox[{"Length", "[", "f", "]"}], "]"}], "]"}], "+=", 
                  RowBox[{"rhoSpace", "[", 
                   RowBox[{"[", 
                    RowBox[{"Length", "[", "rhoSpace", "]"}], "]"}], "]"}]}], 
                 ";", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"U", ",", "V", ",", "W"}], "}"}], "=", 
                  RowBox[{"calculateUVW", "[", 
                   RowBox[{"a", ",", "b", ",", "d", ",", "f"}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"SMatrix", "[", 
                   RowBox[{"[", 
                    RowBox[{"crossingNo", ",", "crossingNoComputed"}], "]"}], 
                   "]"}], "+=", "W"}], ";", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"SMatrix", "[", 
                   RowBox[{"[", 
                    RowBox[{"crossingNo", ",", "crossingNo"}], "]"}], "]"}], "+=",
                   "V"}], ";", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"RVector", "[", 
                   RowBox[{"[", "crossingNo", "]"}], "]"}], "-=", "U"}], 
                 ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
         "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", 
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**"}], "******)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"constructCommunicationTypes", "[", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"s", ",", "l", ",", "lenl", ",", "lens", ",", 
         RowBox[{"commonLastVertices", "=", 
          RowBox[{"{", "}"}]}], ",", 
         RowBox[{"commonStartPoint", "=", 
          RowBox[{"{", "}"}]}], ",", 
         RowBox[{"commonStartVertices", "=", 
          RowBox[{"{", "}"}]}], ",", 
         RowBox[{"commonStartPointInverse", "=", 
          RowBox[{"{", "}"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"s", "=", "1"}], ",", 
          RowBox[{"s", "<=", "numDirections"}], ",", 
          RowBox[{"s", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"lens", "=", 
            RowBox[{"Length", "[", 
             RowBox[{"directions", "[", 
              RowBox[{"[", "s", "]"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"commonLastVertices", "=", 
            RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"commonStartPoint", "=", 
            RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"commonStartVertices", "=", 
            RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"commonStartPointInverse", "=", 
            RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"commonStartVertices", "=", 
            RowBox[{"Insert", "[", 
             RowBox[{"commonStartVertices", ",", "s", ",", 
              RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"commonLastVertices", "=", 
            RowBox[{"Insert", "[", 
             RowBox[{"commonLastVertices", ",", "s", ",", 
              RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"l", "=", "1"}], ",", 
             RowBox[{"l", "<=", "numDirections"}], ",", 
             RowBox[{"l", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"lenl", "=", 
               RowBox[{"Length", "[", 
                RowBox[{"directions", "[", 
                 RowBox[{"[", "l", "]"}], "]"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"l", "\[NotEqual]", "s"}], " ", "&&", " ", 
                 RowBox[{
                  RowBox[{"directions", "[", 
                   RowBox[{"[", 
                    RowBox[{"s", ",", "lens"}], "]"}], "]"}], "\[Equal]", 
                  RowBox[{"directions", "[", 
                   RowBox[{"[", 
                    RowBox[{"l", ",", "lenl"}], "]"}], "]"}]}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"commonLastVertices", "=", 
                  RowBox[{"Insert", "[", 
                   RowBox[{"commonLastVertices", ",", "l", ",", 
                    RowBox[{"-", "1"}]}], "]"}]}], ";"}]}], 
               "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"l", "\[NotEqual]", "s"}], " ", "&&", " ", 
                 RowBox[{
                  RowBox[{"directions", "[", 
                   RowBox[{"[", 
                    RowBox[{"s", ",", "lens"}], "]"}], "]"}], "\[Equal]", 
                  RowBox[{"directions", "[", 
                   RowBox[{"[", 
                    RowBox[{"l", ",", "1"}], "]"}], "]"}]}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"commonStartPoint", "=", 
                  RowBox[{"Insert", "[", 
                   RowBox[{"commonStartPoint", ",", "l", ",", 
                    RowBox[{"-", "1"}]}], "]"}]}], ";"}]}], 
               "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"l", "\[NotEqual]", "s"}], " ", "&&", " ", 
                 RowBox[{
                  RowBox[{"directions", "[", 
                   RowBox[{"[", 
                    RowBox[{"s", ",", "1"}], "]"}], "]"}], "\[Equal]", 
                  RowBox[{"directions", "[", 
                   RowBox[{"[", 
                    RowBox[{"l", ",", "1"}], "]"}], "]"}]}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"commonStartVertices", "=", 
                  RowBox[{"Insert", "[", 
                   RowBox[{"commonStartVertices", ",", "l", ",", 
                    RowBox[{"-", "1"}]}], "]"}]}], ";"}]}], 
               "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"l", "\[NotEqual]", "s"}], " ", "&&", " ", 
                 RowBox[{
                  RowBox[{"directions", "[", 
                   RowBox[{"[", 
                    RowBox[{"s", ",", "1"}], "]"}], "]"}], "\[Equal]", 
                  RowBox[{"directions", "[", 
                   RowBox[{"[", 
                    RowBox[{"l", ",", "lenl"}], "]"}], "]"}]}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"commonStartPointInverse", "=", 
                  RowBox[{"Insert", "[", 
                   RowBox[{"commonStartPointInverse", ",", "l", ",", 
                    RowBox[{"-", "1"}]}], "]"}]}], ";"}]}], 
               "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"commonTotalLastVertices", "=", 
            RowBox[{"Insert", "[", 
             RowBox[{
             "commonTotalLastVertices", ",", "commonLastVertices", ",", 
              RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"commonTotalStartPoint", "=", 
            RowBox[{"Insert", "[", 
             RowBox[{"commonTotalStartPoint", ",", "commonStartPoint", ",", 
              RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"commonTotalStartVertices", "=", 
            RowBox[{"Insert", "[", 
             RowBox[{
             "commonTotalStartVertices", ",", "commonStartVertices", ",", 
              RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"commonTotalStartPointInverse", "=", 
            RowBox[{"Insert", "[", 
             RowBox[{
             "commonTotalStartPointInverse", ",", "commonStartPointInverse", 
              ",", 
              RowBox[{"-", "1"}]}], "]"}]}], ";"}]}], "\[IndentingNewLine]", 
         "]"}], ";"}]}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "Print", "[", "\"\<!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\>\"", 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", "\"\<Common last vertices:\>\"", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", "commonTotalLastVertices", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
        "Print", "[", "\"\<!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\>\"", 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{
        "Print", "[", "\"\<Common start point in the last point:\>\"", "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", "commonTotalStartPoint", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
        "Print", "[", "\"\<!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\>\"", 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", "\"\<Common start vertices:\>\"", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", "commonTotalStartVertices", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
        "Print", "[", "\"\<!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\>\"", 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{
        "Print", "[", "\"\<Common start point inverse vertices:\>\"", "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", "commonTotalStartPointInverse", "]"}], ";"}], 
       "*)"}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", 
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**"}], "******)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"prepareCrossingsData", "[", "crossingValues_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"num", ",", "k", ",", "m"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"num", "=", 
         RowBox[{"Length", "[", "crossingValues", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"k", "=", "1"}], ",", 
          RowBox[{"k", "<=", "num"}], ",", 
          RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"crossings", "[", 
             RowBox[{"k", ",", "\"\<value\>\""}], "]"}], "=", 
            RowBox[{"crossingValues", "[", 
             RowBox[{"[", "k", "]"}], "]"}]}], ";"}]}], "\[IndentingNewLine]",
          "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"k", "=", "1"}], ",", 
          RowBox[{"k", "<=", "num"}], ",", 
          RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"crossings", "[", 
             RowBox[{"k", ",", "\"\<out\>\""}], "]"}], "=", 
            RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"crossings", "[", 
             RowBox[{"k", ",", "\"\<in\>\""}], "]"}], "=", 
            RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"m", "=", "1"}], ",", 
             RowBox[{"m", "<=", "numDirections"}], ",", 
             RowBox[{"m", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"directions", "[", 
                  RowBox[{"[", 
                   RowBox[{"m", ",", "1"}], "]"}], "]"}], "==", 
                 RowBox[{"crossings", "[", 
                  RowBox[{"k", ",", "\"\<value\>\""}], "]"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"crossings", "[", 
                   RowBox[{"k", ",", "\"\<out\>\""}], "]"}], "=", 
                  RowBox[{"Insert", "[", 
                   RowBox[{
                    RowBox[{"crossings", "[", 
                    RowBox[{"k", ",", "\"\<out\>\""}], "]"}], ",", "m", ",", 
                    RowBox[{"-", "1"}]}], "]"}]}], ";"}]}], 
               "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"directions", "[", 
                  RowBox[{"[", 
                   RowBox[{"m", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"directions", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "]"}]}], "]"}], "]"}], "==", 
                 RowBox[{"crossings", "[", 
                  RowBox[{"k", ",", "\"\<value\>\""}], "]"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"crossings", "[", 
                   RowBox[{"k", ",", "\"\<in\>\""}], "]"}], "=", 
                  RowBox[{"Insert", "[", 
                   RowBox[{
                    RowBox[{"crossings", "[", 
                    RowBox[{"k", ",", "\"\<in\>\""}], "]"}], ",", "m", ",", 
                    RowBox[{"-", "1"}]}], "]"}]}], ";"}]}], 
               "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
            "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", 
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**"}], "******)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"prepareData", "[", 
      RowBox[{"directionNo_", ",", "iter_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"thetaSpace", "=", 
          RowBox[{"{", "}"}]}], ",", 
         RowBox[{"rhoSpace", "=", 
          RowBox[{"{", "}"}]}], ",", 
         RowBox[{"MSpace", "=", 
          RowBox[{"{", "}"}]}], ",", 
         RowBox[{"pSpace", "=", 
          RowBox[{"{", "}"}]}], ",", 
         RowBox[{"len", "=", 
          RowBox[{"Length", "[", 
           RowBox[{"directions", "[", 
            RowBox[{"[", "directionNo", "]"}], "]"}], "]"}]}], ",", 
         RowBox[{"k", "=", "1"}], ",", "M", ",", "Z", ",", "rhon", ",", 
         "Rspecific", ",", "rho", ",", "p"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"rhon", "=", 
         RowBox[{"totalData", "[", 
          RowBox[{"directionNo", ",", "\"\<rhon\>\""}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Rspecific", "=", 
         RowBox[{"totalData", "[", 
          RowBox[{"directionNo", ",", "\"\<Rspecific\>\""}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"M", "=", 
         RowBox[{"totalData", "[", 
          RowBox[{"directionNo", ",", "\"\<Mstart\>\""}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"k", "<=", "len"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"thetaSpace", "=", 
            RowBox[{"Insert", "[", 
             RowBox[{"thetaSpace", ",", 
              RowBox[{
               RowBox[{"totalData", "[", 
                RowBox[{"directionNo", ",", "\"\<T\>\"", ",", "k"}], "]"}], 
               "+", "273.15"}], ",", 
              RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"pSpace", "=", 
            RowBox[{"Insert", "[", 
             RowBox[{"pSpace", ",", 
              RowBox[{"kg2pa", "[", 
               RowBox[{"totalData", "[", 
                RowBox[{"directionNo", ",", "\"\<P\>\"", ",", "k"}], "]"}], 
               "]"}], ",", 
              RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"Z", "=", 
            RowBox[{"calculateZ", "[", 
             RowBox[{"rhon", ",", 
              RowBox[{
               RowBox[{"pSpace", "[", 
                RowBox[{"[", "k", "]"}], "]"}], "*", 
               RowBox[{"10", "^", 
                RowBox[{"(", 
                 RowBox[{"-", "6"}], ")"}]}]}], ",", 
              RowBox[{"thetaSpace", "[", 
               RowBox[{"[", "k", "]"}], "]"}], ",", "Rspecific"}], "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"iter", "==", "1"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"rho", "=", 
               RowBox[{
                RowBox[{"pSpace", "[", 
                 RowBox[{"[", "k", "]"}], "]"}], "/", 
                RowBox[{"(", 
                 RowBox[{"Z", "*", "Rspecific", "*", 
                  RowBox[{"thetaSpace", "[", 
                   RowBox[{"[", "k", "]"}], "]"}]}], ")"}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"totalData", "[", 
                RowBox[{"directionNo", ",", "\"\<rho\>\"", ",", "k"}], "]"}], 
               "=", "rho"}], ";", "\[IndentingNewLine]", 
              RowBox[{"rhoSpace", "=", 
               RowBox[{"Insert", "[", 
                RowBox[{"rhoSpace", ",", "rho", ",", 
                 RowBox[{"-", "1"}]}], "]"}]}]}], ",", "\[IndentingNewLine]", 
             
             RowBox[{
              RowBox[{"rhoSpace", "=", 
               RowBox[{"Insert", "[", 
                RowBox[{"rhoSpace", ",", 
                 RowBox[{"totalData", "[", 
                  RowBox[{"directionNo", ",", "\"\<rho\>\"", ",", "k"}], 
                  "]"}], ",", 
                 RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"p", "=", 
               RowBox[{
                RowBox[{"rhoSpace", "[", 
                 RowBox[{"[", "k", "]"}], "]"}], "*", "Z", "*", "Rspecific", 
                "*", 
                RowBox[{"thetaSpace", "[", 
                 RowBox[{"[", "k", "]"}], "]"}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"pSpace", "[", 
                RowBox[{"[", "k", "]"}], "]"}], "=", "p"}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"k", "<", "len"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"MSpace", "=", 
               RowBox[{"Insert", "[", 
                RowBox[{"MSpace", ",", "M", ",", 
                 RowBox[{"-", "1"}]}], "]"}]}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"k", "++"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"{", 
          RowBox[{
          "thetaSpace", ",", "rhoSpace", ",", "MSpace", ",", "pSpace"}], 
          "}"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", 
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**"}], "******)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Qualau", "[", 
      RowBox[{"a_", ",", "b_", ",", "d_", ",", "f_", ",", "info_"}], "]"}], ":=",
      "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"**", "**"}], "*", "  ", "\[IndentingNewLine]", "S", " ", 
         "O", " ", "L", " ", "V", " ", "E", "  ", "S", " ", "Y", " ", "S", 
         " ", "T", " ", "E", " ", "M", "   ", "\[IndentingNewLine]", 
         "       ", "A", " ", "x"}], " ", "=", " ", "f"}], " ", ",", 
       "\[IndentingNewLine]", "       ", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"[", 
           RowBox[{"d_", "1", " ", "b_", "1", "  ", "0", "  ", 
            RowBox[{"0", "   ", ".", " ", ".", " ", ".", "  ", "0"}], "        ",
             "0", "       ", "0"}], "   ", "]"}], "  ", "\[IndentingNewLine]",
           "    ", "[", 
          RowBox[{"a_", "1", " ", "d_", "2", " ", "b_", "2", " ", 
           RowBox[{"0", "   ", ".", " ", ".", " ", ".", "  ", "0"}], "        ",
            "0", "       ", "0"}], "   ", "]"}], "\[IndentingNewLine]", "A"}],
         " ", "=", "  ", 
        RowBox[{"[", 
         RowBox[{
         ".", " ", ".", " ", ".", " ", ".", " ", ".", " ", ".", " ", ".", " ",
           ".", " ", ".", " ", ".", " ", ".", " ", ".", " ", ".", " ", ".", 
          " ", ".", " ", ".", " ", ".", " ", ".", " ", ".", " ", ".", " ", 
          ".", " ", "."}], " ", "]"}]}], ",", "\[IndentingNewLine]", 
       "       ", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"[", 
           RowBox[{"0", "    ", "0", "   ", "0", "  ", 
            RowBox[{"0", " ", ".", " ", ".", " ", ".", " ", "a_"}], 
            RowBox[{"{", 
             RowBox[{"n", "-", "2"}], "}"}], " ", "d_", 
            RowBox[{"{", 
             RowBox[{"n", "-", "1"}], "}"}], " ", "b_", 
            RowBox[{"{", 
             RowBox[{"n", "-", "1"}], "}"}]}], " ", "]"}], 
          "\[IndentingNewLine]", "    ", "[", 
          RowBox[{"0", "    ", "0", "   ", "0", "  ", 
           RowBox[{"0", " ", ".", " ", ".", " ", ".", "     ", "0"}], "   ", 
           "a_", 
           RowBox[{"{", 
            RowBox[{"n", "-", "1"}], "}"}], "    ", "d_n"}], "  ", "]"}], 
         "\[IndentingNewLine]", "f"}], " ", "=", " ", 
        RowBox[{
         RowBox[{"[", 
          RowBox[{"f_", "1", " ", "f_", 
           RowBox[{"2", " ", ".", " ", ".", " ", ".", " ", "f_n"}]}], "]"}], 
         "^", "T"}]}]}], " ", "\[IndentingNewLine]", "*******)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "i", ",", "alpha", ",", "beta", ",", "sheshim", ",", "n", ",", "A", 
         ",", "k"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"n", "=", 
         RowBox[{"Length", "[", "d", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"alpha", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"n", "+", "1"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"beta", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"n", "+", "1"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"sheshim", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"alpha", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"b", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "/", 
           RowBox[{"d", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "//", "N"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"beta", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{"f", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "/", 
           RowBox[{"d", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "//", "N"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "2"}], ",", 
          RowBox[{"i", "\[LessEqual]", "n"}], ",", 
          RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"i", "<", "n"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"alpha", "[", 
                RowBox[{"[", 
                 RowBox[{"i", "+", "1"}], "]"}], "]"}], "=", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"b", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], "/", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"a", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", "-", "1"}], "]"}], "]"}], "*", 
                    RowBox[{"alpha", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "+", 
                   RowBox[{"d", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], ")"}]}], "//", "N"}]}], 
              ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"beta", "[", 
             RowBox[{"[", 
              RowBox[{"i", "+", "1"}], "]"}], "]"}], "=", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"f", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "-", 
                RowBox[{
                 RowBox[{"beta", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "*", 
                 RowBox[{"a", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", "-", "1"}], "]"}], "]"}]}]}], ")"}], "/", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"a", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", "-", "1"}], "]"}], "]"}], "*", 
                 RowBox[{"alpha", "[", 
                  RowBox[{"[", "i", "]"}], "]"}]}], "+", 
                RowBox[{"d", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], ")"}]}], "//", "N"}]}]}]}],
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"sheshim", "[", 
          RowBox[{"[", "n", "]"}], "]"}], "=", 
         RowBox[{"beta", "[", 
          RowBox[{"[", 
           RowBox[{"n", "+", "1"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", 
           RowBox[{"n", "-", "1"}]}], ",", 
          RowBox[{"i", ">", "0"}], ",", 
          RowBox[{"i", "--"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"sheshim", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "=", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"alpha", "[", 
                RowBox[{"[", 
                 RowBox[{"i", "+", "1"}], "]"}], "]"}], "*", 
               RowBox[{"sheshim", "[", 
                RowBox[{"[", 
                 RowBox[{"i", "+", "1"}], "]"}], "]"}]}], "+", 
              RowBox[{"beta", "[", 
               RowBox[{"[", 
                RowBox[{"i", "+", "1"}], "]"}], "]"}]}], "//", "N"}]}], 
           ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"If", "[", 
         RowBox[{"info", ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"A", "=", 
            RowBox[{"Table", "[", 
             RowBox[{"0", ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "n"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"k", ",", "n"}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"i", "=", "1"}], ",", 
             RowBox[{"i", "<=", "n"}], ",", 
             RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"A", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "i"}], "]"}], "]"}], "=", 
               RowBox[{"d", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
              
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"i", ">", "1"}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"A", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", 
                    RowBox[{"i", "-", "1"}]}], "]"}], "]"}], "=", 
                  RowBox[{"a", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", "-", "1"}], "]"}], "]"}]}], ";"}]}], 
               "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"i", "<", "n"}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"A", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", 
                    RowBox[{"i", "+", "1"}]}], "]"}], "]"}], "=", 
                  RowBox[{"b", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], ";"}]}], 
               "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<Max[Ax-f]=\>\"", ",", 
             RowBox[{"Max", "[", 
              RowBox[{
               RowBox[{"A", ".", "sheshim"}], "-", "f"}], "]"}]}], "]"}], 
           ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"Return", "[", "sheshim", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", 
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**"}], "******)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"forwardProcedure", "[", 
      RowBox[{
      "distance_", ",", "diam_", ",", "kLCoef_", ",", "TSoilValue_", ",", 
       "Q_", ",", 
       RowBox[{"(*", 
        RowBox[{"gas", " ", "properties"}], "*)"}], "rhon_", ",", 
       "Rspecific_", ",", "p1_", ",", "T1_", ",", "roughness_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "p2", ",", "T2", ",", "S", ",", "Reyn", ",", "f", ",", "cp", ",", 
         "beta", ",", "V", ",", "M", ",", "JouleThomsonCoef", ",", "Kcoef", 
         ",", "Zcurrent"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Set", " ", "data"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"S", "=", 
         RowBox[{"Pi", "*", 
          RowBox[{
           RowBox[{"diam", "^", "2"}], "/", "4"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"M", "=", 
         RowBox[{"Q", "*", "rhon"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Zcurrent", "=", 
         RowBox[{"calculateZ", 
          RowBox[{"(*", 
           RowBox[{"[", "9", "]"}], "*)"}], "[", 
          RowBox[{"rhon", ",", 
           RowBox[{"p1", "*", 
            RowBox[{"10", "^", 
             RowBox[{"(", 
              RowBox[{"-", "6"}], ")"}]}]}], ",", "T1", ",", "Rspecific"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Reyn", "=", 
         RowBox[{"calculateReynolds", 
          RowBox[{"(*", 
           RowBox[{"[", "8", "]"}], "*)"}], "[", 
          RowBox[{"rhon", ",", 
           RowBox[{"p1", "*", 
            RowBox[{"10", "^", 
             RowBox[{"(", 
              RowBox[{"-", "6"}], ")"}]}]}], ",", "T1", ",", "Rspecific", ",",
            "Q", ",", "diam"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"f", "=", 
         RowBox[{"lambdaCoef", "*", 
          RowBox[{"calculateFanningFrictionFactor", "[", 
           RowBox[{"Reyn", ",", "roughness", ",", "diam"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"cp", "=", 
         RowBox[{"calculateCp", "[", 
          RowBox[{"rhon", ",", 
           RowBox[{"p1", "*", 
            RowBox[{"10", "^", 
             RowBox[{"(", 
              RowBox[{"-", "6"}], ")"}]}]}], ",", "T1", ",", "Rspecific"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"beta", "=", 
         RowBox[{"kLCoef", "/", 
          RowBox[{"(", 
           RowBox[{"cp", "*", "M"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"T2", "=", 
         RowBox[{"TSoilValue", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"T1", "-", "TSoilValue"}], ")"}], "*", 
           RowBox[{"Exp", "[", 
            RowBox[{
             RowBox[{"-", "beta"}], "*", "distance"}], "]"}]}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Kcoef", "=", 
         RowBox[{"Zcurrent", "*", 
          RowBox[{"Rspecific", "/", 
           RowBox[{"S", "^", "2"}]}], "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"4", "*", 
             RowBox[{"f", "/", "diam"}], "*", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"TSoilValue", "*", "distance"}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"T1", "-", "TSoilValue"}], ")"}], "/", "beta"}], "-", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"T1", "-", "TSoilValue"}], ")"}], "/", "beta"}], 
                "*", 
                RowBox[{"Exp", "[", 
                 RowBox[{
                  RowBox[{"-", "beta"}], "*", "distance"}], "]"}]}]}], 
              ")"}]}], "-", 
            RowBox[{"2", "*", 
             RowBox[{"(", 
              RowBox[{"T1", "-", "T2"}], ")"}]}]}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"p2", "=", 
         RowBox[{
          RowBox[{"Sqrt", "[", 
           RowBox[{
            RowBox[{"p1", "^", "2"}], "-", 
            RowBox[{"Kcoef", "*", 
             RowBox[{"M", "^", "2"}]}]}], "]"}], "//", "N"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"{", 
          RowBox[{"p2", ",", "T2"}], "}"}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", 
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**"}], "******)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"calculateUVW", "[", 
      RowBox[{"a_", ",", "b_", ",", "c_", ",", "f_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"U", "=", "0"}], ",", 
         RowBox[{"V", "=", "0"}], ",", 
         RowBox[{"W", "=", "0"}], ",", "n", ",", "alpha", ",", "i"}], "}"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"n", "=", 
         RowBox[{"Length", "[", "c", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"n", ">", "1"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"alpha", "=", 
            RowBox[{"Table", "[", 
             RowBox[{"0", ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"alpha", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "=", 
            RowBox[{
             RowBox[{
              RowBox[{"b", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "/", 
              RowBox[{"c", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "//", "N"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"i", "=", "2"}], ",", 
             RowBox[{"i", "<", "n"}], ",", 
             RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"compute", " ", "alpha"}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"alpha", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "=", 
               RowBox[{
                RowBox[{
                 RowBox[{"b", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "/", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"c", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "-", 
                   RowBox[{
                    RowBox[{"a", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", "-", "1"}], "]"}], "]"}], "*", 
                    RowBox[{"alpha", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", "-", "1"}], "]"}], "]"}]}]}], ")"}]}], "//", 
                "N"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"W", "=", 
            RowBox[{
             RowBox[{"1", "/", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"c", "[", 
                 RowBox[{"[", "n", "]"}], "]"}], "-", 
                RowBox[{
                 RowBox[{"a", "[", 
                  RowBox[{"[", 
                   RowBox[{"n", "-", "1"}], "]"}], "]"}], "*", 
                 RowBox[{"alpha", "[", 
                  RowBox[{"[", 
                   RowBox[{"n", "-", "1"}], "]"}], "]"}]}]}], ")"}]}], "//", 
             "N"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"V", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"a", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "/", 
              RowBox[{"c", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "//", "N"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"i", "=", "2"}], ",", 
             RowBox[{"i", "<", "n"}], ",", 
             RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"V", "*=", 
                RowBox[{
                 RowBox[{"a", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "/", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"c", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "-", 
                   RowBox[{
                    RowBox[{"a", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", "-", "1"}], "]"}], "]"}], "*", 
                    RowBox[{"alpha", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", "-", "1"}], "]"}], "]"}]}]}], ")"}]}]}], "//",
                "N"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"V", "*=", 
             RowBox[{"1", "/", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"c", "[", 
                 RowBox[{"[", "n", "]"}], "]"}], "-", 
                RowBox[{
                 RowBox[{"a", "[", 
                  RowBox[{"[", 
                   RowBox[{"n", "-", "1"}], "]"}], "]"}], "*", 
                 RowBox[{"alpha", "[", 
                  RowBox[{"[", 
                   RowBox[{"n", "-", "1"}], "]"}], "]"}]}]}], ")"}]}]}], "//",
             "N"}], ";", "\[IndentingNewLine]", 
           RowBox[{"U", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"a", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "*", 
              RowBox[{
               RowBox[{"f", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "/", 
               RowBox[{"c", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}]}], "+", 
             RowBox[{"f", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
           
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"i", "=", "2"}], ",", 
             RowBox[{"i", "<", "n"}], ",", 
             RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"U", "*=", 
                RowBox[{
                 RowBox[{"a", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "/", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"c", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "-", 
                   RowBox[{
                    RowBox[{"a", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", "-", "1"}], "]"}], "]"}], "*", 
                    RowBox[{"alpha", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", "-", "1"}], "]"}], "]"}]}]}], ")"}]}]}], "//",
                "N"}], ";", "\[IndentingNewLine]", 
              RowBox[{"U", "+=", 
               RowBox[{"f", "[", 
                RowBox[{"[", 
                 RowBox[{"i", "+", "1"}], "]"}], "]"}]}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"U", "*=", 
             RowBox[{
              RowBox[{"-", "1"}], "/", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"c", "[", 
                 RowBox[{"[", "n", "]"}], "]"}], "-", 
                RowBox[{
                 RowBox[{"a", "[", 
                  RowBox[{"[", 
                   RowBox[{"n", "-", "1"}], "]"}], "]"}], "*", 
                 RowBox[{"alpha", "[", 
                  RowBox[{"[", 
                   RowBox[{"n", "-", "1"}], "]"}], "]"}]}]}], ")"}]}]}], "//",
             "N"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"n", "==", "1"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"U", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"-", 
               RowBox[{"f", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "/", 
              RowBox[{"c", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "//", "N"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"V", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "1"}], "/", 
              RowBox[{"c", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "//", "N"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"W", "=", 
            RowBox[{
             RowBox[{"1", "/", 
              RowBox[{"c", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "//", "N"}]}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", " ", "[", 
         RowBox[{"{", 
          RowBox[{"U", ",", "V", ",", "W"}], "}"}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", 
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**"}], "******)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"calculateABC", "[", 
      RowBox[{"a_", ",", "b_", ",", "c_", ",", "f_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"A", "=", "0"}], ",", 
         RowBox[{"B", "=", "0"}], ",", 
         RowBox[{"C", "=", "0"}], ",", "n", ",", "xi", ",", "i"}], "}"}], ",",
        "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"n", "=", 
         RowBox[{"Length", "[", "c", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"n", ">", "1"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"xi", "=", 
            RowBox[{"Table", "[", 
             RowBox[{"0", ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"xi", "[", 
             RowBox[{"[", 
              RowBox[{"n", "-", "1"}], "]"}], "]"}], "=", 
            RowBox[{
             RowBox[{
              RowBox[{"a", "[", 
               RowBox[{"[", 
                RowBox[{"n", "-", "1"}], "]"}], "]"}], "/", 
              RowBox[{"c", "[", 
               RowBox[{"[", "n", "]"}], "]"}]}], "//", "N"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"i", "=", 
              RowBox[{"n", "-", "1"}]}], ",", 
             RowBox[{"i", ">", "1"}], ",", 
             RowBox[{"i", "--"}], ",", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"compute", " ", "alpha"}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"xi", "[", 
                RowBox[{"[", 
                 RowBox[{"i", "-", "1"}], "]"}], "]"}], "=", 
               RowBox[{
                RowBox[{
                 RowBox[{"a", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", "-", "1"}], "]"}], "]"}], "/", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"c", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "-", 
                   RowBox[{
                    RowBox[{"b", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "*", 
                    RowBox[{"xi", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}]}], ")"}]}], "//", 
                "N"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"B", "=", 
            RowBox[{
             RowBox[{"1", "/", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"c", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "-", 
                RowBox[{
                 RowBox[{"b", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "*", 
                 RowBox[{"xi", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}]}], ")"}]}], "//", "N"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"C", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"-", 
               RowBox[{"b", "[", 
                RowBox[{"[", 
                 RowBox[{"n", "-", "1"}], "]"}], "]"}]}], "/", 
              RowBox[{"c", "[", 
               RowBox[{"[", "n", "]"}], "]"}]}], "//", "N"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"i", "=", 
              RowBox[{"n", "-", "1"}]}], ",", 
             RowBox[{"i", ">=", "2"}], ",", 
             RowBox[{"i", "--"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"C", "*=", 
                RowBox[{
                 RowBox[{"b", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", "-", "1"}], "]"}], "]"}], "/", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"c", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "-", 
                   RowBox[{
                    RowBox[{"b", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "*", 
                    RowBox[{"xi", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}]}], ")"}]}]}], "//", 
               "N"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"C", "*=", 
             RowBox[{"1", "/", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"c", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "-", 
                RowBox[{
                 RowBox[{"b", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "*", 
                 RowBox[{"xi", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}]}], ")"}]}]}], "//", "N"}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"A", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"b", "[", 
               RowBox[{"[", 
                RowBox[{"n", "-", "1"}], "]"}], "]"}], "*", 
              RowBox[{
               RowBox[{"f", "[", 
                RowBox[{"[", 
                 RowBox[{"n", "-", "2"}], "]"}], "]"}], "/", 
               RowBox[{"c", "[", 
                RowBox[{"[", "n", "]"}], "]"}]}]}], "+", 
             RowBox[{"f", "[", 
              RowBox[{"[", 
               RowBox[{"n", "-", "1"}], "]"}], "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"i", "=", 
              RowBox[{"n", "-", "1"}]}], ",", 
             RowBox[{"i", ">=", "2"}], ",", 
             RowBox[{"i", "--"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"A", "*=", 
                RowBox[{
                 RowBox[{"b", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", "-", "1"}], "]"}], "]"}], "/", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"c", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "-", 
                   RowBox[{
                    RowBox[{"b", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "*", 
                    RowBox[{"xi", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}]}], ")"}]}]}], "//", 
               "N"}], ";", "\[IndentingNewLine]", 
              RowBox[{"A", "+=", 
               RowBox[{"f", "[", 
                RowBox[{"[", 
                 RowBox[{"i", "-", "1"}], "]"}], "]"}]}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"A", "*=", 
             RowBox[{"1", "/", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"c", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "-", 
                RowBox[{
                 RowBox[{"b", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "*", 
                 RowBox[{"xi", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}]}], ")"}]}]}], "//", 
            "N"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"n", "==", "1"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"A", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"f", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "/", 
              RowBox[{"c", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "//", "N"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"B", "=", 
            RowBox[{
             RowBox[{"1", "/", 
              RowBox[{"c", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "//", "N"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"C", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "1"}], "/", 
              RowBox[{"c", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "//", "N"}]}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", " ", "[", 
         RowBox[{"{", 
          RowBox[{"A", ",", "B", ",", "C"}], "}"}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", 
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**"}], "******)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"totalRegimeCalculation", "[", 
      RowBox[{
      "atmP_", ",", "atmT_", ",", "totalData_", ",", "directions_", ",", 
       "roughness_", ",", "checkMode_", ",", "tableInfo_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"local", " ", "parameters"}], "*)"}], "\[IndentingNewLine]", 
        
        RowBox[{
         RowBox[{"sumIn", "=", "0"}], ",", 
         RowBox[{"sumOut", "=", "0"}], ",", "s", ",", "lens", ",", 
         "commonLastVertices", ",", "commonStartPoint", ",", 
         "commonStartVertices", ",", "lenl", ",", "m", ",", "num", ",", 
         "lends", ",", "len", ",", "calculatingDirections", ",", 
         "numCalculatingDirections", ",", 
         RowBox[{"numDirections", "=", 
          RowBox[{"Length", "[", "directions", "]"}]}], ",", "directionFrom", 
         ",", "directionIn", ",", "directionTo", ",", "detected", ",", "t", 
         ",", "numCommonStartPoint", ",", "numCommonLastVertices", ",", 
         "numCommonStartVertices", ",", "countIn", ",", "countOut", ",", 
         "countMedium", ",", "countTemp", ",", "commonLastVerticesLocal", ",",
          "lenFrom", ",", "SFrom", ",", "STo", ",", "kCoef", ",", "lenTo", 
         ",", "nextDirection", ",", "count", ",", 
         RowBox[{"rhonResult", "=", "0"}], ",", "H2Result", ",", "CO2Result", 
         ",", "hsResult", ",", "MmolarResult", ",", "RspecificResult", ",", 
         "sumQ", ",", "gasFraction", ",", "rhon", ",", "Rspecific", ",", 
         "Mmolar", ",", "p", ",", "T", ",", "Q", ",", "lenm", ",", 
         "TResultSum", ",", "TResult", ",", "cp", ",", "pIn", ",", "TIn", ",",
          "typePoint", ",", "ksId", ",", "M", ",", "TempKS", ",", 
         "numCalculatedDirections", ",", "numCommonTotalLastVertices", ",", 
         "l", ",", "k", ",", "id", ",", "detectedFaucetRegulator", ",", 
         "commonStartPointLocal", ",", "numCommonStartPointLocal", ",", 
         "numCommonTotalVertices", ",", "ll", ",", "commonStartPointInverse", 
         ",", "times", ",", "numCommonStartPointInverse", ",", 
         "calculatedDirectionsFourthStep", ",", 
         "calculatedDirectionsFifthStep", ",", 
         "numCalculatedDirectionsFifthStep", ",", 
         "numCalculatedDirectionsFifthStepPrev", ",", "tt", ",", "dominant", 
         ",", "hs", ",", "Z"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
          RowBox[{"++", 
           RowBox[{"++", 
            RowBox[{"+", " ", "TOTAL"}]}]}], " ", "WORK", " ", "REGIME", " ", 
          "FOR", " ", "BUKHARA"}], "-", 
         RowBox[{
          RowBox[{"URAL", " ", "++"}], "++"}], "+"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "just", " ", "evaluate", " ", "globalVariables", " ", "to", " ", 
         "import", " ", "data", " ", "from", " ", "files"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"-", " ", "1"}]}]}]}]}]}]}]}]}]}]}], " ", "-", " ", 
         RowBox[{"S", " ", "T", " ", "E", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"P", " ", "--"}], "--"}], "--"}]}], "-", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", "--"}]}]}]}]}]}]}]}]}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
          RowBox[{"++", 
           RowBox[{"++", 
            RowBox[{"++", 
             RowBox[{"+", " ", "Main"}]}]}]}], " ", "procedure", " ", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"gas", " ", "volumes"}], ")"}], "++"}], "++"}], 
           "++"}]}], "+"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
          RowBox[{"++", 
           RowBox[{"++", 
            RowBox[{"++", 
             RowBox[{"+", " ", "Set"}]}]}]}], " ", "gas", " ", "volumes", " ",
           "for", " ", "all", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"directions", " ", "++"}], "++"}], "++"}]}], "+"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"calculatedDirections", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"m", "=", "1"}], ",", 
          RowBox[{"m", "\[LessEqual]", "numDirections"}], ",", 
          RowBox[{"m", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"totalData", "[", 
                RowBox[{"m", ",", "\"\<Type\>\""}], "]"}], "==", 
               "\"\<in\>\""}], "||", 
              RowBox[{
               RowBox[{"totalData", "[", 
                RowBox[{"m", ",", "\"\<Type\>\""}], "]"}], "==", 
               "\"\<out\>\""}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"calculatedDirections", "=", 
               RowBox[{"Insert", "[", 
                RowBox[{"calculatedDirections", ",", "m", ",", 
                 RowBox[{"-", "1"}]}], "]"}]}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<initial directions: \>\"", ",", " ", "calculatedDirections"}],
            "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"num", "=", "0"}], ";", "\[IndentingNewLine]", 
        RowBox[{"lends", "=", 
         RowBox[{"Length", "[", "calculatedDirections", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"detectedFaucetRegulator", "=", "False"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "calculatedDirections", "]"}], "<", 
           "numDirections"}], ",", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"To", " ", "avoid", " ", "infinitely", " ", "loop"}], 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"lends", "==", 
               RowBox[{"Length", "[", "calculatedDirections", "]"}]}], "&&", 
              RowBox[{"num", ">", "0"}]}], ",", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"Print", "[", 
                RowBox[{"\"\<Stopped in iteration No\>\"", ",", "num"}], 
                "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Break", "[", "]"}], ";"}]}], "\[IndentingNewLine]", 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{
              "\"\<calculatedDirections: \>\"", ",", "calculatedDirections"}],
               "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"lends", "=", 
            RowBox[{"Length", "[", "calculatedDirections", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"num", "++"}], ";", "\[IndentingNewLine]", 
           RowBox[{"calculatingDirections", "=", 
            RowBox[{"Select", "[", 
             RowBox[{"directionIndexes", ",", 
              RowBox[{
               RowBox[{"!", 
                RowBox[{"MemberQ", "[", 
                 RowBox[{"calculatedDirections", ",", "#"}], "]"}]}], "&"}]}],
              "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"numCalculatingDirections", "=", 
            RowBox[{"Length", "[", "calculatingDirections", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"l", "=", "1"}], ",", 
             RowBox[{"l", "\[LessEqual]", "numCalculatingDirections"}], ",", 
             RowBox[{"l", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"m", "=", 
               RowBox[{"calculatingDirections", "[", 
                RowBox[{"[", "l", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
              
              RowBox[{"commonLastVertices", "=", 
               RowBox[{"commonTotalLastVertices", "[", 
                RowBox[{"[", "m", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
              
              RowBox[{"numCommonLastVertices", "=", 
               RowBox[{"Length", "[", "commonLastVertices", "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"commonStartVertices", "=", 
               RowBox[{"commonTotalStartVertices", "[", 
                RowBox[{"[", "m", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
              
              RowBox[{"numCommonStartVertices", "=", 
               RowBox[{"Length", "[", "commonStartVertices", "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"commonStartPoint", "=", 
               RowBox[{"commonTotalStartPoint", "[", 
                RowBox[{"[", "m", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
              
              RowBox[{"numCommonStartPoint", "=", 
               RowBox[{"Length", "[", "commonStartPoint", "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"commonStartPointInverse", "=", 
               RowBox[{"commonTotalStartPointInverse", "[", 
                RowBox[{"[", "m", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
              
              RowBox[{"numCommonStartPointInverse", "=", 
               RowBox[{"Length", "[", "commonStartPointInverse", "]"}]}], ";",
               "\[IndentingNewLine]", 
              RowBox[{"countIn", "=", "0"}], ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"k", "=", "1"}], ",", 
                RowBox[{"k", "<=", "numCommonLastVertices"}], ",", 
                RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{
                    RowBox[{"commonLastVertices", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], ",", "\"\<Q\>\""}], "]"}],
                     "\[GreaterEqual]", "0"}], ",", "\[IndentingNewLine]", 
                   RowBox[{"countIn", "++"}]}], "\[IndentingNewLine]", "]"}], 
                 ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"countOut", "=", "0"}], ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"k", "=", "1"}], ",", 
                RowBox[{"k", "<=", "numCommonStartVertices"}], ",", 
                RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{
                    RowBox[{"commonStartVertices", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], ",", "\"\<Q\>\""}], "]"}],
                     "\[GreaterEqual]", "0"}], ",", "\[IndentingNewLine]", 
                   RowBox[{"countOut", "++"}]}], "\[IndentingNewLine]", "]"}],
                  ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"countMedium", "=", "0"}], ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"k", "=", "1"}], ",", 
                RowBox[{"k", "<=", "numCommonStartPoint"}], ",", 
                RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{
                    RowBox[{"commonStartPoint", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], ",", "\"\<Q\>\""}], "]"}],
                     "\[GreaterEqual]", "0"}], ",", "\[IndentingNewLine]", 
                   RowBox[{"countMedium", "++"}]}], "\[IndentingNewLine]", 
                  "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{"forward", " ", "computation"}], "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"countIn", "\[Equal]", 
                  RowBox[{"numCommonLastVertices", "-", "1"}]}], "&&", 
                 RowBox[{"countMedium", "\[Equal]", "numCommonStartPoint"}]}],
                 ",", "\[IndentingNewLine]", 
                RowBox[{"(*", 
                 RowBox[{
                  RowBox[{"Print", "[", 
                   RowBox[{"\"\<direction-\>\"", ",", "m"}], "]"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Print", "[", 
                   RowBox[{"directions", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "]"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Print", "[", "\"\<forward computation\>\"", "]"}], 
                  ";"}], "*)"}], "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"numCommonLastVertices", "\[Equal]", "1"}], "&&", 
                    
                    RowBox[{
                    RowBox[{"Length", "[", "commonStartPoint", "]"}], ">", 
                    "0"}]}], ",", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{"m", ",", "\"\<Q\>\""}], "]"}], "=", 
                    RowBox[{"Sum", "[", 
                    RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{"ll", ",", "\"\<Q\>\""}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"ll", ",", "commonStartPoint"}], "}"}]}], "]"}]}],
                    ",", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{"m", ",", "\"\<Q\>\""}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"Sum", "[", 
                    RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{"ll", ",", "\"\<Q\>\""}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"ll", ",", "commonStartPoint"}], "}"}]}], "]"}], 
                    "-", 
                    RowBox[{"Sum", "[", 
                    RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{"ll", ",", "\"\<Q\>\""}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"ll", ",", "commonLastVertices"}], "}"}]}], "]"}],
                     "-", "1"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";",
                  "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{
                    RowBox[{"commonStartPoint", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<Type\>\""}], 
                    "]"}], "\[Equal]", "\"\<station\>\""}], ",", 
                   RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{"m", ",", "\"\<Q\>\""}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{"m", ",", "\"\<Q\>\""}], "]"}], "+", 
                    "3000.0"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
                 RowBox[{"calculatedDirections", "=", 
                  RowBox[{"Insert", "[", 
                   RowBox[{"calculatedDirections", ",", "m", ",", 
                    RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"writeDataToDataInfo", "[", 
                  RowBox[{"m", ",", 
                   RowBox[{"{", "5", "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"totalData", "[", 
                    RowBox[{"m", ",", "\"\<Q\>\""}], "]"}], "}"}]}], "]"}], 
                 ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{"backward", " ", "computation"}], "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"countOut", "\[Equal]", 
                  RowBox[{"numCommonStartVertices", "-", "1"}]}], "&&", 
                 RowBox[{"!", 
                  RowBox[{"MemberQ", "[", 
                   RowBox[{"calculatedDirections", ",", "m"}], "]"}]}]}], ",",
                 "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"countIn", "=", "0"}], ";", "\[IndentingNewLine]", 
                 RowBox[{"t", "=", 
                  RowBox[{"commonStartPointInverse", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"commonStartPoint", "=", 
                  RowBox[{"commonTotalStartPoint", "[", 
                   RowBox[{"[", "t", "]"}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"commonLastVertices", "=", 
                  RowBox[{"commonTotalLastVertices", "[", 
                   RowBox[{"[", "t", "]"}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"countIn", "=", "0"}], ";", "\[IndentingNewLine]", 
                 RowBox[{"numCommonLastVertices", "=", 
                  RowBox[{"Length", "[", "commonLastVertices", "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"For", "[", 
                  RowBox[{
                   RowBox[{"k", "=", "1"}], ",", 
                   RowBox[{"k", "<=", "numCommonLastVertices"}], ",", 
                   RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{
                    RowBox[{"commonLastVertices", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], ",", "\"\<Q\>\""}], "]"}],
                     "\[GreaterEqual]", "0"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"countIn", "++"}]}], "\[IndentingNewLine]", "]"}],
                     ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"countIn", "\[Equal]", "numCommonLastVertices"}], 
                   ",", "\[IndentingNewLine]", 
                   RowBox[{"(*", 
                    RowBox[{
                    RowBox[{"Print", "[", 
                    RowBox[{"\"\<direction-\>\"", ",", "m"}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Print", "[", 
                    RowBox[{"directions", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    "Print", "[", "\"\<backward computation\>\"", "]"}], 
                    ";"}], "*)"}], "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"numCommonStartVertices", "\[Equal]", "1"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{"m", ",", "\"\<Q\>\""}], "]"}], "=", 
                    RowBox[{"Sum", "[", 
                    RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{"ll", ",", "\"\<Q\>\""}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"ll", ",", "commonLastVertices"}], "}"}]}], 
                    "]"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{"m", ",", "\"\<Q\>\""}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"Sum", "[", 
                    RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{"ll", ",", "\"\<Q\>\""}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"ll", ",", "commonLastVertices"}], "}"}]}], "]"}],
                     "-", 
                    RowBox[{"Sum", "[", 
                    RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{"ll", ",", "\"\<Q\>\""}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"ll", ",", "commonStartPoint"}], "}"}]}], "]"}], 
                    "-", "1"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{"m", ",", "\"\<Type\>\""}], "]"}], "\[Equal]", 
                    "\"\<station\>\""}], ",", 
                    RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{"m", ",", "\"\<Q\>\""}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{"m", ",", "\"\<Q\>\""}], "]"}], "-", 
                    "3000.0"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"calculatedDirections", "=", 
                    RowBox[{"Insert", "[", 
                    RowBox[{"calculatedDirections", ",", "m", ",", 
                    RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"writeDataToDataInfo", "[", 
                    RowBox[{"m", ",", 
                    RowBox[{"{", "5", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"totalData", "[", 
                    RowBox[{"m", ",", "\"\<Q\>\""}], "]"}], "}"}]}], "]"}], 
                    ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
               "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
            "parallel", " ", "tubes", " ", "bridge", " ", "detection"}], 
            "*)"}], "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"lends", "==", 
               RowBox[{"Length", "[", "calculatedDirections", "]"}]}], "&&", 
              RowBox[{"num", ">", "0"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"calculatingDirections", "=", 
               RowBox[{"Select", "[", 
                RowBox[{"directionIndexes", ",", 
                 RowBox[{
                  RowBox[{"!", 
                   RowBox[{"MemberQ", "[", 
                    RowBox[{"calculatedDirections", ",", "#"}], "]"}]}], 
                  "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"numCalculatingDirections", "=", 
               RowBox[{"Length", "[", "calculatingDirections", "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"l", "=", "1"}], ",", 
                RowBox[{"l", "\[LessEqual]", "numCalculatingDirections"}], 
                ",", 
                RowBox[{"l", "++"}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"m", "=", 
                  RowBox[{"calculatingDirections", "[", 
                   RowBox[{"[", "l", "]"}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"(*", 
                  RowBox[{
                   RowBox[{"see", " ", "image", " ", "from", " ", 
                    RowBox[{
                    RowBox[{"explanation", "/", "images"}], "/", "1"}]}], "-", 
                   RowBox[{"step", "/", 
                    RowBox[{"parallel_tubes", ".", "jpeg"}]}]}], "*)"}], 
                 "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"directions", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "]"}], "\[Equal]", "2"}], 
                   ",", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"directionFrom", "=", "0"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"directionTo", "=", "0"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"directionIn", "=", "0"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"detected", "=", "False"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"commonStartPointInverse", "=", 
                    RowBox[{"commonTotalStartPointInverse", "[", 
                    RowBox[{"[", "m", "]"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", "commonStartPointInverse", "]"}], 
                    "\[Equal]", "1"}], "&&", 
                    RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{
                    RowBox[{"commonStartPointInverse", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<Q\>\""}], "]"}],
                     "\[GreaterEqual]", "0"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"directionFrom", "=", 
                    RowBox[{"commonStartPointInverse", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"commonStartPoint", "=", 
                    RowBox[{"commonTotalStartPoint", "[", 
                    RowBox[{"[", "directionFrom", "]"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", "commonStartPoint", "]"}], 
                    "\[Equal]", "2"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"detected", "=", "True"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                  "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                 RowBox[{"commonLastVerticesLocal", "=", 
                  RowBox[{"commonTotalLastVertices", "[", 
                   RowBox[{"[", "m", "]"}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"detected", "&&", 
                    RowBox[{
                    RowBox[{"Length", "[", "commonLastVerticesLocal", "]"}], 
                    ">", "1"}]}], ",", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"commonStartPointLocal", "=", 
                    RowBox[{"commonTotalStartPoint", "[", 
                    RowBox[{"[", "m", "]"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"numCommonStartPointLocal", "=", 
                    RowBox[{"Length", "[", "commonStartPointLocal", "]"}]}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{"directionIn", "=", 
                    RowBox[{"commonLastVerticesLocal", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", "commonStartPointLocal", "]"}], 
                    "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"directionTo", "=", 
                    RowBox[{"commonStartPointLocal", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{"directionIn", ",", "\"\<Q\>\""}], "]"}], 
                    "\[GreaterEqual]", "0"}], "&&", 
                    RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{"directionFrom", ",", "\"\<Q\>\""}], "]"}], 
                    "\[GreaterEqual]", "0"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{
                    "Print", "[", "\"\<parallel tubes detected\>\"", "]"}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{"Print", "[", 
                    RowBox[{"\"\<direction-\>\"", ",", "m"}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Print", "[", 
                    RowBox[{"directions", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Print", "[", "\"\<bridge computation\>\"", "]"}],
                     ";"}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"lenFrom", "=", 
                    RowBox[{"Length", "[", 
                    RowBox[{"directions", "[", 
                    RowBox[{"[", "directionFrom", "]"}], "]"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"SFrom", "=", 
                    RowBox[{
                    RowBox[{"Pi", "*", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"diameters", "[", 
                    RowBox[{
                    RowBox[{"directions", "[", 
                    RowBox[{"[", 
                    RowBox[{"directionFrom", ",", 
                    RowBox[{"lenFrom", "-", "1"}]}], "]"}], "]"}], ",", 
                    RowBox[{"directions", "[", 
                    RowBox[{"[", 
                    RowBox[{"directionFrom", ",", "lenFrom"}], "]"}], "]"}]}],
                     "]"}], "^", "2"}], "/", "4"}]}], "//", "N"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"lenTo", "=", 
                    RowBox[{"Length", "[", 
                    RowBox[{"directions", "[", 
                    RowBox[{"[", "directionTo", "]"}], "]"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"STo", "=", 
                    RowBox[{
                    RowBox[{"Pi", "*", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"diameters", "[", 
                    RowBox[{
                    RowBox[{"directions", "[", 
                    RowBox[{"[", 
                    RowBox[{"directionTo", ",", 
                    RowBox[{"lenTo", "-", "1"}]}], "]"}], "]"}], ",", 
                    RowBox[{"directions", "[", 
                    RowBox[{"[", 
                    RowBox[{"directionTo", ",", "lenTo"}], "]"}], "]"}]}], 
                    "]"}], "^", "2"}], "/", "4"}]}], "//", "N"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"kCoef", "=", 
                    RowBox[{"STo", "/", 
                    RowBox[{"(", 
                    RowBox[{"STo", "+", "SFrom"}], ")"}]}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{"m", ",", "\"\<Q\>\""}], "]"}], "=", 
                    RowBox[{"kCoef", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{"directionFrom", ",", "\"\<Q\>\""}], "]"}], "-", 
                    RowBox[{"totalData", "[", 
                    RowBox[{"directionIn", ",", "\"\<Q\>\""}], "]"}]}], 
                    ")"}]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"calculatedDirections", "=", 
                    RowBox[{"Insert", "[", 
                    RowBox[{"calculatedDirections", ",", "m", ",", 
                    RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"writeDataToDataInfo", "[", 
                    RowBox[{"m", ",", 
                    RowBox[{"{", "5", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"totalData", "[", 
                    RowBox[{"m", ",", "\"\<Q\>\""}], "]"}], "}"}]}], "]"}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{"Break", "[", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
                  "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"check", " ", "station", " ", "full", " ", "load"}], 
            "*)"}], "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"lends", "==", 
               RowBox[{"Length", "[", "calculatedDirections", "]"}]}], "&&", 
              RowBox[{"num", ">", "0"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"calculatingDirections", "=", 
               RowBox[{"Select", "[", 
                RowBox[{"directionIndexes", ",", 
                 RowBox[{
                  RowBox[{"!", 
                   RowBox[{"MemberQ", "[", 
                    RowBox[{"calculatedDirections", ",", "#"}], "]"}]}], 
                  "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"numCalculatingDirections", "=", 
               RowBox[{"Length", "[", "calculatingDirections", "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"l", "=", "1"}], ",", 
                RowBox[{"l", "\[LessEqual]", "numCalculatingDirections"}], 
                ",", 
                RowBox[{"l", "++"}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"m", "=", 
                  RowBox[{"calculatingDirections", "[", 
                   RowBox[{"[", "l", "]"}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"checkStationFullLoad", "[", "m", "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"(*", 
                    RowBox[{
                    RowBox[{
                    "Print", "[", "\"\<check station full load\>\"", "]"}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{"Print", "[", 
                    RowBox[{"\"\<direction-\>\"", ",", "m"}], "]"}], ";"}], 
                    "*)"}], "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"Break", "[", "]"}], ";"}]}], 
                  "\[IndentingNewLine]", "]"}], ";"}]}], 
               "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
            "check", " ", "gas", " ", "stream", " ", "splitting", " ", 
             "equally"}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"lends", "==", 
               RowBox[{"Length", "[", "calculatedDirections", "]"}]}], "&&", 
              RowBox[{"num", ">", "0"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"calculatingDirections", "=", 
               RowBox[{"Select", "[", 
                RowBox[{"directionIndexes", ",", 
                 RowBox[{
                  RowBox[{"!", 
                   RowBox[{"MemberQ", "[", 
                    RowBox[{"calculatedDirections", ",", "#"}], "]"}]}], 
                  "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"numCalculatingDirections", "=", 
               RowBox[{"Length", "[", "calculatingDirections", "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"l", "=", "1"}], ",", 
                RowBox[{"l", "\[LessEqual]", "numCalculatingDirections"}], 
                ",", 
                RowBox[{"l", "++"}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"m", "=", 
                  RowBox[{"calculatingDirections", "[", 
                   RowBox[{"[", "l", "]"}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"streamSplitEqually", "[", "m", "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"Break", "[", "]"}], ";"}]}], 
                  "\[IndentingNewLine]", "]"}], ";"}]}], 
               "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
            "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "compute", " ", "all", " ", "angles", " ", "of", " ", "the", " ", 
          "faucet", " ", "regulators"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"m", "=", "1"}], ",", 
            RowBox[{"m", "\[LessEqual]", "numDirections"}], ",", 
            RowBox[{"m", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"checkFaucetRegulator", "[", "m", "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{
                 "Print", "[", "\"\<detected faucet regulator\>\"", "]"}], 
                 ";", "\[IndentingNewLine]", 
                 RowBox[{"Print", "[", 
                  RowBox[{"\"\<direction-\>\"", ",", "m"}], "]"}], ";"}], 
                "*)"}], "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"computeFaucetRegulator", "[", "m", "]"}], ";"}]}], 
              "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
           "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", "checkMode"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", "\"\<1 - S T E P: COMPLETE\>\"", "]"}], 
           ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"If", "[", 
         RowBox[{"tableInfo", ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "Print", "[", 
            "\"\<(*--------------------- 1 - S T E P \
-------------------------*)\>\"", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{
           "Print", "[", "\"\<Data after computations gas volumes Q:\>\"", 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"CellPrint", "[", 
            RowBox[{"TextCell", "[", 
             RowBox[{"Grid", "[", 
              RowBox[{"dataInfo", ",", 
               RowBox[{"Alignment", "\[Rule]", "Left"}], ",", 
               RowBox[{"Spacings", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"2", ",", "1"}], "}"}]}], ",", 
               RowBox[{"Frame", "\[Rule]", "All"}], ",", 
               RowBox[{"ItemStyle", "\[Rule]", "\"\<Text\>\""}], ",", 
               RowBox[{"Background", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"LightCyan", ",", "None"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"LightGreen", ",", "None"}], "}"}]}], "}"}]}]}], 
              "]"}], "]"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Check", " ", "gas", " ", "volumes", " ", "with", " ", "file", " ", 
          "data"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"m", "=", "1"}], ",", 
            RowBox[{"m", "\[LessEqual]", "numDirections"}], ",", 
            RowBox[{"m", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"totalData", "[", 
                  RowBox[{"m", ",", "\"\<Q\>\""}], "]"}], "-", 
                 RowBox[{"dataset", "[", 
                  RowBox[{"[", 
                   RowBox[{"m", ",", "\"\<Q\>\""}], "]"}], "]"}]}], 
                "\[NotEqual]", "0"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Print", "[", 
                 RowBox[{"\"\<direction=\>\"", ",", 
                  RowBox[{"directions", "[", 
                   RowBox[{"[", "m", "]"}], "]"}]}], "]"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"Print", "[", 
                 RowBox[{
                  RowBox[{"totalData", "[", 
                   RowBox[{"m", ",", "\"\<Q\>\""}], "]"}], "-", 
                  RowBox[{"dataset", "[", 
                   RowBox[{"[", 
                    RowBox[{"m", ",", "\"\<Q\>\""}], "]"}], "]"}]}], "]"}], 
                ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", " ", "2"}]}]}]}]}]}]}]}]}]}]}], " ", "-", 
          " ", 
          RowBox[{"S", " ", "T", " ", "E", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"P", " ", "--"}], "--"}], "--"}]}], "-", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", "--"}]}]}]}]}]}]}]}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
           RowBox[{"++", 
            RowBox[{"++", 
             RowBox[{"++", 
              RowBox[{"+", " ", "Main"}]}]}]}], " ", "procedure", " ", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"gas", " ", "properties"}], ")"}], "++"}], "++"}], 
            "++"}]}], "+"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
           RowBox[{"++", 
            RowBox[{"++", 
             RowBox[{"++", 
              RowBox[{"+", " ", "Set"}]}]}]}], " ", "gas", " ", "properties", 
           " ", "for", " ", "all", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"directions", " ", "++"}], "++"}], "++"}]}], "+"}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"calculatedDirections", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"directionIndexes", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"k", ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "numDirections"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"lends", "=", 
         RowBox[{"Length", "[", "calculatedDirections", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"num", "=", "0"}], ";", "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{"True", ",", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"To", " ", "avoid", " ", "infinitely", " ", "loop"}], 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"num", ">", "0"}], "&&", 
              RowBox[{
               RowBox[{"Length", "[", "calculatedDirections", "]"}], 
               "\[Equal]", "lends"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"Print", "[", 
                RowBox[{"\"\<Stopped in iteration No\>\"", ",", "num"}], 
                "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"Break", "[", "]"}]}], "\[IndentingNewLine]", "]"}], ";",
            "\[IndentingNewLine]", 
           RowBox[{"num", "++"}], ";", "\[IndentingNewLine]", 
           RowBox[{"lends", "=", 
            RowBox[{"Length", "[", "calculatedDirections", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"calculatingDirections", "=", 
            RowBox[{"Select", "[", 
             RowBox[{"directionIndexes", ",", 
              RowBox[{
               RowBox[{"!", 
                RowBox[{"MemberQ", "[", 
                 RowBox[{"calculatedDirections", ",", "#"}], "]"}]}], "&"}]}],
              "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"numCalculatingDirections", "=", 
            RowBox[{"Length", "[", "calculatingDirections", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"t", "=", "1"}], ",", 
             RowBox[{"t", "\[LessEqual]", "numCalculatingDirections"}], ",", 
             RowBox[{"t", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"m", "=", 
               RowBox[{"calculatingDirections", "[", 
                RowBox[{"[", "t", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
              
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"!", 
                 RowBox[{"MemberQ", "[", 
                  RowBox[{"calculatedDirections", ",", "m"}], "]"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"(*", 
                 RowBox[{
                 "Directions", " ", "with", " ", "common", " ", "last", " ", 
                  "point"}], "*)"}], "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"commonLastVertices", "=", 
                  RowBox[{"commonTotalLastVertices", "[", 
                   RowBox[{"[", "m", "]"}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"(*", 
                  RowBox[{
                  "Number", " ", "of", " ", "directions", " ", "with", " ", 
                   "common", " ", "last", " ", "point"}], "*)"}], 
                 "\[IndentingNewLine]", 
                 RowBox[{"numCommonLastVertices", "=", 
                  RowBox[{"Length", "[", "commonLastVertices", "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"commonStartPoint", "=", 
                  RowBox[{"commonTotalStartPoint", "[", 
                   RowBox[{"[", "m", "]"}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"numCommonStartPoint", "=", 
                  RowBox[{"Length", "[", "commonStartPoint", "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"(*", 
                  RowBox[{
                  "Change", " ", "gas", " ", "properties", " ", "for", " ", 
                   "next", " ", "directions"}], "*)"}], "\[IndentingNewLine]", 
                 RowBox[{"(*", 
                  RowBox[{
                  "Check", " ", "gas", " ", "properties", " ", 
                   "availability"}], "*)"}], "\[IndentingNewLine]", 
                 RowBox[{"count", "=", "0"}], ";", "\[IndentingNewLine]", 
                 RowBox[{"For", "[", 
                  RowBox[{
                   RowBox[{"k", "=", "1"}], ",", 
                   RowBox[{"k", "<=", "numCommonLastVertices"}], ",", 
                   RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{
                    RowBox[{"commonLastVertices", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], ",", "\"\<rhon\>\""}], 
                    "]"}], ">=", "0"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"count", "++"}], ";"}]}], "\[IndentingNewLine]", 
                    "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"count", "==", "numCommonLastVertices"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"l", "=", "1"}], ",", 
                    RowBox[{"l", "\[LessEqual]", "numCommonStartPoint"}], ",", 
                    RowBox[{"l", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"nextDirection", "=", 
                    RowBox[{"commonStartPoint", "[", 
                    RowBox[{"[", "l", "]"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"l", "\[Equal]", "1"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    "Calculate", " ", "mixed", " ", "gas", " ", "properties", 
                    " ", "using", " ", "gas", " ", "fractions"}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"rhonResult", "=", "0"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"H2Result", "=", "0"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"CO2Result", "=", "0"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"hsResult", "=", "0"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"MmolarResult", "=", "0"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"sumQ", "=", 
                    RowBox[{"Sum", "[", 
                    RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{"ll", ",", "\"\<Q\>\""}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"ll", ",", "commonLastVertices"}], "}"}]}], 
                    "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"sumQ", ">", "0"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"k", "=", "1"}], ",", 
                    RowBox[{"k", "<=", "numCommonLastVertices"}], ",", 
                    RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"gasFraction", "=", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{
                    RowBox[{"commonLastVertices", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], ",", "\"\<Q\>\""}], "]"}],
                     "/", "sumQ"}], "//", "N"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"rhonResult", "=", 
                    RowBox[{"rhonResult", "+", 
                    RowBox[{"gasFraction", "*", 
                    RowBox[{"totalData", "[", 
                    RowBox[{
                    RowBox[{"commonLastVertices", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], ",", "\"\<rhon\>\""}], 
                    "]"}]}]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"hsResult", "=", 
                    RowBox[{"hsResult", "+", 
                    RowBox[{"gasFraction", "*", 
                    RowBox[{"totalData", "[", 
                    RowBox[{
                    RowBox[{"commonLastVertices", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], ",", "\"\<hs\>\""}], 
                    "]"}]}]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"MmolarResult", "=", 
                    RowBox[{"MmolarResult", "+", 
                    RowBox[{"gasFraction", "*", 
                    RowBox[{"totalData", "[", 
                    RowBox[{
                    RowBox[{"commonLastVertices", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], ",", "\"\<Mmolar\>\""}], 
                    "]"}]}]}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"RspecificResult", "=", 
                    RowBox[{
                    "calculateRspecific", "[", "MmolarResult", "]"}]}], 
                    ";"}]}], "\[IndentingNewLine]", "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"rhonResult", "=", 
                    RowBox[{"totalData", "[", 
                    RowBox[{
                    RowBox[{"commonStartPoint", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<rhon\>\""}], 
                    "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"hsResult", "=", 
                    RowBox[{"totalData", "[", 
                    RowBox[{
                    RowBox[{"commonStartPoint", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<hs\>\""}], 
                    "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"MmolarResult", "=", 
                    RowBox[{"totalData", "[", 
                    RowBox[{
                    RowBox[{"commonStartPoint", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<Mmolar\>\""}], 
                    "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"RspecificResult", "=", 
                    RowBox[{"totalData", "[", 
                    RowBox[{
                    RowBox[{"commonStartPoint", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    "\"\<Rspecific\>\""}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                    
                    RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{"nextDirection", ",", "\"\<rhon\>\""}], "]"}], 
                    "=", "rhonResult"}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{"nextDirection", ",", "\"\<hs\>\""}], "]"}], "=", 
                    "hsResult"}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{"nextDirection", ",", "\"\<Mmolar\>\""}], "]"}], 
                    "=", "MmolarResult"}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{
                    StyleBox["nextDirection",
                    FontWeight->"Plain"], ",", "\"\<Rspecific\>\""}], "]"}], 
                    "=", "RspecificResult"}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"dataInfo", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"nextDirection", "+", "1"}], ",", ";;"}], "]"}], 
                    "]"}], "=", 
                    RowBox[{"{", 
                    RowBox[{"nextDirection", ",", 
                    RowBox[{"directions", "[", 
                    RowBox[{"[", "nextDirection", "]"}], "]"}], ",", 
                    RowBox[{"totalData", "[", 
                    RowBox[{"nextDirection", ",", "\"\<Pstart\>\""}], "]"}], 
                    ",", 
                    RowBox[{"totalData", "[", 
                    RowBox[{"nextDirection", ",", "\"\<Tstart\>\""}], "]"}], 
                    ",", 
                    RowBox[{"totalData", "[", 
                    RowBox[{"nextDirection", ",", "\"\<Q\>\""}], "]"}], ",", 
                    RowBox[{"totalData", "[", 
                    RowBox[{"nextDirection", ",", "\"\<Type\>\""}], "]"}], 
                    ",", 
                    RowBox[{"totalData", "[", 
                    RowBox[{"nextDirection", ",", "\"\<Pend\>\""}], "]"}], 
                    ",", 
                    RowBox[{"totalData", "[", 
                    RowBox[{"nextDirection", ",", "\"\<Tend\>\""}], "]"}], 
                    ",", 
                    RowBox[{"totalData", "[", 
                    RowBox[{"nextDirection", ",", "\"\<rhon\>\""}], "]"}], 
                    ",", 
                    RowBox[{"totalData", "[", 
                    RowBox[{"nextDirection", ",", "\"\<hs\>\""}], "]"}], ",", 
                    
                    RowBox[{"totalData", "[", 
                    RowBox[{"nextDirection", ",", "\"\<Rspecific\>\""}], 
                    "]"}], ",", "0", ",", "0", ",", 
                    RowBox[{"totalData", "[", 
                    RowBox[{"nextDirection", ",", "\"\<L\>\""}], "]"}], ",", 
                    "0", ",", "0", ",", 
                    RowBox[{"totalData", "[", 
                    RowBox[{"nextDirection", ",", "\"\<Mstart\>\""}], "]"}], 
                    ",", 
                    RowBox[{"totalData", "[", 
                    RowBox[{"nextDirection", ",", "\"\<Mend\>\""}], "]"}]}], 
                    "}"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"calculatedDirections", "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    "calculatedDirections", ",", "commonLastVertices"}], 
                    "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
               "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
            "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", "checkMode"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", "\"\<2 - S T E P: COMPLETE\>\"", "]"}], 
           ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"If", "[", 
         RowBox[{"tableInfo", ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "Print", "[", 
            "\"\<(*--------------------- 2 - S T E P \
-------------------------*)\>\"", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{
           "Print", "[", "\"\<Data after computations gas properties:\>\"", 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"CellPrint", "[", 
            RowBox[{"TextCell", "[", 
             RowBox[{"Grid", "[", 
              RowBox[{"dataInfo", ",", 
               RowBox[{"Alignment", "\[Rule]", "Left"}], ",", 
               RowBox[{"Spacings", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"2", ",", "1"}], "}"}]}], ",", 
               RowBox[{"Frame", "\[Rule]", "All"}], ",", 
               RowBox[{"ItemStyle", "\[Rule]", "\"\<Text\>\""}], ",", 
               RowBox[{"Background", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"LightCyan", ",", "None"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"LightGreen", ",", "None"}], "}"}]}], "}"}]}]}], 
              "]"}], "]"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", " ", "3"}]}]}]}]}]}]}]}]}]}]}], " ", "-", 
          " ", 
          RowBox[{"S", " ", "T", " ", "E", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"P", " ", "--"}], "--"}], "--"}]}], "-", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", "--"}]}]}]}]}]}]}]}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
           RowBox[{"++", 
            RowBox[{"++", 
             RowBox[{"++", 
              RowBox[{"+", " ", "Main"}]}]}]}], " ", "procedure", " ", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"forward", " ", "computations"}], ")"}], "++"}], 
             "++"}], "++"}]}], "+"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"calculatedDirections", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"num", "=", "0"}], ";", "\[IndentingNewLine]", 
        RowBox[{"lends", "=", 
         RowBox[{"Length", "[", "calculatedDirections", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{"True", ",", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"To", " ", "avoid", " ", "infinitely", " ", "loop"}], 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"num", ">", "0"}], "&&", 
              RowBox[{
               RowBox[{"Length", "[", "calculatedDirections", "]"}], 
               "\[Equal]", "lends"}]}], ",", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"Print", "[", 
                RowBox[{"\"\<Stopped in iteration No\>\"", ",", "num"}], 
                "]"}], ";"}], "*)"}], 
             RowBox[{"Break", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"num", "++"}], ";", "\[IndentingNewLine]", 
           RowBox[{"lends", "=", 
            RowBox[{"Length", "[", "calculatedDirections", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"calculatingDirections", "=", 
            RowBox[{"Select", "[", 
             RowBox[{"directionIndexes", ",", 
              RowBox[{
               RowBox[{"!", 
                RowBox[{"MemberQ", "[", 
                 RowBox[{"calculatedDirections", ",", "#"}], "]"}]}], "&"}]}],
              "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"numCalculatingDirections", "=", 
            RowBox[{"Length", "[", "calculatingDirections", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"l", "=", "1"}], ",", 
             RowBox[{"l", "\[LessEqual]", "numCalculatingDirections"}], ",", 
             RowBox[{"l", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"m", "=", 
               RowBox[{"calculatingDirections", "[", 
                RowBox[{"[", "l", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
              
              RowBox[{"(*", 
               RowBox[{"Working", " ", 
                RowBox[{"with", " ", "'"}], 
                RowBox[{"in", "'"}], " ", 
                RowBox[{"and", " ", "'"}], 
                RowBox[{"medium", "'"}], " ", "type", " ", "directions"}], 
               "*)"}], "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{"calculate", " ", "Pend", " ", "and", " ", "Tend"}], 
               "*)"}], "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"totalData", "[", 
                    RowBox[{"m", ",", "\"\<Pstart\>\""}], "]"}], "*", 
                   RowBox[{"totalData", "[", 
                    RowBox[{"m", ",", "\"\<Tstart\>\""}], "]"}], "*", 
                   RowBox[{"totalData", "[", 
                    RowBox[{"m", ",", "\"\<Q\>\""}], "]"}]}], ">", "0"}], "&&",
                  "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"totalData", "[", 
                   RowBox[{"m", ",", "\"\<Type\>\""}], "]"}], "!=", 
                  "\"\<station\>\""}], "&&", 
                 RowBox[{
                  RowBox[{"totalData", "[", 
                   RowBox[{"m", ",", "\"\<Pend\>\""}], "]"}], "\[Equal]", 
                  "0"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"calculatedDirections", "=", 
                  RowBox[{"Insert", "[", 
                   RowBox[{"calculatedDirections", ",", "m", ",", 
                    RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"(*", 
                  RowBox[{"Get", " ", "initial", " ", "data"}], "*)"}], 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"p", "[", "1", "]"}], "=", 
                  RowBox[{"kg2pa", "[", 
                   RowBox[{"totalData", "[", 
                    RowBox[{"m", ",", "\"\<Pstart\>\""}], "]"}], "]"}]}], ";",
                  "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"T", "[", "1", "]"}], "=", 
                  RowBox[{"273.15", "+", 
                   RowBox[{"totalData", "[", 
                    RowBox[{"m", ",", "\"\<Tstart\>\""}], "]"}]}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"p", "[", "2", "]"}], "=", 
                  RowBox[{"p", "[", "1", "]"}]}], ";", "\[IndentingNewLine]", 
                 
                 RowBox[{"Q", "=", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{"m", ",", "\"\<Q\>\""}], "]"}], "/", "3600"}], "//",
                    "N"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"(*", 
                  RowBox[{"Get", " ", "gas", " ", "properties"}], "*)"}], 
                 "\[IndentingNewLine]", 
                 RowBox[{"rhon", "=", 
                  RowBox[{"totalData", "[", 
                   RowBox[{"m", ",", "\"\<rhon\>\""}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Rspecific", "=", 
                  RowBox[{"totalData", "[", 
                   RowBox[{"m", ",", "\"\<Rspecific\>\""}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"hs", "=", 
                  RowBox[{"totalData", "[", 
                   RowBox[{"m", ",", "\"\<hs\>\""}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Mmolar", "=", 
                  RowBox[{"totalData", "[", 
                   RowBox[{"m", ",", "\"\<Mmolar\>\""}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"M", "=", 
                  RowBox[{"Q", "*", "rhon"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"p", "[", "2", "]"}], ",", 
                    RowBox[{"T", "[", "2", "]"}]}], "}"}], "=", 
                  RowBox[{"forwardProcedure", "[", 
                   RowBox[{"m", ",", 
                    RowBox[{"(*", 
                    RowBox[{"total", " ", "data"}], "*)"}], "directions", ",",
                     "distances", ",", "diameters", ",", "kLCoef", ",", 
                    "TSoilValues", ",", "hydraulicResistance", ",", "M", ",", 
                    
                    RowBox[{"(*", 
                    RowBox[{"gas", " ", "properties"}], "*)"}], "rhon", ",", 
                    "Rspecific", ",", 
                    RowBox[{"p", "[", "1", "]"}], ",", 
                    RowBox[{"T", "[", "1", "]"}], ",", "roughness"}], "]"}]}],
                  ";", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"totalData", "[", 
                   RowBox[{"m", ",", "\"\<Pend\>\""}], "]"}], "=", " ", 
                  RowBox[{"pa2kg", "[", 
                   RowBox[{"p", "[", "2", "]"}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"totalData", "[", 
                   RowBox[{"m", ",", "\"\<Tend\>\""}], "]"}], "=", 
                  RowBox[{
                   RowBox[{"T", "[", "2", "]"}], "-", "273.15"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"writeDataToDataInfo", "[", 
                  RowBox[{"m", ",", 
                   RowBox[{"{", 
                    RowBox[{"7", ",", "8"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{"m", ",", "\"\<Pend\>\""}], "]"}], ",", 
                    RowBox[{"totalData", "[", 
                    RowBox[{"m", ",", "\"\<Tend\>\""}], "]"}]}], "}"}]}], 
                  "]"}], ";", "\[IndentingNewLine]", 
                 RowBox[{"(*", 
                  RowBox[{
                  "Set", " ", "Pstart", " ", "and", " ", "Tstart", " ", "for",
                    " ", "next", " ", "directions"}], "*)"}], 
                 "\[IndentingNewLine]", 
                 RowBox[{"(*", 
                  RowBox[{
                  "Find", " ", "common", " ", "vertices", " ", "for", " ", 
                   "calculated", " ", "direcions"}], "*)"}], 
                 "\[IndentingNewLine]", 
                 RowBox[{"commonLastVertices", "=", 
                  RowBox[{"commonTotalLastVertices", "[", 
                   RowBox[{"[", "m", "]"}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"(*", 
                  RowBox[{
                  "Number", " ", "of", " ", "vertices", " ", "from", " ", 
                   "calculated", " ", "nodes", " ", "with", " ", "common", 
                   " ", "last", " ", "point"}], "*)"}], "\[IndentingNewLine]", 
                 RowBox[{"numCommonLastVertices", "=", 
                  RowBox[{"Length", "[", "commonLastVertices", "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"(*", 
                  RowBox[{
                  "Find", " ", "next", " ", "common", " ", "directions"}], 
                  "*)"}], "\[IndentingNewLine]", 
                 RowBox[{"commonStartPoint", "=", 
                  RowBox[{"commonTotalStartPoint", "[", 
                   RowBox[{"[", "m", "]"}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"numCommonStartPoint", "=", 
                  RowBox[{"Length", "[", "commonStartPoint", "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"countIn", "=", "0"}], ";", "\[IndentingNewLine]", 
                 RowBox[{"For", "[", 
                  RowBox[{
                   RowBox[{"k", "=", "1"}], ",", 
                   RowBox[{"k", "\[LessEqual]", "numCommonLastVertices"}], 
                   ",", 
                   RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{
                    RowBox[{"commonLastVertices", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], ",", "\"\<Tend\>\""}], 
                    "]"}], ">", "0"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"countIn", "++"}], ";"}]}], "\[IndentingNewLine]",
                     "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"countIn", "\[Equal]", "numCommonLastVertices"}], 
                   ",", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"dominant", "=", 
                    RowBox[{"totalData", "[", 
                    RowBox[{"m", ",", "\"\<Pend\>\""}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"k", "=", "1"}], ",", 
                    RowBox[{"k", "\[LessEqual]", "numCommonLastVertices"}], 
                    ",", 
                    RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{
                    RowBox[{"commonLastVertices", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], ",", "\"\<Pend\>\""}], 
                    "]"}], ">", "dominant"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"dominant", "=", 
                    RowBox[{"totalData", "[", 
                    RowBox[{
                    RowBox[{"commonLastVertices", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], ",", "\"\<Pend\>\""}], 
                    "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                    
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"t", "=", "1"}], ",", 
                    RowBox[{"t", "\[LessEqual]", "numCommonStartPoint"}], ",", 
                    RowBox[{"t", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"nextDirection", "=", 
                    RowBox[{"commonStartPoint", "[", 
                    RowBox[{"[", "t", "]"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"TResult", "=", "0"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"TResultSum", "=", "0"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"k", "=", "1"}], ",", 
                    RowBox[{"k", "<=", "numCommonLastVertices"}], ",", 
                    RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"gasFraction", "=", 
                    RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{
                    RowBox[{"commonLastVertices", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], ",", "\"\<Q\>\""}], "]"}],
                     "/", 
                    RowBox[{"Sum", "[", 
                    RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{"ll", ",", "\"\<Q\>\""}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"ll", ",", "commonLastVertices"}], "}"}]}], 
                    "]"}]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"cp", "=", 
                    RowBox[{"calculateCp", "[", 
                    RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{
                    RowBox[{"commonLastVertices", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], ",", "\"\<rhon\>\""}], 
                    "]"}], ",", 
                    RowBox[{
                    RowBox[{"kg2pa", "[", 
                    RowBox[{"totalData", "[", 
                    RowBox[{
                    RowBox[{"commonLastVertices", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], ",", "\"\<Pend\>\""}], 
                    "]"}], "]"}], "*", 
                    RowBox[{"10", "^", 
                    RowBox[{"(", 
                    RowBox[{"-", "6"}], ")"}]}]}], ",", 
                    RowBox[{"totalData", "[", 
                    RowBox[{
                    RowBox[{"commonLastVertices", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], ",", "\"\<Tend\>\""}], 
                    "]"}], ",", 
                    RowBox[{"totalData", "[", 
                    RowBox[{
                    RowBox[{"commonLastVertices", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], ",", 
                    "\"\<Rspecific\>\""}], "]"}]}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"TResult", "=", 
                    RowBox[{"TResult", "+", 
                    RowBox[{"gasFraction", "*", "cp", "*", 
                    RowBox[{"totalData", "[", 
                    RowBox[{
                    RowBox[{"commonLastVertices", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], ",", "\"\<Tend\>\""}], 
                    "]"}]}]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"TResultSum", "=", 
                    RowBox[{"TResultSum", "+", 
                    RowBox[{"gasFraction", "*", "cp"}]}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                    
                    RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{"nextDirection", ",", "\"\<Tstart\>\""}], "]"}], 
                    "=", 
                    RowBox[{"TResult", "/", "TResultSum"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"writeDataToDataInfo", "[", 
                    RowBox[{"nextDirection", ",", 
                    RowBox[{"{", "4", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"totalData", "[", 
                    RowBox[{"nextDirection", ",", "\"\<Tstart\>\""}], "]"}], 
                    "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{"nextDirection", ",", "\"\<Q\>\""}], "]"}], ">", 
                    "0"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{"nextDirection", ",", "\"\<Pstart\>\""}], "]"}], 
                    "=", "dominant"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"writeDataToDataInfo", "[", 
                    RowBox[{"nextDirection", ",", 
                    RowBox[{"{", "3", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"totalData", "[", 
                    RowBox[{"nextDirection", ",", "\"\<Pstart\>\""}], "]"}], 
                    "}"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
                    ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
                  "\[IndentingNewLine]", "]"}], ";"}]}], 
               "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
            "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", "checkMode"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", "\"\<3 - S T E P: COMPLETE\>\"", "]"}], 
           ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"If", "[", 
         RowBox[{"tableInfo", ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "Print", "[", 
            "\"\<!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\>\"", "]"}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{
           "Print", "[", 
            "\"\<(*--------------------- 3 - S T E P \
-------------------------*)\>\"", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Print", "[", "\"\<Data after calculations:\>\"", "]"}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"CellPrint", "[", 
            RowBox[{"TextCell", "[", 
             RowBox[{"Grid", "[", 
              RowBox[{"dataInfo", ",", 
               RowBox[{"Alignment", "\[Rule]", "Left"}], ",", 
               RowBox[{"Spacings", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"2", ",", "1"}], "}"}]}], ",", 
               RowBox[{"Frame", "\[Rule]", "All"}], ",", 
               RowBox[{"ItemStyle", "\[Rule]", "\"\<Text\>\""}], ",", 
               RowBox[{"Background", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"LightCyan", ",", "None"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"LightGreen", ",", "None"}], "}"}]}], "}"}]}]}], 
              "]"}], "]"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"times", "=", "1"}], ";", "\[IndentingNewLine]", 
        RowBox[{"calculatedDirectionsFourthStep", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"calculatedDirectionsFifthStep", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{"(*", 
          RowBox[{"To", " ", "avoid", " ", "infinitely", " ", "loop"}], 
          "*)"}], 
         RowBox[{
          RowBox[{"times", "<", "100"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"numCalculatedDirectionsFifthStep", "=", 
            RowBox[{"Length", "[", "calculatedDirectionsFifthStep", "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
              "numCalculatedDirectionsFifthStep", "==", 
               "numCalculatedDirectionsFifthStepPrev"}], "&&", 
              RowBox[{"times", ">", "1"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"!", "checkMode"}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Print", "[", 
                  RowBox[{"\"\<Stopped in iteration No\>\"", ",", "times"}], 
                  "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"Break", "[", "]"}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"!", "checkMode"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{"\"\<iteration No\>\"", ",", "times"}], "]"}], ";"}]}],
             "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"times", "++"}], ";", "\[IndentingNewLine]", 
           RowBox[{
           "numCalculatedDirectionsFifthStepPrev", "=", 
            "numCalculatedDirectionsFifthStep"}], ";", "\[IndentingNewLine]", 
           
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", " ", "4"}]}]}]}]}]}]}]}]}]}]}], " ", "-", 
             " ", 
             RowBox[{"S", " ", "T", " ", "E", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"P", " ", "--"}], "--"}], "--"}]}], "-", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", "--"}]}]}]}]}]}]}]}]}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{
              RowBox[{"++", 
               RowBox[{"++", 
                RowBox[{"++", 
                 RowBox[{"+", " ", "Main"}]}]}]}], " ", "procedure", " ", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"inverse", " ", "computations"}], ")"}], "++"}], 
                "++"}], "++"}]}], "+"}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"num", "=", "0"}], ";", "\[IndentingNewLine]", 
           RowBox[{"lends", "=", 
            RowBox[{"Length", "[", "calculatedDirectionsFourthStep", "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"While", "[", 
            RowBox[{"True", ",", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"To", " ", "avoid", " ", "infinitely", " ", "loop"}], 
              "*)"}], "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"num", ">", "0"}], "&&", 
                 RowBox[{
                  RowBox[{
                  "Length", "[", "calculatedDirectionsFourthStep", "]"}], 
                  "\[Equal]", "lends"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{"(*", 
                 RowBox[{
                  RowBox[{"Print", "[", 
                   RowBox[{"\"\<Stopped in iteration No\>\"", ",", "num"}], 
                   "]"}], ";"}], "*)"}], 
                RowBox[{"Break", "[", "]"}]}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"num", "++"}], ";", "\[IndentingNewLine]", 
              RowBox[{"lends", "=", 
               RowBox[{
               "Length", "[", "calculatedDirectionsFourthStep", "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"calculatingDirections", "=", 
               RowBox[{"Select", "[", 
                RowBox[{"directionIndexes", ",", 
                 RowBox[{
                  RowBox[{"!", 
                   RowBox[{"MemberQ", "[", 
                    RowBox[{"calculatedDirectionsFourthStep", ",", "#"}], 
                    "]"}]}], "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"numCalculatingDirections", "=", 
               RowBox[{"Length", "[", "calculatingDirections", "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"t", "=", "1"}], ",", 
                RowBox[{"t", "\[LessEqual]", "numCalculatingDirections"}], 
                ",", 
                RowBox[{"t", "++"}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"m", "=", 
                  RowBox[{"calculatingDirections", "[", 
                   RowBox[{"[", "t", "]"}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"(*", 
                  RowBox[{"Firstly", " ", "working", " ", 
                   RowBox[{"with", " ", "'"}], 
                   RowBox[{"out", "'"}], " ", "type", " ", "directions"}], 
                  "*)"}], "\[IndentingNewLine]", 
                 RowBox[{"(*", 
                  RowBox[{
                  "calculate", " ", "Pout", " ", "and", " ", "Tout", " ", 
                   "for", " ", "stations", " ", "or", " ", "Pend", " ", "for",
                    " ", "medium", " ", "directions"}], "*)"}], 
                 "\[IndentingNewLine]", 
                 RowBox[{"pIn", "=", 
                  RowBox[{"totalData", "[", 
                   RowBox[{"m", ",", "\"\<Pstart\>\""}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"TIn", "=", 
                  RowBox[{"totalData", "[", 
                   RowBox[{"m", ",", "\"\<Tstart\>\""}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"typePoint", "=", 
                  RowBox[{"totalData", "[", 
                   RowBox[{"m", ",", "\"\<Type\>\""}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{"m", ",", "\"\<Pend\>\""}], "]"}], "\[NotEqual]", 
                    "0"}], "&&", 
                    RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{"m", ",", "\"\<Tend\>\""}], "]"}], "\[Equal]", 
                    "0"}], "&&", 
                    RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{"m", ",", "\"\<Q\>\""}], "]"}], "\[NotEqual]", 
                    "0"}]}], ",", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"commonStartPoint", "=", 
                    RowBox[{"commonTotalStartPoint", "[", 
                    RowBox[{"[", "m", "]"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{"Print", "[", 
                    RowBox[{"\"\<direction=\>\"", ",", 
                    RowBox[{"directions", "[", 
                    RowBox[{"[", "m", "]"}], "]"}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    "Print", "[", "calculatedDirectionsFourthStep", "]"}], 
                    ";"}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{"Get", " ", "initial", " ", "data"}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"p", "[", "2", "]"}], "=", 
                    RowBox[{"kg2pa", "[", 
                    RowBox[{"totalData", "[", 
                    RowBox[{"m", ",", "\"\<Pend\>\""}], "]"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"p", "[", "1", "]"}], "=", 
                    RowBox[{"p", "[", "2", "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Q", "=", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{"m", ",", "\"\<Q\>\""}], "]"}], "/", "3600"}], "//",
                     "N"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{"Get", " ", "gas", " ", "properties"}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{"rhon", "=", 
                    RowBox[{"totalData", "[", 
                    RowBox[{"m", ",", "\"\<rhon\>\""}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Rspecific", "=", 
                    RowBox[{"totalData", "[", 
                    RowBox[{"m", ",", "\"\<Rspecific\>\""}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"hs", "=", 
                    RowBox[{"totalData", "[", 
                    RowBox[{"m", ",", "\"\<hs\>\""}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Mmolar", "=", 
                    RowBox[{"totalData", "[", 
                    RowBox[{"m", ",", "\"\<Mmolar\>\""}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"M", "=", 
                    RowBox[{"Q", "*", "rhon"}]}], ";", "\[IndentingNewLine]", 
                    
                    RowBox[{"TempKS", "=", 
                    RowBox[{"273.15", "+", "40"}]}], ";", 
                    RowBox[{"(*", 
                    RowBox[{
                    "compressor", " ", "station", " ", "go", " ", "out", " ", 
                    "temperature"}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"id", "=", "1"}], ",", 
                    RowBox[{"id", "\[LessEqual]", 
                    RowBox[{"Length", "[", "ksIds", "]"}]}], ",", 
                    RowBox[{"id", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"directions", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", "1"}], "]"}], "]"}], "\[Equal]", 
                    RowBox[{"ksIds", "[", 
                    RowBox[{"[", 
                    RowBox[{"id", ",", "1"}], "]"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"ksId", "=", 
                    RowBox[{"ksIds", "[", 
                    RowBox[{"[", 
                    RowBox[{"id", ",", "2"}], "]"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Break", "[", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                    
                    RowBox[{"commonStartPointInverse", "=", 
                    RowBox[{"commonTotalStartPointInverse", "[", 
                    RowBox[{"[", "m", "]"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"numCommonStartPointInverse", "=", 
                    RowBox[{"Length", "[", "commonStartPointInverse", "]"}]}],
                     ";", "\[IndentingNewLine]", 
                    RowBox[{"commonStartVertices", "=", 
                    RowBox[{"commonTotalStartVertices", "[", 
                    RowBox[{"[", "m", "]"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"numCommonStartVertices", "=", 
                    RowBox[{"Length", "[", "commonStartVertices", "]"}]}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"typePoint", "\[Equal]", "\"\<station\>\""}], ",",
                     "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{"Case", ":", " ", 
                    RowBox[{"direction", " ", "is", " ", "station"}]}], 
                    "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"pIn", "*", "TIn"}], ">", "0"}], "&&", 
                    RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{"m", ",", "\"\<Pout\>\""}], "]"}], "\[Equal]", 
                    "0"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"p", "[", "1", "]"}], ",", 
                    RowBox[{"T", "[", "1", "]"}], ",", 
                    RowBox[{"T", "[", "2", "]"}]}], "}"}], "=", 
                    RowBox[{"inverseProcedureLast", "[", 
                    RowBox[{"m", ",", 
                    RowBox[{"(*", 
                    RowBox[{"total", " ", "data"}], "*)"}], "directions", ",",
                     "distances", ",", "diameters", ",", "kLCoef", ",", 
                    "TSoilValues", ",", "hydraulicResistance", ",", "M", ",", 
                    
                    RowBox[{"(*", 
                    RowBox[{"gas", " ", "properties"}], "*)"}], "rhon", ",", 
                    "Mmolar", ",", "Rspecific", ",", 
                    RowBox[{"p", "[", "2", "]"}], ",", "TempKS", ",", 
                    "roughness"}], "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"p", "[", "1", "]"}], ",", 
                    RowBox[{"T", "[", "1", "]"}], ",", 
                    RowBox[{"T", "[", "2", "]"}]}], "}"}], "=", 
                    RowBox[{"inverseProcedure", "[", 
                    RowBox[{"m", ",", 
                    RowBox[{"(*", 
                    RowBox[{"total", " ", "data"}], "*)"}], "directions", ",",
                     "distances", ",", "diameters", ",", "kLCoef", ",", 
                    "TSoilValues", ",", "M", ",", 
                    RowBox[{"(*", 
                    RowBox[{"gas", " ", "properties"}], "*)"}], "rhon", ",", 
                    "Mmolar", ",", "Rspecific", ",", 
                    RowBox[{"p", "[", "2", "]"}], ",", "TempKS", ",", "CO2", 
                    ",", "hs", ",", "H2", ",", "ksId", ",", "pIn", ",", "TIn",
                     ",", "typePoint", ",", "atmP", ",", "atmT"}], "]"}]}], 
                    ";"}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{"m", ",", "\"\<Pout\>\""}], "]"}], "=", " ", 
                    RowBox[{"pa2kg", "[", 
                    RowBox[{"p", "[", "1", "]"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{"m", ",", "\"\<Tout\>\""}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"T", "[", "1", "]"}], "-", "273.15"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{"Print", "[", 
                    RowBox[{"\"\<direction-\>\"", ",", "m"}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Print", "[", 
                    RowBox[{"\"\<totalData[m,Pout]=\>\"", ",", 
                    RowBox[{"totalData", "[", 
                    RowBox[{"m", ",", "\"\<Pout\>\""}], "]"}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Print", "[", 
                    RowBox[{"\"\<totalData[m,Tout]=\>\"", ",", 
                    RowBox[{"totalData", "[", 
                    RowBox[{"m", ",", "\"\<Tout\>\""}], "]"}]}], "]"}], ";"}],
                     "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"writeDataToDataInfo", "[", 
                    RowBox[{"m", ",", 
                    RowBox[{"{", 
                    RowBox[{"12", ",", "13"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{"m", ",", "\"\<Pout\>\""}], "]"}], ",", 
                    RowBox[{"totalData", "[", 
                    RowBox[{"m", ",", "\"\<Tout\>\""}], "]"}]}], "}"}]}], 
                    "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{"Case", ":", " ", 
                    RowBox[{
                    "direction", " ", "is", " ", "not", " ", "station"}]}], 
                    "*)"}], " ", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"p", "[", "1", "]"}], ",", 
                    RowBox[{"T", "[", "1", "]"}], ",", 
                    RowBox[{"T", "[", "2", "]"}]}], "}"}], "=", 
                    RowBox[{"inverseProcedureLast", "[", 
                    RowBox[{"m", ",", 
                    RowBox[{"(*", 
                    RowBox[{"total", " ", "data"}], "*)"}], "directions", ",",
                     "distances", ",", "diameters", ",", "kLCoef", ",", 
                    "TSoilValues", ",", "M", ",", 
                    RowBox[{"(*", 
                    RowBox[{"gas", " ", "properties"}], "*)"}], "rhon", ",", 
                    "Mmolar", ",", "Rspecific", ",", 
                    RowBox[{"p", "[", "2", "]"}], ",", "TempKS", ",", "CO2", 
                    ",", "hs", ",", "H2"}], "]"}]}], ";"}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"p", "[", "1", "]"}], ",", 
                    RowBox[{"T", "[", "1", "]"}], ",", 
                    RowBox[{"T", "[", "2", "]"}]}], "}"}], "=", 
                    RowBox[{"inverseProcedure", "[", 
                    RowBox[{"m", ",", 
                    RowBox[{"(*", 
                    RowBox[{"total", " ", "data"}], "*)"}], "directions", ",",
                     "distances", ",", "diameters", ",", "kLCoef", ",", 
                    "TSoilValues", ",", "hydraulicResistance", ",", "M", ",", 
                    
                    RowBox[{"(*", 
                    RowBox[{"gas", " ", "properties"}], "*)"}], "rhon", ",", 
                    "Mmolar", ",", "Rspecific", ",", 
                    RowBox[{"p", "[", "2", "]"}], ",", "TempKS", ",", "ksId", 
                    ",", "pIn", ",", "TIn", ",", "typePoint", ",", "atmP", 
                    ",", "atmT", ",", "roughness"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{"m", ",", "\"\<Pstart\>\""}], "]"}], "\[Equal]", 
                    "0"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{"m", ",", "\"\<Pstart\>\""}], "]"}], "=", " ", 
                    RowBox[{"pa2kg", "[", 
                    RowBox[{"p", "[", "1", "]"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"countIn", "=", "0"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"k", "=", "1"}], ",", 
                    RowBox[{"k", "\[LessEqual]", "numCommonStartVertices"}], 
                    ",", 
                    RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"ll", "=", 
                    RowBox[{"commonStartVertices", "[", 
                    RowBox[{"[", "k", "]"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{"ll", ",", "\"\<Pstart\>\""}], "]"}], ">", "0"}], 
                    "||", 
                    RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{"ll", ",", "\"\<Q\>\""}], "]"}], "==", "0"}]}], 
                    RowBox[{"(*", 
                    RowBox[{"||", 
                    RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{"ll", ",", "\"\<Type\>\""}], "]"}], "==", 
                    "\"\<out\>\""}]}], "*)"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"countIn", "++"}]}], "\[IndentingNewLine]", "]"}],
                     ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"countIn", "==", "numCommonStartVertices"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"dominant", "=", 
                    RowBox[{"totalData", "[", 
                    RowBox[{"m", ",", "\"\<Pstart\>\""}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"k", "=", "1"}], ",", 
                    RowBox[{"k", "\[LessEqual]", "numCommonStartVertices"}], 
                    ",", 
                    RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"ll", "=", 
                    RowBox[{"commonStartVertices", "[", 
                    RowBox[{"[", "k", "]"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{"ll", ",", "\"\<Pstart\>\""}], "]"}], ">", 
                    "dominant"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"dominant", "=", 
                    RowBox[{"totalData", "[", 
                    RowBox[{"ll", ",", "\"\<Pstart\>\""}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                    
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"k", "=", "1"}], ",", 
                    RowBox[{
                    "k", "\[LessEqual]", "numCommonStartPointInverse"}], ",", 
                    
                    RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"ll", "=", 
                    RowBox[{"commonStartPointInverse", "[", 
                    RowBox[{"[", "k", "]"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{"ll", ",", "\"\<Pend\>\""}], "]"}], "=", 
                    "dominant"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"writeDataToDataInfo", "[", 
                    RowBox[{"ll", ",", 
                    RowBox[{"{", "7", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"totalData", "[", 
                    RowBox[{"ll", ",", "\"\<Pend\>\""}], "]"}], "}"}]}], 
                    "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                    
                    RowBox[{"writeDataToDataInfo", "[", 
                    RowBox[{"m", ",", 
                    RowBox[{"{", "3", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"totalData", "[", 
                    RowBox[{"m", ",", "\"\<Pstart\>\""}], "]"}], "}"}]}], 
                    "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"calculatedDirectionsFourthStep", "=", 
                    RowBox[{"Insert", "[", 
                    RowBox[{"calculatedDirectionsFourthStep", ",", "m", ",", 
                    RowBox[{"-", "1"}]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                  "\[IndentingNewLine]", "]"}], ";"}]}], 
               "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{"\"\<iteration-,\>\"", "num"}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"Print", "[", 
               RowBox[{
               "\"\<calculatedDirectionsFourthStep\>\"", ",", 
                "calculatedDirectionsFourthStep"}], "]"}], ";"}], "*)"}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"!", "checkMode"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Print", "[", "\"\<4 - S T E P: COMPLETE\>\"", "]"}], 
              ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{"tableInfo", ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
              "Print", "[", 
               "\"\<!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\>\"", "]"}], 
              ";", "\[IndentingNewLine]", 
              RowBox[{
              "Print", "[", 
               "\"\<(*--------------------- 4 - S T E P \
-------------------------*)\>\"", "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{
              "Print", "[", "\"\<Data after inverse computations:\>\"", "]"}],
               ";", "\[IndentingNewLine]", 
              RowBox[{"CellPrint", "[", 
               RowBox[{"TextCell", "[", 
                RowBox[{"Grid", "[", 
                 RowBox[{"dataInfo", ",", 
                  RowBox[{"Alignment", "\[Rule]", "Left"}], ",", 
                  RowBox[{"Spacings", "\[Rule]", 
                   RowBox[{"{", 
                    RowBox[{"2", ",", "1"}], "}"}]}], ",", 
                  RowBox[{"Frame", "\[Rule]", "All"}], ",", 
                  RowBox[{"ItemStyle", "\[Rule]", "\"\<Text\>\""}], ",", 
                  RowBox[{"Background", "\[Rule]", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"LightCyan", ",", "None"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"LightGreen", ",", "None"}], "}"}]}], "}"}]}]}], 
                 "]"}], "]"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", " ", "5"}]}]}]}]}]}]}]}]}]}]}], " ", "-", 
             " ", 
             RowBox[{"S", " ", "T", " ", "E", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"P", " ", "--"}], "--"}], "--"}]}], "-", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", "--"}]}]}]}]}]}]}]}]}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{
              RowBox[{"++", 
               RowBox[{"++", 
                RowBox[{"++", 
                 RowBox[{"+", " ", "Main"}]}]}]}], " ", "procedure", " ", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                  "forward", " ", "computations", " ", "for", " ", 
                   "stations"}], ")"}], "++"}], "++"}], "++"}]}], "+"}], 
            "*)"}], "\[IndentingNewLine]", 
           RowBox[{"num", "=", "0"}], ";", "\[IndentingNewLine]", 
           RowBox[{"lends", "=", 
            RowBox[{"Length", "[", "calculatedDirectionsFifthStep", "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"While", "[", 
            RowBox[{"True", ",", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"To", " ", "avoid", " ", "infinitely", " ", "loop"}], 
              "*)"}], "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"num", ">", "0"}], "&&", 
                 RowBox[{
                 "numCalculatedDirectionsFifthStep", "\[Equal]", "lends"}]}], 
                ",", 
                RowBox[{"(*", 
                 RowBox[{
                  RowBox[{"Print", "[", 
                   RowBox[{"\"\<Stopped in iteration No\>\"", ",", "num"}], 
                   "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
                RowBox[{"Break", "[", "]"}]}], "\[IndentingNewLine]", "]"}], 
              ";", "\[IndentingNewLine]", 
              RowBox[{"num", "++"}], ";", "\[IndentingNewLine]", 
              RowBox[{"lends", "=", 
               RowBox[{
               "Length", "[", "calculatedDirectionsFifthStep", "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"count", "=", "0"}], ";", "\[IndentingNewLine]", 
              RowBox[{"calculatingDirections", "=", 
               RowBox[{"Select", "[", 
                RowBox[{"directionIndexes", ",", 
                 RowBox[{
                  RowBox[{"!", 
                   RowBox[{"MemberQ", "[", 
                    RowBox[{"calculatedDirectionsFifthStep", ",", "#"}], 
                    "]"}]}], "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"numCalculatingDirections", "=", 
               RowBox[{"Length", "[", "calculatingDirections", "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"t", "=", "1"}], ",", 
                RowBox[{"t", "\[LessEqual]", "numCalculatingDirections"}], 
                ",", 
                RowBox[{"t", "++"}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"m", "=", 
                  RowBox[{"calculatingDirections", "[", 
                   RowBox[{"[", "t", "]"}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"(*", 
                  RowBox[{"Working", " ", 
                   RowBox[{"with", " ", "'"}], 
                   RowBox[{"station", "'"}], " ", "type", " ", "directions"}],
                   "*)"}], "\[IndentingNewLine]", 
                 RowBox[{"(*", 
                  RowBox[{"calculate", " ", "Pend", " ", "and", " ", "Tend"}],
                   "*)"}], "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{"m", ",", "\"\<Pout\>\""}], "]"}], ">", "0"}], "&&", 
                    RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{"m", ",", "\"\<Tout\>\""}], "]"}], ">", "0"}], "&&", 
                    RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{"m", ",", "\"\<Q\>\""}], "]"}], ">", "0"}]}], "||", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{"m", ",", "\"\<Pstart\>\""}], "]"}], 
                    "\[NotEqual]", "0"}], "&&", 
                    RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{"m", ",", "\"\<Tend\>\""}], "]"}], "\[Equal]", 
                    "0"}], "&&", 
                    RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{"m", ",", "\"\<Q\>\""}], "]"}], "\[NotEqual]", 
                    "0"}], "&&", 
                    RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{"m", ",", "\"\<Type\>\""}], "]"}], "\[NotEqual]", 
                    "\"\<station\>\""}]}]}], ",", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"count", "++"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{"Get", " ", "initial", " ", "data"}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{"Q", "=", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{"m", ",", "\"\<Q\>\""}], "]"}], "/", "3600"}], "//",
                     "N"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{"Get", " ", "gas", " ", "properties"}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{"rhon", "=", 
                    RowBox[{"totalData", "[", 
                    RowBox[{"m", ",", "\"\<rhon\>\""}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Rspecific", "=", 
                    RowBox[{"totalData", "[", 
                    RowBox[{"m", ",", "\"\<Rspecific\>\""}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"hs", "=", 
                    RowBox[{"totalData", "[", 
                    RowBox[{"m", ",", "\"\<hs\>\""}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Mmolar", "=", 
                    RowBox[{"totalData", "[", 
                    RowBox[{"m", ",", "\"\<Mmolar\>\""}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"M", "=", 
                    RowBox[{"Q", "*", "rhon"}]}], ";", "\[IndentingNewLine]", 
                    
                    RowBox[{"pIn", "=", 
                    RowBox[{"totalData", "[", 
                    RowBox[{"m", ",", "\"\<Pstart\>\""}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"TIn", "=", 
                    RowBox[{"totalData", "[", 
                    RowBox[{"m", ",", "\"\<Tstart\>\""}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"typePoint", "=", 
                    RowBox[{"totalData", "[", 
                    RowBox[{"m", ",", "\"\<Type\>\""}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{"m", ",", "\"\<Pout\>\""}], "]"}], ">", "0"}], "&&", 
                    RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{"m", ",", "\"\<Pout\>\""}], "]"}], "<", 
                    RowBox[{"totalData", "[", 
                    RowBox[{"m", ",", "\"\<Pend\>\""}], "]"}]}], "&&", 
                    RowBox[{
                    RowBox[{"pIn", "*", "TIn"}], ">", "0"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"p", "[", "1", "]"}], ",", 
                    RowBox[{"T", "[", "1", "]"}], ",", 
                    RowBox[{"T", "[", "2", "]"}]}], "}"}], "=", 
                    RowBox[{"inverseProcedureLast", "[", 
                    RowBox[{"m", ",", 
                    RowBox[{"(*", 
                    RowBox[{"total", " ", "data"}], "*)"}], "directions", ",",
                     "distances", ",", "diameters", ",", "kLCoef", ",", 
                    "TSoilValues", ",", "hydraulicResistance", ",", "M", ",", 
                    
                    RowBox[{"(*", 
                    RowBox[{"gas", " ", "properties"}], "*)"}], "rhon", ",", 
                    "Mmolar", ",", "Rspecific", ",", 
                    RowBox[{"kg2pa", "[", 
                    RowBox[{"totalData", "[", 
                    RowBox[{"m", ",", "\"\<Pend\>\""}], "]"}], "]"}], ",", 
                    "TempKS", ",", "roughness"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{"m", ",", "\"\<Pout\>\""}], "]"}], "=", 
                    RowBox[{"pa2kg", "[", 
                    RowBox[{"p", "[", "1", "]"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{"m", ",", "\"\<Tout\>\""}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"T", "[", "1", "]"}], "-", "273.15"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"writeDataToDataInfo", "[", 
                    RowBox[{"m", ",", 
                    RowBox[{"{", 
                    RowBox[{"12", ",", "13"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{"m", ",", "\"\<Pout\>\""}], "]"}], ",", 
                    RowBox[{"totalData", "[", 
                    RowBox[{"m", ",", "\"\<Tout\>\""}], "]"}]}], "}"}]}], 
                    "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"calculatedDirectionsFifthStep", "=", 
                    RowBox[{"Insert", "[", 
                    RowBox[{"calculatedDirectionsFifthStep", ",", "m", ",", 
                    RowBox[{"-", "1"}]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                    
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{"m", ",", "\"\<Type\>\""}], "]"}], "\[Equal]", 
                    "\"\<station\>\""}], "&&", 
                    RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{"m", ",", "\"\<Pout\>\""}], "]"}], "==", "0"}], "&&", 
                    RowBox[{
                    RowBox[{"pIn", "*", "TIn"}], ">", "0"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"p", "[", "1", "]"}], ",", 
                    RowBox[{"T", "[", "1", "]"}], ",", 
                    RowBox[{"T", "[", "2", "]"}]}], "}"}], "=", 
                    RowBox[{"inverseProcedureLast", "[", 
                    RowBox[{"m", ",", 
                    RowBox[{"(*", 
                    RowBox[{"total", " ", "data"}], "*)"}], "directions", ",",
                     "distances", ",", "diameters", ",", "kLCoef", ",", 
                    "TSoilValues", ",", "hydraulicResistance", ",", "M", ",", 
                    
                    RowBox[{"(*", 
                    RowBox[{"gas", " ", "properties"}], "*)"}], "rhon", ",", 
                    "Mmolar", ",", "Rspecific", ",", 
                    RowBox[{"kg2pa", "[", 
                    RowBox[{"totalData", "[", 
                    RowBox[{"m", ",", "\"\<Pend\>\""}], "]"}], "]"}], ",", 
                    "TempKS", ",", "roughness"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{"m", ",", "\"\<Pout\>\""}], "]"}], "=", 
                    RowBox[{"pa2kg", "[", 
                    RowBox[{"p", "[", "1", "]"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{"m", ",", "\"\<Tout\>\""}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"T", "[", "1", "]"}], "-", "273.15"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"writeDataToDataInfo", "[", 
                    RowBox[{"m", ",", 
                    RowBox[{"{", 
                    RowBox[{"12", ",", "13"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{"m", ",", "\"\<Pout\>\""}], "]"}], ",", 
                    RowBox[{"totalData", "[", 
                    RowBox[{"m", ",", "\"\<Tout\>\""}], "]"}]}], "}"}]}], 
                    "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"calculatedDirectionsFifthStep", "=", 
                    RowBox[{"Insert", "[", 
                    RowBox[{"calculatedDirectionsFifthStep", ",", "m", ",", 
                    RowBox[{"-", "1"}]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                    
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{"m", ",", "\"\<Pout\>\""}], "]"}], "*", 
                    RowBox[{"totalData", "[", 
                    RowBox[{"m", ",", "\"\<Tout\>\""}], "]"}]}], ">", "0"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"p", "[", "1", "]"}], "=", 
                    RowBox[{"kg2pa", "[", 
                    RowBox[{"totalData", "[", 
                    RowBox[{"m", ",", "\"\<Pout\>\""}], "]"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"T", "[", "1", "]"}], "=", 
                    RowBox[{"273.15", "+", 
                    RowBox[{"totalData", "[", 
                    RowBox[{"m", ",", "\"\<Tout\>\""}], "]"}]}]}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"p", "[", "1", "]"}], "=", 
                    RowBox[{"kg2pa", "[", 
                    RowBox[{"totalData", "[", 
                    RowBox[{"m", ",", "\"\<Pstart\>\""}], "]"}], "]"}]}], ";",
                     "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"T", "[", "1", "]"}], "=", 
                    RowBox[{"273.15", "+", 
                    RowBox[{"totalData", "[", 
                    RowBox[{"m", ",", "\"\<Tstart\>\""}], "]"}]}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"p", "[", "2", "]"}], "=", 
                    RowBox[{"p", "[", "1", "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                    
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{"m", ",", "\"\<Tend\>\""}], "]"}], "\[Equal]", 
                    "0"}], "&&", 
                    RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{"m", ",", "\"\<Tstart\>\""}], "]"}], ">", "0"}]}],
                     ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"lenm", "=", 
                    RowBox[{"Length", "[", 
                    RowBox[{"directions", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"p", "[", "2", "]"}], ",", 
                    RowBox[{"T", "[", "2", "]"}]}], "}"}], "=", 
                    RowBox[{"forwardProcedure", "[", 
                    RowBox[{"m", ",", 
                    RowBox[{"(*", 
                    RowBox[{"total", " ", "data"}], "*)"}], "directions", ",",
                     "distances", ",", "diameters", ",", "kLCoef", ",", 
                    "TSoilValues", ",", "hydraulicResistance", ",", "M", ",", 
                    
                    RowBox[{"(*", 
                    RowBox[{"gas", " ", "properties"}], "*)"}], "rhon", ",", 
                    "Rspecific", ",", 
                    RowBox[{"p", "[", "1", "]"}], ",", 
                    RowBox[{"T", "[", "1", "]"}], ",", "roughness"}], "]"}]}],
                     ";", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{"m", ",", "\"\<Pend\>\""}], "]"}], "=", " ", 
                    RowBox[{"pa2kg", "[", 
                    RowBox[{"p", "[", "2", "]"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{"m", ",", "\"\<Tend\>\""}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"T", "[", "2", "]"}], "-", "273.15"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{"Print", "[", 
                    RowBox[{"\"\<direction-\>\"", ",", "m"}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Print", "[", 
                    RowBox[{"\"\<totalData[m,Pend]\>\"", ",", 
                    RowBox[{"totalData", "[", 
                    RowBox[{"m", ",", "\"\<Pend\>\""}], "]"}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Print", "[", 
                    RowBox[{"\"\<totalData[m,Tend]\>\"", ",", 
                    RowBox[{"totalData", "[", 
                    RowBox[{"m", ",", "\"\<Tend\>\""}], "]"}]}], "]"}], ";"}],
                     "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"writeDataToDataInfo", "[", 
                    RowBox[{"m", ",", 
                    RowBox[{"{", 
                    RowBox[{"7", ",", "8"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{"m", ",", "\"\<Pend\>\""}], "]"}], ",", 
                    RowBox[{"totalData", "[", 
                    RowBox[{"m", ",", "\"\<Tend\>\""}], "]"}]}], "}"}]}], 
                    "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"calculatedDirectionsFifthStep", "=", 
                    RowBox[{"Insert", "[", 
                    RowBox[{"calculatedDirectionsFifthStep", ",", "m", ",", 
                    RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    "Set", " ", "Tstart", " ", "for", " ", "next", " ", 
                    "directions"}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"commonStartPoint", "=", 
                    RowBox[{"commonTotalStartPoint", "[", 
                    RowBox[{"[", "m", "]"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"numCommonStartPoint", "=", 
                    RowBox[{"Length", "[", "commonStartPoint", "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    "Find", " ", "common", " ", "vertices", " ", "for", " ", 
                    "calculated", " ", "direcions"}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{"commonLastVertices", "=", 
                    RowBox[{"commonTotalLastVertices", "[", 
                    RowBox[{"[", "m", "]"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    "Number", " ", "of", " ", "vertices", " ", "from", " ", 
                    "calculated", " ", "nodes", " ", "with", " ", "common", 
                    " ", "last", " ", "point"}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{"numCommonLastVertices", "=", 
                    RowBox[{"Length", "[", "commonLastVertices", "]"}]}], ";",
                     "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"s", "=", "1"}], ",", 
                    RowBox[{"s", "<=", "numCommonStartPoint"}], ",", 
                    RowBox[{"s", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"nextDirection", "=", 
                    RowBox[{"commonStartPoint", "[", 
                    RowBox[{"[", "s", "]"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{"nextDirection", ",", "\"\<Pstart\>\""}], "]"}], 
                    "=", 
                    RowBox[{"totalData", "[", 
                    RowBox[{"m", ",", "\"\<Pend\>\""}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"writeDataToDataInfo", "[", 
                    RowBox[{"nextDirection", ",", 
                    RowBox[{"{", "3", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"totalData", "[", 
                    RowBox[{"nextDirection", ",", "\"\<Pstart\>\""}], "]"}], 
                    "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"countIn", "=", "0"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    "check", " ", "availability", " ", "all", " ", 
                    "commonLastVertices", " ", "temperatures", " ", "Tends"}],
                     "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"k", "=", "1"}], ",", 
                    RowBox[{"k", "\[LessEqual]", "numCommonLastVertices"}], 
                    ",", 
                    RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{
                    RowBox[{"commonLastVertices", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], ",", "\"\<Tend\>\""}], 
                    "]"}], ">", "0"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"countIn", "++"}], ";"}]}], "\[IndentingNewLine]",
                     "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"countIn", "\[Equal]", "numCommonLastVertices"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"TResult", "=", "0"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"TResultSum", "=", "0"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"k", "=", "1"}], ",", 
                    RowBox[{"k", "<=", "numCommonLastVertices"}], ",", 
                    RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"gasFraction", "=", 
                    RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{
                    RowBox[{"commonLastVertices", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], ",", "\"\<Q\>\""}], "]"}],
                     "/", 
                    RowBox[{"Sum", "[", 
                    RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{"ll", ",", "\"\<Q\>\""}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"ll", ",", "commonLastVertices"}], "}"}]}], 
                    "]"}]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"cp", "=", 
                    RowBox[{"calculateCp", "[", 
                    RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{
                    RowBox[{"commonLastVertices", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], ",", "\"\<rhon\>\""}], 
                    "]"}], ",", 
                    RowBox[{
                    RowBox[{"kg2pa", "[", 
                    RowBox[{"totalData", "[", 
                    RowBox[{
                    RowBox[{"commonLastVertices", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], ",", "\"\<Pend\>\""}], 
                    "]"}], "]"}], "*", 
                    RowBox[{"10", "^", 
                    RowBox[{"(", 
                    RowBox[{"-", "6"}], ")"}]}]}], ",", 
                    RowBox[{"totalData", "[", 
                    RowBox[{
                    RowBox[{"commonLastVertices", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], ",", "\"\<Tend\>\""}], 
                    "]"}], ",", 
                    RowBox[{"totalData", "[", 
                    RowBox[{
                    RowBox[{"commonLastVertices", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], ",", 
                    "\"\<Rspecific\>\""}], "]"}]}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"TResult", "=", 
                    RowBox[{"TResult", "+", 
                    RowBox[{"gasFraction", "*", "cp", "*", 
                    RowBox[{"totalData", "[", 
                    RowBox[{
                    RowBox[{"commonLastVertices", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], ",", "\"\<Tend\>\""}], 
                    "]"}]}]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"TResultSum", "=", 
                    RowBox[{"TResultSum", "+", 
                    RowBox[{"gasFraction", "*", "cp"}]}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                    
                    RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{"nextDirection", ",", "\"\<Tstart\>\""}], "]"}], 
                    "=", 
                    RowBox[{"TResult", "/", "TResultSum"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"writeDataToDataInfo", "[", 
                    RowBox[{"nextDirection", ",", 
                    RowBox[{"{", "4", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"totalData", "[", 
                    RowBox[{"nextDirection", ",", "\"\<Tstart\>\""}], "]"}], 
                    "}"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{"Print", "[", 
                    RowBox[{"\"\<direction main m-\>\"", ",", "m"}], "]"}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{"Print", "[", 
                    RowBox[{"\"\<direction next-\>\"", ",", "nextDirection"}],
                     "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"Print", "[", 
                    RowBox[{"\"\<totalData[nextDirection,Tstart]\>\"", ",", 
                    RowBox[{"totalData", "[", 
                    RowBox[{"nextDirection", ",", "\"\<Tstart\>\""}], "]"}]}],
                     "]"}], ";"}], "*)"}], "\[IndentingNewLine]", "]"}], 
                    ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                  "\[IndentingNewLine]", "]"}], ";"}]}], 
               "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{"\"\<iteration-,\>\"", "num"}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"Print", "[", 
               RowBox[{
               "\"\<calculatedDirectionsFifthStep\>\"", ",", 
                "calculatedDirectionsFifthStep"}], "]"}], ";"}], "*)"}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"!", "checkMode"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Print", "[", "\"\<5 - S T E P: COMPLETE\>\"", "]"}], 
              ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{"tableInfo", ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
              "Print", "[", 
               "\"\<!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\>\"", "]"}], 
              ";", "\[IndentingNewLine]", 
              RowBox[{
              "Print", "[", 
               "\"\<(*--------------------- 5 - S T E P \
-------------------------*)\>\"", "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"Print", "[", "\"\<Data after calculations:\>\"", "]"}],
               ";", "\[IndentingNewLine]", 
              RowBox[{"CellPrint", "[", 
               RowBox[{"TextCell", "[", 
                RowBox[{"Grid", "[", 
                 RowBox[{"dataInfo", ",", 
                  RowBox[{"Alignment", "\[Rule]", "Left"}], ",", 
                  RowBox[{"Spacings", "\[Rule]", 
                   RowBox[{"{", 
                    RowBox[{"2", ",", "1"}], "}"}]}], ",", 
                  RowBox[{"Frame", "\[Rule]", "All"}], ",", 
                  RowBox[{"ItemStyle", "\[Rule]", "\"\<Text\>\""}], ",", 
                  RowBox[{"Background", "\[Rule]", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"LightCyan", ",", "None"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"LightGreen", ",", "None"}], "}"}]}], "}"}]}]}], 
                 "]"}], "]"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
           ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"m", "=", "1"}], ",", 
          RowBox[{"m", "\[LessEqual]", "numDirections"}], ",", 
          RowBox[{"m", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"rhon", "=", 
            RowBox[{"totalData", "[", 
             RowBox[{"m", ",", "\"\<rhon\>\""}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Rspecific", "=", 
            RowBox[{"totalData", "[", 
             RowBox[{"m", ",", "\"\<Rspecific\>\""}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"totalData", "[", 
               RowBox[{"m", ",", "\"\<Type\>\""}], "]"}], "!=", 
              "\"\<in\>\""}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"p", "[", "1", "]"}], "=", 
               RowBox[{"kg2pa", "[", 
                RowBox[{"totalData", "[", 
                 RowBox[{"m", ",", "\"\<Pstart\>\""}], "]"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"T", "[", "1", "]"}], "=", 
               RowBox[{
                RowBox[{"totalData", "[", 
                 RowBox[{"m", ",", "\"\<Tstart\>\""}], "]"}], "+", 
                "273.15"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"Z", "=", 
               RowBox[{"calculateZ", "[", 
                RowBox[{"rhon", ",", 
                 RowBox[{
                  RowBox[{"p", "[", "1", "]"}], "*", 
                  RowBox[{"10", "^", 
                   RowBox[{"(", 
                    RowBox[{"-", "6"}], ")"}]}]}], ",", 
                 RowBox[{"T", "[", "1", "]"}], ",", "Rspecific"}], "]"}]}], 
              ";", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"totalData", "[", 
                RowBox[{"m", ",", "\"\<rhostart\>\""}], "]"}], "=", 
               RowBox[{
                RowBox[{"p", "[", "1", "]"}], "/", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"T", "[", "1", "]"}], "*", "Rspecific", "*", "Z"}], 
                 ")"}]}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"writeDataToDataInfo", "[", 
               RowBox[{"m", ",", 
                RowBox[{"{", "15", "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"totalData", "[", 
                  RowBox[{"m", ",", "\"\<rhostart\>\""}], "]"}], "}"}]}], 
               "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"p", "[", "2", "]"}], "=", 
            RowBox[{"kg2pa", "[", 
             RowBox[{"totalData", "[", 
              RowBox[{"m", ",", "\"\<Pend\>\""}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"T", "[", "2", "]"}], "=", 
            RowBox[{
             RowBox[{"totalData", "[", 
              RowBox[{"m", ",", "\"\<Tend\>\""}], "]"}], "+", "273.15"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"Z", "=", 
            RowBox[{"calculateZ", "[", 
             RowBox[{"rhon", ",", 
              RowBox[{
               RowBox[{"p", "[", "2", "]"}], "*", 
               RowBox[{"10", "^", 
                RowBox[{"(", 
                 RowBox[{"-", "6"}], ")"}]}]}], ",", 
              RowBox[{"T", "[", "2", "]"}], ",", "Rspecific"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"totalData", "[", 
             RowBox[{"m", ",", "\"\<rhoend\>\""}], "]"}], "=", 
            RowBox[{
             RowBox[{"p", "[", "2", "]"}], "/", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"T", "[", "2", "]"}], "*", "Rspecific", "*", "Z"}], 
              ")"}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"totalData", "[", 
             RowBox[{"m", ",", "\"\<Mstart\>\""}], "]"}], "=", 
            RowBox[{
             RowBox[{
              RowBox[{"totalData", "[", 
               RowBox[{"m", ",", "\"\<Q\>\""}], "]"}], "*", 
              RowBox[{"rhon", "/", "3600"}]}], "//", "N"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"totalData", "[", 
             RowBox[{"m", ",", "\"\<Mend\>\""}], "]"}], "=", 
            RowBox[{"totalData", "[", 
             RowBox[{"m", ",", "\"\<Mstart\>\""}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"writeDataToDataInfo", "[", 
            RowBox[{"m", ",", 
             RowBox[{"{", 
              RowBox[{"16", ",", "17", ",", "18"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"totalData", "[", 
                RowBox[{"m", ",", "\"\<rhoend\>\""}], "]"}], ",", 
               RowBox[{"totalData", "[", 
                RowBox[{"m", ",", "\"\<Mstart\>\""}], "]"}], ",", 
               RowBox[{"totalData", "[", 
                RowBox[{"m", ",", "\"\<Mend\>\""}], "]"}]}], "}"}]}], "]"}], 
           ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"If", "[", 
         RowBox[{"tableInfo", ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "Print", "[", 
            "\"\<!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\>\"", "]"}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"Print", "[", "\"\<Data after calculations:\>\"", "]"}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"CellPrint", "[", 
            RowBox[{"TextCell", "[", 
             RowBox[{"Grid", "[", 
              RowBox[{"dataInfo", ",", 
               RowBox[{"Alignment", "\[Rule]", "Left"}], ",", 
               RowBox[{"Spacings", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"2", ",", "1"}], "}"}]}], ",", 
               RowBox[{"Frame", "\[Rule]", "All"}], ",", 
               RowBox[{"ItemStyle", "\[Rule]", "\"\<Text\>\""}], ",", 
               RowBox[{"Background", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"LightCyan", ",", "None"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"LightGreen", ",", "None"}], "}"}]}], "}"}]}]}], 
              "]"}], "]"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
        ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", 
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**"}], "******)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"inverseProcedureLast", "[", 
      RowBox[{"m_", ",", 
       RowBox[{"(*", 
        RowBox[{"total", " ", "data"}], "*)"}], "directions_", ",", 
       "distances_", ",", "diameters_", ",", "kLCoef_", ",", "TSoilValues_", 
       ",", "hydraulicResistance_", ",", "M_", ",", 
       RowBox[{"(*", 
        RowBox[{"gas", " ", "properties"}], "*)"}], "rhon_", ",", "Mmolar_", 
       ",", "Rspecific_", ",", "p2_", ",", "TempKS_", ",", "roughness_"}], 
      "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "p1", ",", "T1", ",", "p22", ",", "nLIM", ",", "TempEnd", ",", "t1", 
         ",", "t2", ",", "n", ",", "tcenter", ",", "epsilon", ",", "mu", ",", 
         "Reyn", ",", "f", ",", "S", ",", "Zcurrent", ",", "beta", ",", 
         "JouleThomsonCoef", ",", "Kcoef", ",", "T2", ",", "cp", ",", 
         RowBox[{"k", "=", "roughness"}], ",", "Diaminner", ",", "L", ",", 
         "Tsoil", ",", "kL", ",", "num", ",", " ", 
         RowBox[{"p2local", "=", "p2"}]}], "}"}], ",", "\[IndentingNewLine]", 
       
       RowBox[{
        RowBox[{"nLIM", "=", 
         RowBox[{"Length", "[", 
          RowBox[{"directions", "[", 
           RowBox[{"[", "m", "]"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"totalData", "[", 
          RowBox[{"m", ",", "\"\<P\>\"", ",", "nLIM"}], "]"}], "=", 
         RowBox[{"pa2kg", "[", "p2", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"n", "=", "1"}], ",", 
          RowBox[{"n", "<", "nLIM"}], ",", 
          RowBox[{"n", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"Set", " ", "data"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Diaminner", "=", 
            RowBox[{"diameters", "[", 
             RowBox[{
              RowBox[{"directions", "[", 
               RowBox[{"[", 
                RowBox[{"m", ",", "n"}], "]"}], "]"}], ",", 
              RowBox[{"directions", "[", 
               RowBox[{"[", 
                RowBox[{"m", ",", 
                 RowBox[{"n", "+", "1"}]}], "]"}], "]"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"L", "=", 
            RowBox[{"distances", "[", 
             RowBox[{
              RowBox[{"directions", "[", 
               RowBox[{"[", 
                RowBox[{"m", ",", "n"}], "]"}], "]"}], ",", 
              RowBox[{"directions", "[", 
               RowBox[{"[", 
                RowBox[{"m", ",", 
                 RowBox[{"n", "+", "1"}]}], "]"}], "]"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"kL", "=", 
            RowBox[{"kLCoef", "[", 
             RowBox[{
              RowBox[{"directions", "[", 
               RowBox[{"[", 
                RowBox[{"m", ",", "n"}], "]"}], "]"}], ",", 
              RowBox[{"directions", "[", 
               RowBox[{"[", 
                RowBox[{"m", ",", 
                 RowBox[{"n", "+", "1"}]}], "]"}], "]"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Tsoil", "=", 
            RowBox[{"273.15", "+", 
             RowBox[{"TSoilValues", "[", 
              RowBox[{
               RowBox[{"directions", "[", 
                RowBox[{"[", 
                 RowBox[{"m", ",", "n"}], "]"}], "]"}], ",", 
               RowBox[{"directions", "[", 
                RowBox[{"[", 
                 RowBox[{"m", ",", 
                  RowBox[{"n", "+", "1"}]}], "]"}], "]"}]}], "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"TempEnd", "=", 
            RowBox[{"Max", "[", 
             RowBox[{"Tsoil", ",", "TempKS"}], "]"}]}], ";", 
           RowBox[{"(*", 
            RowBox[{"temperature", " ", "in", " ", "the", " ", "end"}], 
            "*)"}], "\[IndentingNewLine]", 
           RowBox[{"t1", "=", 
            RowBox[{"Min", "[", 
             RowBox[{"Tsoil", ",", "TempEnd"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"t2", "=", 
            RowBox[{"Max", "[", 
             RowBox[{"Tsoil", ",", "TempEnd"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"tcenter", "=", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"t1", "+", "t2"}], ")"}], "/", "2"}]}], ";", " ", 
           RowBox[{"(*", 
            RowBox[{
            "mean", " ", "value", " ", "for", " ", "binary", " ", 
             "algorithm"}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"T2", "=", "tcenter"}], ";", "\[IndentingNewLine]", 
           RowBox[{"epsilon", "=", "0.1"}], ";", " ", 
           RowBox[{"(*", 
            RowBox[{
            "max", " ", "value", " ", "for", " ", "deviation", " ", "from", 
             " ", "computed", " ", "temperature"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"num", "=", "0"}], ";", "\[IndentingNewLine]", 
           RowBox[{"While", "[", 
            RowBox[{"True", ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"num", ">", "30"}], ",", 
                RowBox[{
                 RowBox[{"Print", "[", 
                  RowBox[{"\"\<Stopped in iteration No\>\"", ",", "num"}], 
                  "]"}], ";", 
                 RowBox[{"Break", "[", "]"}], ";"}]}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"num", "++"}], ";", "\[IndentingNewLine]", 
              RowBox[{"p22", "=", "p2local"}], ";", 
              RowBox[{"(*", 
               RowBox[{"in", " ", "Pa"}], "*)"}], "\[IndentingNewLine]", 
              RowBox[{"p1", "=", "p22"}], ";", "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{"++", 
                 RowBox[{"++", 
                  RowBox[{"+", " ", "n"}]}]}], "-", 
                RowBox[{"th", " ", 
                 RowBox[{
                  RowBox[{"segment", " ", "++"}], "++"}]}], "+"}], "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{
                "Print", "[", "\"\<--------------------------------\>\"", 
                 "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"Print", "[", 
                 RowBox[{"\"\<STEP: \>\"", ",", " ", 
                  RowBox[{"directions", "[", 
                   RowBox[{"[", 
                    RowBox[{"m", ",", "n"}], "]"}], "]"}], ",", 
                  "\"\< --> \>\"", ",", 
                  RowBox[{"directions", "[", 
                   RowBox[{"[", 
                    RowBox[{"m", ",", 
                    RowBox[{"n", "+", "1"}]}], "]"}], "]"}]}], "]"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{
                "Print", "[", "\"\<--------------------------------\>\"", 
                 "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{
                 RowBox[{"++", 
                  RowBox[{"++", 
                   RowBox[{"++", "Main"}]}]}], " ", 
                 RowBox[{
                  RowBox[{"calculations", "++"}], "++"}]}], "+"}], "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{"++", 
                 RowBox[{"++", 
                  RowBox[{"+", " ", "n"}]}]}], "-", 
                RowBox[{
                 RowBox[{"discretization", " ", "++"}], "++"}], "+"}], "*)"}],
               "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{
                "Print", "[", "\"\<--------------------------------\>\"", 
                 "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"Print", "[", 
                 RowBox[{
                  RowBox[{"nLIM", "-", "n", "+", "1"}], ",", 
                  "\"\<-discretization\>\""}], "]"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{
                "Print", "[", "\"\<--------------------------------\>\"", 
                 "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"Print", "[", 
                 RowBox[{"\"\<Point \>\"", ",", 
                  RowBox[{"L", "/", "1000"}], ",", "\"\< km\>\""}], "]"}], 
                ";"}], "*)"}], "\[IndentingNewLine]", 
              RowBox[{"S", "=", 
               RowBox[{"Pi", "*", 
                RowBox[{
                 RowBox[{"Diaminner", "^", "2"}], "/", "4"}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"Zcurrent", "=", 
               RowBox[{"calculateZ", "[", 
                RowBox[{"rhon", ",", 
                 RowBox[{"p2", "*", 
                  RowBox[{"10", "^", 
                   RowBox[{"(", 
                    RowBox[{"-", "6"}], ")"}]}]}], ",", "T2", ",", 
                 "Rspecific"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{"Print", "[", 
                 RowBox[{"\"\<Z: \>\"", ",", "Zcurrent"}], "]"}], ";"}], 
               "*)"}], "\[IndentingNewLine]", 
              RowBox[{"Reyn", "=", 
               RowBox[{"calculateReynolds", "[", 
                RowBox[{"rhon", ",", "p2", ",", "T2", ",", "Rspecific", ",", 
                 RowBox[{
                  RowBox[{"M", "/", "rhon"}], "//", "N"}], ",", "Diaminner"}],
                 "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{"Print", "[", 
                 RowBox[{"\"\<Reynolds: \>\"", ",", " ", "Reyn"}], "]"}], 
                ";"}], "*)"}], "\[IndentingNewLine]", 
              RowBox[{"f", "=", 
               RowBox[{
                RowBox[{"calculateFanningFrictionFactor", "[", 
                 RowBox[{"Reyn", ",", "k", ",", "Diaminner"}], "]"}], "+", 
                RowBox[{"hydraulicResistance", "[", 
                 RowBox[{
                  RowBox[{"directions", "[", 
                   RowBox[{"[", 
                    RowBox[{"m", ",", "n"}], "]"}], "]"}], ",", 
                  RowBox[{"directions", "[", 
                   RowBox[{"[", 
                    RowBox[{"m", ",", 
                    RowBox[{"n", "+", "1"}]}], "]"}], "]"}]}], "]"}]}]}], ";",
               "\[IndentingNewLine]", 
              RowBox[{"cp", "=", 
               RowBox[{"calculateCp", "[", 
                RowBox[{"rhon", ",", 
                 RowBox[{"p2", "*", 
                  RowBox[{"10", "^", 
                   RowBox[{"(", 
                    RowBox[{"-", "6"}], ")"}]}]}], ",", "T2", ",", 
                 "Rspecific"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"beta", "=", 
               RowBox[{"kL", "/", 
                RowBox[{"(", 
                 RowBox[{"cp", "*", "M"}], ")"}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"JouleThomsonCoef", "=", 
               RowBox[{"calculateJouleThomsonCoef", "[", 
                RowBox[{"T2", ",", "cp"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"T1", "=", 
               RowBox[{"Tsoil", "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"T2", "-", "Tsoil"}], ")"}], "*", 
                 RowBox[{"Exp", "[", 
                  RowBox[{"beta", "*", "L"}], "]"}]}], "+", 
                RowBox[{"JouleThomsonCoef", "*", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"p1", "-", "p22"}], ")"}], "/", 
                  RowBox[{"(", 
                   RowBox[{"beta", "*", "L"}], ")"}]}], "*", 
                 RowBox[{"(", 
                  RowBox[{"1", "-", 
                   RowBox[{"Exp", "[", 
                    RowBox[{
                    RowBox[{"-", "beta"}], "*", "L"}], "]"}]}], ")"}]}]}]}], 
              ";", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"T1", ">", "370"}], ",", 
                RowBox[{
                 RowBox[{"T1", "=", 
                  RowBox[{"Tsoil", "+", "0.00001"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"(*", 
                  RowBox[{
                   RowBox[{"Print", "[", 
                    RowBox[{
                    "\"\<Temperature in Kelvin: \>\"", ",", " ", "T1"}], 
                    "]"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"Print", "[", 
                    RowBox[{"\"\<Temperature in Celsius: \>\"", ",", " ", 
                    RowBox[{"T1", "-", "273.15"}]}], "]"}], ";"}], "*)"}], 
                 "\[IndentingNewLine]", 
                 RowBox[{"Kcoef", "=", 
                  RowBox[{"Zcurrent", "*", 
                   RowBox[{"Rspecific", "/", 
                    RowBox[{"S", "^", "2"}]}], "*", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"4", "*", 
                    RowBox[{"f", "/", "Diaminner"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Tsoil", "*", "L"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"T2", "-", "Tsoil"}], ")"}], "/", "beta"}], "-", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"T2", "-", "Tsoil"}], ")"}], "/", "beta"}], "*", 
                    RowBox[{"Exp", "[", 
                    RowBox[{
                    RowBox[{"-", "beta"}], "*", "L"}], "]"}]}]}], ")"}]}], 
                    "-", 
                    RowBox[{"2", "*", 
                    RowBox[{"(", 
                    RowBox[{"T1", "-", "T2"}], ")"}]}]}], ")"}]}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"p1", "=", 
                  RowBox[{
                   RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"Kcoef", "*", 
                    RowBox[{"M", "^", "2"}]}], "+", 
                    RowBox[{"p22", "^", "2"}]}], "]"}], "//", "N"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"(*", 
                  RowBox[{
                   RowBox[{"Print", "[", 
                    RowBox[{"\"\<Pressure Pa: \>\"", ",", " ", "p1"}], "]"}], 
                   ";", "\[IndentingNewLine]", 
                   RowBox[{"Print", "[", 
                    RowBox[{"\"\<Pressure kgs/cm2: \>\"", ",", " ", 
                    RowBox[{"pa2kg", "[", "p1", "]"}]}], "]"}], ";"}], "*)"}],
                  "\[IndentingNewLine]", 
                 RowBox[{"p22", "=", "p1"}], ";", "\[IndentingNewLine]", 
                 RowBox[{"Break", "[", "]"}], ";"}]}], "\[IndentingNewLine]", 
               "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{"Print", "[", 
                 RowBox[{"\"\<Temperature in Kelvin: \>\"", ",", " ", "T1"}], 
                 "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"Print", "[", 
                 RowBox[{"\"\<Temperature in Celsius: \>\"", ",", " ", 
                  RowBox[{"T1", "-", "273.15"}]}], "]"}], ";"}], "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"Kcoef", "=", 
               RowBox[{"Zcurrent", "*", 
                RowBox[{"Rspecific", "/", 
                 RowBox[{"S", "^", "2"}]}], "*", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"4", "*", 
                   RowBox[{"f", "/", "Diaminner"}], "*", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Tsoil", "*", "L"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"T2", "-", "Tsoil"}], ")"}], "/", "beta"}], "-", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"T2", "-", "Tsoil"}], ")"}], "/", "beta"}], "*", 
                    RowBox[{"Exp", "[", 
                    RowBox[{
                    RowBox[{"-", "beta"}], "*", "L"}], "]"}]}]}], ")"}]}], 
                  "-", 
                  RowBox[{"2", "*", 
                   RowBox[{"(", 
                    RowBox[{"T1", "-", "T2"}], ")"}]}]}], ")"}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"p1", "=", 
               RowBox[{
                RowBox[{"Sqrt", "[", 
                 RowBox[{
                  RowBox[{"Kcoef", "*", 
                   RowBox[{"M", "^", "2"}]}], "+", 
                  RowBox[{"p22", "^", "2"}]}], "]"}], "//", "N"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{"Print", "[", 
                 RowBox[{"\"\<Pressure Pa: \>\"", ",", " ", "p1"}], "]"}], 
                ";", "\[IndentingNewLine]", 
                RowBox[{"Print", "[", 
                 RowBox[{"\"\<Pressure kgs/cm2: \>\"", ",", " ", 
                  RowBox[{"pa2kg", "[", "p1", "]"}]}], "]"}], ";"}], "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"p22", "=", "p1"}], ";", "\[IndentingNewLine]", 
              RowBox[{"T2", "=", "T1"}], ";", "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
               "\:0421heck", " ", "the", " ", "deviation", " ", "from", " ", 
                "the", " ", "compressor", " ", "station", " ", 
                "temperature"}], "*)"}], "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Abs", "[", 
                  RowBox[{"TempKS", "-", "T1"}], "]"}], "<", "epsilon"}], ",", 
                RowBox[{"Break", "[", "]"}]}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{"Binary", " ", "algorithm", " ", "assertions"}], 
               "*)"}], "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"TempKS", ">", "T1"}], ",", 
                RowBox[{"t1", "=", "tcenter"}], ",", 
                RowBox[{"t2", "=", "tcenter"}]}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"tcenter", "=", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"t1", "+", "t2"}], ")"}], "/", "2"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"T2", "=", "tcenter"}], ";"}]}], "\[IndentingNewLine]", 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"totalData", "[", 
             RowBox[{"m", ",", "\"\<P\>\"", ",", 
              RowBox[{"nLIM", "-", "n"}]}], "]"}], "=", 
            RowBox[{"pa2kg", "[", "p22", "]"}]}], ";", "\[IndentingNewLine]", 
           
           RowBox[{"p2local", "=", "p22"}], ";"}]}], "\[IndentingNewLine]", 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"{", 
          RowBox[{"p1", ",", "T1", ",", "tcenter"}], "}"}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", 
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**"}], "******)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"inverseProcedure", "[", 
      RowBox[{"m_", ",", 
       RowBox[{"(*", 
        RowBox[{"total", " ", "data"}], "*)"}], "directions_", ",", 
       "distances_", ",", "diameters_", ",", "kLCoef_", ",", "TSoilValues_", 
       ",", "hydraulicResistance_", ",", "M_", ",", 
       RowBox[{"(*", 
        RowBox[{"gas", " ", "properties"}], "*)"}], "rhon_", ",", "Mmolar_", 
       ",", "Rspecific_", ",", "p2_", ",", "TempKS_", ",", "ksId_", ",", 
       "pIn_", ",", "TIn_", ",", "typePoint_", ",", "atmP_", ",", "atmT_", 
       ",", "roughness_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "p1", ",", "T1", ",", "p22", ",", "nLIM", ",", "TempEnd", ",", "t1", 
         ",", "t2", ",", "n", ",", "tcenter", ",", "epsilon", ",", "mu", ",", 
         "Reyn", ",", "f", ",", "S", ",", "Zcurrent", ",", "beta", ",", 
         "JouleThomsonCoef", ",", "Kcoef", ",", "T2", ",", "cp", ",", 
         RowBox[{"k", "=", "roughness"}], ",", "Diaminner", ",", "L", ",", 
         "Tsoil", ",", "kL", ",", "num", ",", " ", 
         RowBox[{"p2local", "=", "p2"}], ",", "Tout", ",", "reqString", ",", 
         "response", ",", "commercialSupplyCS", ",", "pressureKg", ",", "req",
          ",", "res"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"nLIM", "=", 
         RowBox[{"Length", "[", 
          RowBox[{"directions", "[", 
           RowBox[{"[", "m", "]"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"n", "=", "1"}], ",", 
          RowBox[{"n", "<", "nLIM"}], ",", 
          RowBox[{"n", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"Set", " ", "data"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Diaminner", "=", 
            RowBox[{"diameters", "[", 
             RowBox[{
              RowBox[{"directions", "[", 
               RowBox[{"[", 
                RowBox[{"m", ",", "n"}], "]"}], "]"}], ",", 
              RowBox[{"directions", "[", 
               RowBox[{"[", 
                RowBox[{"m", ",", 
                 RowBox[{"n", "+", "1"}]}], "]"}], "]"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"L", "=", 
            RowBox[{"distances", "[", 
             RowBox[{
              RowBox[{"directions", "[", 
               RowBox[{"[", 
                RowBox[{"m", ",", "n"}], "]"}], "]"}], ",", 
              RowBox[{"directions", "[", 
               RowBox[{"[", 
                RowBox[{"m", ",", 
                 RowBox[{"n", "+", "1"}]}], "]"}], "]"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"kL", "=", 
            RowBox[{"kLCoef", "[", 
             RowBox[{
              RowBox[{"directions", "[", 
               RowBox[{"[", 
                RowBox[{"m", ",", "n"}], "]"}], "]"}], ",", 
              RowBox[{"directions", "[", 
               RowBox[{"[", 
                RowBox[{"m", ",", 
                 RowBox[{"n", "+", "1"}]}], "]"}], "]"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Tsoil", "=", 
            RowBox[{"273.15", "+", 
             RowBox[{"TSoilValues", "[", 
              RowBox[{
               RowBox[{"directions", "[", 
                RowBox[{"[", 
                 RowBox[{"m", ",", "n"}], "]"}], "]"}], ",", 
               RowBox[{"directions", "[", 
                RowBox[{"[", 
                 RowBox[{"m", ",", 
                  RowBox[{"n", "+", "1"}]}], "]"}], "]"}]}], "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"TempEnd", "=", 
            RowBox[{"Max", "[", 
             RowBox[{"Tsoil", ",", "TempKS"}], "]"}]}], ";", 
           RowBox[{"(*", 
            RowBox[{"temperature", " ", "in", " ", "the", " ", "end"}], 
            "*)"}], "\[IndentingNewLine]", 
           RowBox[{"t1", "=", 
            RowBox[{"Min", "[", 
             RowBox[{"Tsoil", ",", "TempEnd"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"t2", "=", 
            RowBox[{"Max", "[", 
             RowBox[{"Tsoil", ",", "TempEnd"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"tcenter", "=", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"t1", "+", "t2"}], ")"}], "/", "2"}]}], ";", " ", 
           RowBox[{"(*", 
            RowBox[{
            "mean", " ", "value", " ", "for", " ", "binary", " ", 
             "algorithm"}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"T2", "=", "tcenter"}], ";", "\[IndentingNewLine]", 
           RowBox[{"epsilon", "=", "0.1"}], ";", " ", 
           RowBox[{"(*", 
            RowBox[{
            "max", " ", "value", " ", "for", " ", "deviation", " ", "from", 
             " ", "computed", " ", "temperature"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"**", "**", "**", "**"}], "*", "First", " ", "iteration",
              " ", "to", " ", "compute", " ", 
             RowBox[{"tempKS", "**", "**", "**"}], "*"}], "*****)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"p22", "=", "p2local"}], ";", 
           RowBox[{"(*", 
            RowBox[{"in", " ", "Pa"}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"p1", "=", "p22"}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"typePoint", "\[Equal]", "\"\<station\>\""}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"++", 
                RowBox[{"++", 
                 RowBox[{"+", " ", "n"}]}]}], "-", 
               RowBox[{"th", " ", 
                RowBox[{
                 RowBox[{"segment", " ", "++"}], "++"}]}], "+"}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{
               "Print", "[", "\"\<--------------------------------\>\"", 
                "]"}], ";", "\[IndentingNewLine]", 
               RowBox[{"Print", "[", 
                RowBox[{"\"\<STEP: \>\"", ",", " ", 
                 RowBox[{"directions", "[", 
                  RowBox[{"[", 
                   RowBox[{"m", ",", "n"}], "]"}], "]"}], ",", 
                 "\"\< --> \>\"", ",", 
                 RowBox[{"directions", "[", 
                  RowBox[{"[", 
                   RowBox[{"m", ",", 
                    RowBox[{"n", "+", "1"}]}], "]"}], "]"}]}], "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{
               "Print", "[", "\"\<--------------------------------\>\"", 
                "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{
                RowBox[{"++", 
                 RowBox[{"++", 
                  RowBox[{"++", "Main"}]}]}], " ", 
                RowBox[{
                 RowBox[{"calculations", "++"}], "++"}]}], "+"}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"++", 
                RowBox[{"++", 
                 RowBox[{"+", " ", "n"}]}]}], "-", 
               RowBox[{
                RowBox[{"discretization", " ", "++"}], "++"}], "+"}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{
               "Print", "[", "\"\<--------------------------------\>\"", 
                "]"}], ";", "\[IndentingNewLine]", 
               RowBox[{"Print", "[", 
                RowBox[{
                 RowBox[{"nLIM", "-", "n", "+", "1"}], ",", 
                 "\"\<-discretization\>\""}], "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{
               "Print", "[", "\"\<--------------------------------\>\"", 
                "]"}], ";", "\[IndentingNewLine]", 
               RowBox[{"Print", "[", 
                RowBox[{"\"\<Point \>\"", ",", 
                 RowBox[{"L", "/", "1000"}], ",", "\"\< km\>\""}], "]"}], 
               ";"}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"S", "=", 
               RowBox[{"Pi", "*", 
                RowBox[{
                 RowBox[{"Diaminner", "^", "2"}], "/", "4"}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"Zcurrent", "=", 
               RowBox[{"calculateZ", 
                RowBox[{"(*", 
                 RowBox[{"[", "9", "]"}], "*)"}], "[", 
                RowBox[{"rhon", ",", 
                 RowBox[{"p2", "*", 
                  RowBox[{"10", "^", 
                   RowBox[{"(", 
                    RowBox[{"-", "6"}], ")"}]}]}], ",", "T2", ",", 
                 "Rspecific"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{"Print", "[", 
                 RowBox[{"\"\<Z: \>\"", ",", "Zcurrent"}], "]"}], ";"}], 
               "*)"}], "\[IndentingNewLine]", 
              RowBox[{"Reyn", "=", 
               RowBox[{"calculateReynolds", "[", 
                RowBox[{"rhon", ",", "p2", ",", "T2", ",", "Rspecific", ",", 
                 RowBox[{
                  RowBox[{"M", "/", "rhon"}], "//", "N"}], ",", "Diaminner"}],
                 "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{"Print", "[", 
                 RowBox[{"\"\<Reynolds: \>\"", ",", " ", "Reyn"}], "]"}], 
                ";"}], "*)"}], "\[IndentingNewLine]", 
              RowBox[{"f", "=", 
               RowBox[{
                RowBox[{"calculateFanningFrictionFactor", "[", 
                 RowBox[{"Reyn", ",", "k", ",", "Diaminner"}], "]"}], "+", 
                RowBox[{"hydraulicResistance", "[", 
                 RowBox[{
                  RowBox[{"directions", "[", 
                   RowBox[{"[", 
                    RowBox[{"m", ",", "n"}], "]"}], "]"}], ",", 
                  RowBox[{"directions", "[", 
                   RowBox[{"[", 
                    RowBox[{"m", ",", 
                    RowBox[{"n", "+", "1"}]}], "]"}], "]"}]}], "]"}]}]}], ";",
               "\[IndentingNewLine]", 
              RowBox[{"cp", "=", 
               RowBox[{"calculateCp", "[", 
                RowBox[{"rhon", ",", 
                 RowBox[{"p2", "*", 
                  RowBox[{"10", "^", 
                   RowBox[{"(", 
                    RowBox[{"-", "6"}], ")"}]}]}], ",", "T2", ",", 
                 "Rspecific"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"beta", "=", 
               RowBox[{"kL", "/", 
                RowBox[{"(", 
                 RowBox[{"cp", "*", "M"}], ")"}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"JouleThomsonCoef", "=", 
               RowBox[{"calculateJouleThomsonCoef", "[", 
                RowBox[{"T2", ",", "cp"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"T1", "=", 
               RowBox[{"Tsoil", "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"T2", "-", "Tsoil"}], ")"}], "*", 
                 RowBox[{"Exp", "[", 
                  RowBox[{"beta", "*", "L"}], "]"}]}], "+", 
                RowBox[{"JouleThomsonCoef", "*", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"p1", "-", "p22"}], ")"}], "/", 
                  RowBox[{"(", 
                   RowBox[{"beta", "*", "L"}], ")"}]}], "*", 
                 RowBox[{"(", 
                  RowBox[{"1", "-", 
                   RowBox[{"Exp", "[", 
                    RowBox[{
                    RowBox[{"-", "beta"}], "*", "L"}], "]"}]}], ")"}]}]}]}], 
              ";", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"T1", ">", "1000"}], ",", 
                RowBox[{
                 RowBox[{"T1", "=", 
                  RowBox[{"Tsoil", "+", "0.00001"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"(*", 
                  RowBox[{
                   RowBox[{"Print", "[", 
                    RowBox[{
                    "\"\<Temperature in Kelvin: \>\"", ",", " ", "T1"}], 
                    "]"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"Print", "[", 
                    RowBox[{"\"\<Temperature in Celsius: \>\"", ",", " ", 
                    RowBox[{"T1", "-", "273.15"}]}], "]"}], ";"}], "*)"}], 
                 "\[IndentingNewLine]", 
                 RowBox[{"Kcoef", "=", 
                  RowBox[{"Zcurrent", "*", 
                   RowBox[{"Rspecific", "/", 
                    RowBox[{"S", "^", "2"}]}], "*", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"4", "*", 
                    RowBox[{"f", "/", "Diaminner"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Tsoil", "*", "L"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"T2", "-", "Tsoil"}], ")"}], "/", "beta"}], "-", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"T2", "-", "Tsoil"}], ")"}], "/", "beta"}], "*", 
                    RowBox[{"Exp", "[", 
                    RowBox[{
                    RowBox[{"-", "beta"}], "*", "L"}], "]"}]}]}], ")"}]}], 
                    "-", 
                    RowBox[{"2", "*", 
                    RowBox[{"(", 
                    RowBox[{"T1", "-", "T2"}], ")"}]}]}], ")"}]}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"p1", "=", 
                  RowBox[{
                   RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"Kcoef", "*", 
                    RowBox[{"M", "^", "2"}]}], "+", 
                    RowBox[{"p22", "^", "2"}]}], "]"}], "//", "N"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"(*", 
                  RowBox[{
                   RowBox[{"Print", "[", 
                    RowBox[{"\"\<Pressure Pa: \>\"", ",", " ", "p1"}], "]"}], 
                   ";", "\[IndentingNewLine]", 
                   RowBox[{"Print", "[", 
                    RowBox[{"\"\<Pressure kgs/cm2: \>\"", ",", " ", 
                    RowBox[{"pa2kg", "[", "p1", "]"}]}], "]"}], ";"}], "*)"}],
                  "\[IndentingNewLine]", 
                 RowBox[{"p22", "=", "p1"}], ";", "\[IndentingNewLine]", 
                 RowBox[{"Break", "[", "]"}], ";"}]}], "\[IndentingNewLine]", 
               "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{"Print", "[", 
                 RowBox[{"\"\<Temperature in Kelvin: \>\"", ",", " ", "T1"}], 
                 "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"Print", "[", 
                 RowBox[{"\"\<Temperature in Celsius: \>\"", ",", " ", 
                  RowBox[{"T1", "-", "273.15"}]}], "]"}], ";"}], "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"Kcoef", "=", 
               RowBox[{"Zcurrent", "*", 
                RowBox[{"Rspecific", "/", 
                 RowBox[{"S", "^", "2"}]}], "*", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"4", "*", 
                   RowBox[{"f", "/", "Diaminner"}], "*", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Tsoil", "*", "L"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"T2", "-", "Tsoil"}], ")"}], "/", "beta"}], "-", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"T2", "-", "Tsoil"}], ")"}], "/", "beta"}], "*", 
                    RowBox[{"Exp", "[", 
                    RowBox[{
                    RowBox[{"-", "beta"}], "*", "L"}], "]"}]}]}], ")"}]}], 
                  "-", 
                  RowBox[{"2", "*", 
                   RowBox[{"(", 
                    RowBox[{"T1", "-", "T2"}], ")"}]}]}], ")"}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"p1", "=", 
               RowBox[{
                RowBox[{"Sqrt", "[", 
                 RowBox[{
                  RowBox[{"Kcoef", "*", 
                   RowBox[{"M", "^", "2"}]}], "+", 
                  RowBox[{"p22", "^", "2"}]}], "]"}], "//", "N"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{"Print", "[", 
                 RowBox[{"\"\<Pressure Pa: \>\"", ",", " ", "p1"}], "]"}], 
                ";"}], "*)"}], "\[IndentingNewLine]", 
              RowBox[{"pressureKg", "=", " ", 
               RowBox[{"pa2kg", "[", "p1", "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{"Print", "[", 
                 RowBox[{"\"\<Pressure kgs/cm2: \>\"", ",", "pressureKg"}], 
                 "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{
                "Get", " ", "from", " ", "calculation", " ", "for", " ", 
                 "KS"}], ",", " ", 
                RowBox[{
                "if", " ", "calculation", " ", "TempKS", " ", "is", " ", 
                 "used", " ", "P_out", " ", "it", " ", "is", " ", "possible", 
                 " ", "to", " ", "get", " ", "it", " ", "from", " ", "first", 
                 " ", "iteration"}]}], "*)"}], "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"commercialSupplyCS", " ", "--"}], " ", "in", " ", 
                  "million", " ", 
                  RowBox[{"m3", "/", "day"}], "\[IndentingNewLine]", 
                  "pressureIn"}], " ", "-", " ", 
                 RowBox[{
                  RowBox[{"kgs", "/", "cm2"}], "\[IndentingNewLine]", 
                  "temperatureIn"}]}], ",", " ", 
                RowBox[{"atmTemperature", " ", "-", " ", 
                 RowBox[{"C", "\[IndentingNewLine]", "gasCalory"}], " ", "-", 
                 " ", 
                 RowBox[{
                  RowBox[{"MJouel", "/", "m3"}], "\[IndentingNewLine]", 
                  "atmPressure"}], " ", "-", " ", "MPa"}]}], 
               "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
              RowBox[{"commercialSupplyCS", "=", 
               RowBox[{
                RowBox[{"M", "/", "rhon"}], "*", "24", "*", "3600", "*", 
                RowBox[{"10", "^", 
                 RowBox[{"(", 
                  RowBox[{"-", "6"}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"reqString", "=", 
               RowBox[{
               "\"\<http://turantest.sapasoft.kz/api/main/api/CsRegime/\
CalculateRegimeForModeling?pressureIn=\>\"", "<>", 
                RowBox[{"ToString", "[", "pIn", "]"}], "<>", 
                "\"\<&temperatureIn=\>\"", "<>", 
                RowBox[{"ToString", "[", "TIn", "]"}], "<>", 
                "\"\<&commercialSupplyCS=\>\"", "<>", 
                RowBox[{"ToString", "[", "commercialSupplyCS", "]"}], "<>", 
                "\"\<&gasDensity=\>\"", "<>", 
                RowBox[{"ToString", "[", "rhon", "]"}], "<>", 
                "\"\<&gasCalory=\>\"", "<>", 
                RowBox[{"ToString", "[", "hs", "]"}], "<>", 
                "\"\<&atmTemperature=\>\"", "<>", 
                RowBox[{"ToString", "[", "atmT", "]"}], "<>", 
                "\"\<&atmPressure=\>\"", "<>", 
                RowBox[{"ToString", "[", "atmP", "]"}], "<>", 
                "\"\<&csWorkshopRegistryId=\>\"", "<>", 
                RowBox[{"ToString", "[", "ksId", "]"}], "<>", 
                "\"\<&pressureOutTarget=\>\"", "<>", 
                RowBox[{"ToString", "[", "pressureKg", "]"}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"req", "=", 
               RowBox[{"HTTPRequest", "[", "reqString", "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"Print", "[", "req", "]"}], ";", "\[IndentingNewLine]", 
              
              RowBox[{"response", "=", 
               RowBox[{"URLRead", "[", 
                RowBox[{"req", ",", "\"\<Body\>\""}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"res", "=", 
               RowBox[{"ToString", "[", "response", "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"Print", "[", "res", "]"}], ";", "\[IndentingNewLine]", 
              
              RowBox[{"(*", 
               RowBox[{
               "get", " ", "from", " ", "body", " ", "temperatureOut", " ", 
                "and", " ", "set", " ", "to", " ", "Tout"}], "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"Tout", "=", 
               RowBox[{
                RowBox[{"ToExpression", "[", 
                 RowBox[{
                  RowBox[{"StringSplit", "[", 
                   RowBox[{"res", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<:\>\"", ",", "\"\<,\>\""}], "}"}]}], "]"}], 
                  "[", 
                  RowBox[{"[", "4", "]"}], "]"}], "]"}], "+", "273.15"}]}], 
              ";", "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{"**", "**", "**", "**", "**", "**", "**", "**"}], 
               "*****)"}], "\[IndentingNewLine]", 
              RowBox[{"TempEnd", "=", 
               RowBox[{"Max", "[", 
                RowBox[{"Tsoil", ",", "Tout"}], "]"}]}], ";", 
              RowBox[{"(*", 
               RowBox[{"temperature", " ", "in", " ", "the", " ", "end"}], 
               "*)"}], "\[IndentingNewLine]", 
              RowBox[{"t1", "=", 
               RowBox[{"Min", "[", 
                RowBox[{"Tsoil", ",", "TempEnd"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"t2", "=", 
               RowBox[{"Max", "[", 
                RowBox[{"Tsoil", ",", "TempEnd"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"tcenter", "=", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"t1", "+", "t2"}], ")"}], "/", "2"}]}], ";", " ", 
              RowBox[{"(*", 
               RowBox[{
               "mean", " ", "value", " ", "for", " ", "binary", " ", 
                "algorithm"}], "*)"}], "\[IndentingNewLine]", 
              RowBox[{"T2", "=", "tcenter"}], ";"}]}], "\[IndentingNewLine]", 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"num", "=", "0"}], ";", "\[IndentingNewLine]", 
           RowBox[{"While", "[", 
            RowBox[{"True", ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"num", ">", "30"}], ",", 
                RowBox[{"(*", 
                 RowBox[{
                  RowBox[{"Print", "[", 
                   RowBox[{"\"\<Stopped in iteration No\>\"", ",", "num"}], 
                   "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
                RowBox[{"Break", "[", "]"}]}], "\[IndentingNewLine]", "]"}], 
              ";", "\[IndentingNewLine]", 
              RowBox[{"num", "++"}], ";", "\n", "            ", 
              RowBox[{"p22", "=", "p2local"}], ";", 
              RowBox[{"(*", 
               RowBox[{"in", " ", "Pa"}], "*)"}], "\n", "            ", 
              RowBox[{"p1", "=", "p22"}], ";", "\n", "            ", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{"++", 
                 RowBox[{"++", 
                  RowBox[{"+", " ", "n"}]}]}], "-", 
                RowBox[{"th", " ", 
                 RowBox[{
                  RowBox[{"segment", " ", "++"}], "++"}]}], "+"}], "*)"}], 
              ";", "\n", "            ", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{
                "Print", "[", "\"\<--------------------------------\>\"", 
                 "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"Print", "[", 
                 RowBox[{"\"\<STEP: \>\"", ",", " ", 
                  RowBox[{"directions", "[", 
                   RowBox[{"[", 
                    RowBox[{"m", ",", "n"}], "]"}], "]"}], ",", 
                  "\"\< --> \>\"", ",", 
                  RowBox[{"directions", "[", 
                   RowBox[{"[", 
                    RowBox[{"m", ",", 
                    RowBox[{"n", "+", "1"}]}], "]"}], "]"}]}], "]"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{
                "Print", "[", "\"\<--------------------------------\>\"", 
                 "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{
                 RowBox[{"++", 
                  RowBox[{"++", 
                   RowBox[{"++", "Main"}]}]}], " ", 
                 RowBox[{
                  RowBox[{"calculations", "++"}], "++"}]}], "+"}], "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{"++", 
                 RowBox[{"++", 
                  RowBox[{"+", " ", "n"}]}]}], "-", 
                RowBox[{
                 RowBox[{"discretization", " ", "++"}], "++"}], "+"}], "*)"}],
               "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{
                "Print", "[", "\"\<--------------------------------\>\"", 
                 "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"Print", "[", 
                 RowBox[{
                  RowBox[{"nLIM", "-", "n", "+", "1"}], ",", 
                  "\"\<-discretization\>\""}], "]"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{
                "Print", "[", "\"\<--------------------------------\>\"", 
                 "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"Print", "[", 
                 RowBox[{"\"\<Point \>\"", ",", 
                  RowBox[{"L", "/", "1000"}], ",", "\"\< km\>\""}], "]"}], 
                ";"}], "*)"}], "\[IndentingNewLine]", 
              RowBox[{"S", "=", 
               RowBox[{"Pi", "*", 
                RowBox[{
                 RowBox[{"Diaminner", "^", "2"}], "/", "4"}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"Zcurrent", "=", 
               RowBox[{"calculateZ", 
                RowBox[{"(*", 
                 RowBox[{"[", "9", "]"}], "*)"}], "[", 
                RowBox[{"rhon", ",", 
                 RowBox[{"p2", "*", 
                  RowBox[{"10", "^", 
                   RowBox[{"(", 
                    RowBox[{"-", "6"}], ")"}]}]}], ",", "T2", ",", 
                 "Rspecific"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{"Print", "[", 
                 RowBox[{"\"\<Z: \>\"", ",", "Zcurrent"}], "]"}], ";"}], 
               "*)"}], "\[IndentingNewLine]", 
              RowBox[{"Reyn", "=", 
               RowBox[{"calculateReynolds", "[", 
                RowBox[{"rhon", ",", "p2", ",", "T2", ",", "Rspecific", ",", 
                 RowBox[{
                  RowBox[{"M", "/", "rhon"}], "//", "N"}], ",", "Diaminner"}],
                 "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{"Print", "[", 
                 RowBox[{"\"\<Reynolds: \>\"", ",", " ", "Reyn"}], "]"}], 
                ";"}], "*)"}], "\[IndentingNewLine]", 
              RowBox[{"f", "=", 
               RowBox[{
                RowBox[{"calculateFanningFrictionFactor", "[", 
                 RowBox[{"Reyn", ",", "k", ",", "Diaminner"}], "]"}], "+", 
                RowBox[{"hydraulicResistance", "[", 
                 RowBox[{
                  RowBox[{"directions", "[", 
                   RowBox[{"[", 
                    RowBox[{"m", ",", "n"}], "]"}], "]"}], ",", 
                  RowBox[{"directions", "[", 
                   RowBox[{"[", 
                    RowBox[{"m", ",", 
                    RowBox[{"n", "+", "1"}]}], "]"}], "]"}]}], "]"}]}]}], ";",
               "\[IndentingNewLine]", 
              RowBox[{"cp", "=", 
               RowBox[{"calculateCp", "[", 
                RowBox[{"rhon", ",", 
                 RowBox[{"p2", "*", 
                  RowBox[{"10", "^", 
                   RowBox[{"(", 
                    RowBox[{"-", "6"}], ")"}]}]}], ",", "T2", ",", 
                 "Rspecific"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"beta", "=", 
               RowBox[{"kL", "/", 
                RowBox[{"(", 
                 RowBox[{"cp", "*", "M"}], ")"}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"JouleThomsonCoef", "=", 
               RowBox[{"calculateJouleThomsonCoef", "[", 
                RowBox[{"T2", ",", "cp"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"T1", "=", 
               RowBox[{"Tsoil", "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"T2", "-", "Tsoil"}], ")"}], "*", 
                 RowBox[{"Exp", "[", 
                  RowBox[{"beta", "*", "L"}], "]"}]}], "+", 
                RowBox[{"JouleThomsonCoef", "*", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"p1", "-", "p22"}], ")"}], "/", 
                  RowBox[{"(", 
                   RowBox[{"beta", "*", "L"}], ")"}]}], "*", 
                 RowBox[{"(", 
                  RowBox[{"1", "-", 
                   RowBox[{"Exp", "[", 
                    RowBox[{
                    RowBox[{"-", "beta"}], "*", "L"}], "]"}]}], ")"}]}]}]}], 
              ";", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"T1", ">", "1000"}], ",", 
                RowBox[{
                 RowBox[{"T1", "=", 
                  RowBox[{"Tsoil", "+", "0.00001"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"(*", 
                  RowBox[{
                   RowBox[{"Print", "[", 
                    RowBox[{
                    "\"\<Temperature in Kelvin: \>\"", ",", " ", "T1"}], 
                    "]"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"Print", "[", 
                    RowBox[{"\"\<Temperature in Celsius: \>\"", ",", " ", 
                    RowBox[{"T1", "-", "273.15"}]}], "]"}], ";"}], "*)"}], 
                 "\[IndentingNewLine]", 
                 RowBox[{"Kcoef", "=", 
                  RowBox[{"Zcurrent", "*", 
                   RowBox[{"Rspecific", "/", 
                    RowBox[{"S", "^", "2"}]}], "*", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"4", "*", 
                    RowBox[{"f", "/", "Diaminner"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Tsoil", "*", "L"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"T2", "-", "Tsoil"}], ")"}], "/", "beta"}], "-", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"T2", "-", "Tsoil"}], ")"}], "/", "beta"}], "*", 
                    RowBox[{"Exp", "[", 
                    RowBox[{
                    RowBox[{"-", "beta"}], "*", "L"}], "]"}]}]}], ")"}]}], 
                    "-", 
                    RowBox[{"2", "*", 
                    RowBox[{"(", 
                    RowBox[{"T1", "-", "T2"}], ")"}]}]}], ")"}]}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"p1", "=", 
                  RowBox[{
                   RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"Kcoef", "*", 
                    RowBox[{"M", "^", "2"}]}], "+", 
                    RowBox[{"p22", "^", "2"}]}], "]"}], "//", "N"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"(*", 
                  RowBox[{
                   RowBox[{"Print", "[", 
                    RowBox[{"\"\<Pressure Pa: \>\"", ",", " ", "p1"}], "]"}], 
                   ";", "\[IndentingNewLine]", 
                   RowBox[{"Print", "[", 
                    RowBox[{"\"\<Pressure kgs/cm2: \>\"", ",", " ", 
                    RowBox[{"pa2kg", "[", "p1", "]"}]}], "]"}], ";"}], "*)"}],
                  "\[IndentingNewLine]", 
                 RowBox[{"p22", "=", "p1"}], ";", "\[IndentingNewLine]", 
                 RowBox[{"Break", "[", "]"}], ";"}]}], "\[IndentingNewLine]", 
               "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{"Print", "[", 
                 RowBox[{"\"\<Temperature in Kelvin: \>\"", ",", " ", "T1"}], 
                 "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"Print", "[", 
                 RowBox[{"\"\<Temperature in Celsius: \>\"", ",", " ", 
                  RowBox[{"T1", "-", "273.15"}]}], "]"}], ";"}], "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"Kcoef", "=", 
               RowBox[{"Zcurrent", "*", 
                RowBox[{"Rspecific", "/", 
                 RowBox[{"S", "^", "2"}]}], "*", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"4", "*", 
                   RowBox[{"f", "/", "Diaminner"}], "*", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Tsoil", "*", "L"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"T2", "-", "Tsoil"}], ")"}], "/", "beta"}], "-", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"T2", "-", "Tsoil"}], ")"}], "/", "beta"}], "*", 
                    RowBox[{"Exp", "[", 
                    RowBox[{
                    RowBox[{"-", "beta"}], "*", "L"}], "]"}]}]}], ")"}]}], 
                  "-", 
                  RowBox[{"2", "*", 
                   RowBox[{"(", 
                    RowBox[{"T1", "-", "T2"}], ")"}]}]}], ")"}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"p1", "=", 
               RowBox[{
                RowBox[{"Sqrt", "[", 
                 RowBox[{
                  RowBox[{"Kcoef", "*", 
                   RowBox[{"M", "^", "2"}]}], "+", 
                  RowBox[{"p22", "^", "2"}]}], "]"}], "//", "N"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{"Print", "[", 
                 RowBox[{"\"\<Pressure Pa: \>\"", ",", " ", "p1"}], "]"}], 
                ";", "\[IndentingNewLine]", 
                RowBox[{"Print", "[", 
                 RowBox[{"\"\<Pressure kgs/cm2: \>\"", ",", " ", 
                  RowBox[{"pa2kg", "[", "p1", "]"}]}], "]"}], ";"}], "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"p22", "=", "p1"}], ";", "\[IndentingNewLine]", 
              RowBox[{"T2", "=", "T1"}], ";", "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
               "\:0421heck", " ", "the", " ", "deviation", " ", "from", " ", 
                "the", " ", "compressor", " ", "station", " ", 
                "temperature"}], "*)"}], "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Abs", "[", 
                  RowBox[{"TempKS", "-", "T1"}], "]"}], "<", "epsilon"}], ",", 
                RowBox[{"Break", "[", "]"}]}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{"Binary", " ", "algorithm", " ", "assertions"}], 
               "*)"}], "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"TempKS", ">", "T1"}], ",", 
                RowBox[{"t1", "=", "tcenter"}], ",", 
                RowBox[{"t2", "=", "tcenter"}]}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"tcenter", "=", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"t1", "+", "t2"}], ")"}], "/", "2"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"T2", "=", "tcenter"}], ";"}]}], "\[IndentingNewLine]", 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"p2local", "=", "p22"}], ";"}]}], "\[IndentingNewLine]", 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"{", 
          RowBox[{"p1", ",", "T1", ",", "tcenter"}], "}"}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", 
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**"}], "******)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"streamSplitEqually", "[", "m_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"lenDirection", ",", "k", ",", "l", ",", 
         RowBox[{"detectedFaucetRegulator", "=", "False"}], ",", 
         "commonStartVertices", ",", "commonStartPointLocal", ",", 
         "numCommonStartPoint", ",", 
         RowBox[{"detectedStreamToStation", "=", "0"}], ",", 
         RowBox[{"detected", "=", "False"}], ",", "numCommonStartVertices", 
         ",", "nextDirection", ",", 
         RowBox[{"numCS", "=", 
          RowBox[{"Length", "[", "ksIds", "]"}]}], ",", "val"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "detect", " ", "parallel", " ", "tubes", " ", "to", " ", "split", " ",
          "gas", " ", "stream", " ", "equally"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"**", "**", "**", "START"}], "*******)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"lenDirection", "=", 
         RowBox[{"Length", "[", 
          RowBox[{"directions", "[", 
           RowBox[{"[", "m", "]"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"commonStartPointLocal", "=", 
         RowBox[{"commonTotalStartPoint", "[", 
          RowBox[{"[", "m", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"numCommonStartPoint", "=", 
         RowBox[{"Length", "[", "commonStartPointLocal", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"commonStartVertices", "=", 
         RowBox[{"commonTotalStartVertices", "[", 
          RowBox[{"[", "m", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"numCommonStartVertices", "=", 
         RowBox[{"Length", "[", "commonStartVertices", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "check", " ", "if", " ", "direction", " ", "go", " ", "to", " ", 
          "station"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"detectedStreamToStation", "=", 
         RowBox[{"checkStreamToStation", "[", "m", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"lenDirection", "=", 
         RowBox[{"Length", "[", "commonStartVertices", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "check", " ", "if", " ", "commonStartVertices", " ", "go", " ", "to",
           " ", "station"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"k", "=", "1"}], ",", 
          RowBox[{"k", "\[LessEqual]", "lenDirection"}], ",", 
          RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"val", "=", 
            RowBox[{"checkStreamToStation", "[", 
             RowBox[{"commonStartVertices", "[", 
              RowBox[{"[", "k", "]"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"val", ">", "0"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"detectedStreamToStation", "=", "val"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"Break", "[", "]"}]}]}], "\[IndentingNewLine]", "]"}], 
           ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"(*", 
         RowBox[{
         "check", " ", "common", " ", "start", " ", "vertices", " ", "to", 
          " ", "have", " ", "faucet", " ", "regulator"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"k", "=", "1"}], ",", 
          RowBox[{"k", "\[LessEqual]", "lenDirection"}], ",", 
          RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"detectedFaucetRegulator", "=", 
            RowBox[{"checkFaucetRegulator", "[", 
             RowBox[{"commonStartVertices", "[", 
              RowBox[{"[", "k", "]"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{"detectedFaucetRegulator", ",", 
             RowBox[{"Break", "[", "]"}]}], "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"!", "detectedFaucetRegulator"}], "&&", 
           RowBox[{"detectedStreamToStation", "\[Equal]", "0"}], "&&", 
           RowBox[{"numCommonStartVertices", "==", "2"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"k", "=", "1"}], ",", 
             RowBox[{"k", "\[LessEqual]", "numDirections"}], ",", 
             RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"commonStartPointLocal", "=", 
               RowBox[{"commonTotalStartPoint", "[", 
                RowBox[{"[", "k", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
              
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Sort", "[", "commonStartPointLocal", "]"}], 
                 "\[Equal]", 
                 RowBox[{"Sort", "[", "commonStartVertices", "]"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{"k", ",", "\"\<Q\>\""}], "]"}], ">", "0"}], "&&", 
                    
                    RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{"m", ",", "\"\<Q\>\""}], "]"}], "<", "0"}], "&&", 
                    
                    RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{
                    RowBox[{"commonStartVertices", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", "\"\<Q\>\""}], "]"}],
                     "<", "0"}]}], ",", "\[IndentingNewLine]", 
                   RowBox[{"(*", 
                    RowBox[{
                    RowBox[{
                    "Print", "[", "\"\<detected parallel tubes\>\"", "]"}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{"Print", "[", 
                    RowBox[{"\"\<direction-\>\"", ",", "m"}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    "Print", "[", "\"\<previous direction Q available\>\"", 
                    "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{"m", ",", "\"\<Q\>\""}], "]"}], "=", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{"k", ",", "\"\<Q\>\""}], "]"}], "/", "2"}], "//", 
                    "N"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"totalData", "[", 
                    RowBox[{
                    RowBox[{"commonStartVertices", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", "\"\<Q\>\""}], "]"}],
                     "=", 
                    RowBox[{"totalData", "[", 
                    RowBox[{"m", ",", "\"\<Q\>\""}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{"Print", "[", 
                    RowBox[{"\"\<1st stream direction: \>\"", ",", 
                    RowBox[{"commonStartVertices", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Print", "[", 
                    RowBox[{"\"\<Q value for 1st stream: \>\"", ",", " ", 
                    RowBox[{"totalData", "[", 
                    RowBox[{
                    RowBox[{"commonStartVertices", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", "\"\<Q\>\""}], 
                    "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"Print", "[", 
                    RowBox[{"\"\<2d stream direction: \>\"", ",", "m"}], 
                    "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"Print", "[", 
                    RowBox[{"\"\<Q value for 2d stream: \>\"", ",", " ", 
                    RowBox[{"totalData", "[", 
                    RowBox[{"m", ",", "\"\<Q\>\""}], "]"}]}], "]"}], ";"}], 
                    "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"calculatedDirections", "=", 
                    RowBox[{"Insert", "[", 
                    RowBox[{"calculatedDirections", ",", "m", ",", 
                    RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"calculatedDirections", "=", 
                    RowBox[{"Insert", "[", 
                    RowBox[{"calculatedDirections", ",", 
                    RowBox[{"commonStartVertices", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"writeDataToDataInfo", "[", 
                    RowBox[{"m", ",", 
                    RowBox[{"{", "5", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"totalData", "[", 
                    RowBox[{"m", ",", "\"\<Q\>\""}], "]"}], "}"}]}], "]"}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{"writeDataToDataInfo", "[", 
                    RowBox[{
                    RowBox[{"commonStartVertices", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"{", "5", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"totalData", "[", 
                    RowBox[{
                    RowBox[{"commonStartVertices", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", "\"\<Q\>\""}], "]"}],
                     "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"detected", "=", "True"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Break", "[", "]"}], ";"}]}], 
                  "\[IndentingNewLine]", "]"}], ";"}]}], 
               "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
            "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "detect", " ", "parallel", " ", "tubes", " ", "to", " ", "split", 
          " ", "gas", " ", "stream", " ", "equally"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"**", "**", "**", "END"}], "*******)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "detected", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"splitStream", 
      RowBox[{"(*", 
       RowBox[{"[", "7", "]"}], "*)"}], "[", 
      RowBox[{"gamma_", ",", "Q_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "alpha", ",", "bigStream", ",", " ", "smallStream", ",", "fraction"}],
         "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"alpha", "=", 
         RowBox[{"2", "*", 
          RowBox[{"ArcCos", "[", 
           RowBox[{"1", "-", 
            RowBox[{"gamma", "/", "45"}]}], "]"}], "*", 
          RowBox[{"180", "/", "Pi"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"fraction", "=", 
         RowBox[{"1", "-", 
          RowBox[{
           RowBox[{"1", "/", 
            RowBox[{"(", 
             RowBox[{"2", "*", "Pi"}], ")"}]}], "*", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Pi", "*", 
              RowBox[{"alpha", "/", "180"}]}], "-", 
             RowBox[{"Sin", "[", 
              RowBox[{"alpha", "*", 
               RowBox[{"Pi", "/", "180"}]}], "]"}]}], ")"}]}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"smallStream", "=", 
         RowBox[{
          RowBox[{"fraction", "*", 
           RowBox[{"Q", "/", "2"}]}], "//", "N"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"bigStream", "=", 
         RowBox[{"Q", "-", "smallStream"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"{", 
          RowBox[{"bigStream", ",", "smallStream"}], "}"}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", 
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**"}], "******)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"checkStreamToStation", "[", "m_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"detectedCS", "=", "0"}], ",", "k", ",", "l", ",", 
         RowBox[{"numCS", "=", 
          RowBox[{"Length", "[", "ksIds", "]"}]}], ",", "nextDirection", ",", 
         "commonStartPointLocal", ",", "numCommonStartPoint"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"commonStartPointLocal", "=", 
         RowBox[{"commonTotalStartPoint", "[", 
          RowBox[{"[", "m", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"numCommonStartPoint", "=", 
         RowBox[{"Length", "[", "commonStartPointLocal", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"k", "=", "1"}], ",", 
          RowBox[{"k", "\[LessEqual]", "numCommonStartPoint"}], ",", 
          RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"nextDirection", "=", 
            RowBox[{"commonStartPointLocal", "[", 
             RowBox[{"[", "k", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"l", "=", "1"}], ",", 
             RowBox[{"l", "\[LessEqual]", "numCS"}], ",", 
             RowBox[{"l", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"directions", "[", 
                  RowBox[{"[", 
                   RowBox[{"nextDirection", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"directions", "[", 
                    RowBox[{"[", "nextDirection", "]"}], "]"}], "]"}]}], 
                   "]"}], "]"}], "\[Equal]", 
                 RowBox[{"ksIds", "[", 
                  RowBox[{"[", 
                   RowBox[{"l", ",", "1"}], "]"}], "]"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"detectedCS", "=", "l"}], ";", "\[IndentingNewLine]", 
                 RowBox[{"Break", "[", "]"}], ";"}]}], "\[IndentingNewLine]", 
               "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{"detectedCS", ",", 
             RowBox[{"Break", "[", "]"}]}], "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "detectedCS", "]"}]}]}], "\[IndentingNewLine]",
       "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", 
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**"}], "******)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"checkFaucetRegulator", "[", "m_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"detected", "=", "False"}], ",", "k", ",", "lenDirection"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"lenDirection", "=", 
         RowBox[{"Length", "[", 
          RowBox[{"directions", "[", 
           RowBox[{"[", "m", "]"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"k", "=", "1"}], ",", 
          RowBox[{"k", "\[LessEqual]", "lenDirection"}], ",", 
          RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"directions", "[", 
               RowBox[{"[", 
                RowBox[{"m", ",", "k"}], "]"}], "]"}], ">", "1000"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"detected", "=", "True"}], ";", "\[IndentingNewLine]", 
              RowBox[{"Break", "[", "]"}], ";"}]}], "\[IndentingNewLine]", 
            "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "detected", "]"}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", 
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**"}], "******)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"checkStationFullLoad", "[", "m_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "s", ",", "k", ",", "l", ",", "count", ",", "commonLastVerticesLocal",
          ",", 
         RowBox[{"detected", "=", "False"}], ",", "numCommonLastVertices", 
         ",", 
         RowBox[{"detectedCS", "=", "0"}], ",", 
         RowBox[{"numCS", "=", 
          RowBox[{"Length", "[", "ksIds", "]"}]}], ",", "nextDirection"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"detectedCS", "=", 
         RowBox[{"checkStreamToStation", "[", "m", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"detectedCS", ">", "0"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"count", "=", "0"}], ";", "\[IndentingNewLine]", 
           RowBox[{"commonLastVerticesLocal", "=", 
            RowBox[{"commonTotalLastVertices", "[", 
             RowBox[{"[", "m", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"numCommonLastVertices", "=", 
            RowBox[{"Length", "[", "commonLastVerticesLocal", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"s", "=", "2"}], ",", 
             RowBox[{"s", "<=", "numCommonLastVertices"}], ",", 
             RowBox[{"s", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"totalData", "[", 
                  RowBox[{
                   RowBox[{"commonLastVerticesLocal", "[", 
                    RowBox[{"[", "s", "]"}], "]"}], ",", "\"\<Q\>\""}], "]"}],
                  "\[GreaterEqual]", "0"}], ",", "\[IndentingNewLine]", 
                RowBox[{"count", "++"}]}], "\[IndentingNewLine]", "]"}], 
              ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"count", "\[Equal]", 
               RowBox[{"numCommonLastVertices", "-", "1"}]}], "&&", 
              RowBox[{
               RowBox[{
                RowBox[{"Sum", "[", 
                 RowBox[{
                  RowBox[{"totalData", "[", 
                   RowBox[{
                    RowBox[{"commonLastVerticesLocal", "[", 
                    RowBox[{"[", "ss", "]"}], "]"}], ",", "\"\<Q\>\""}], 
                   "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"ss", ",", "numCommonLastVertices"}], "}"}]}], 
                 "]"}], "+", "1"}], "<", 
               RowBox[{"ksIds", "[", 
                RowBox[{"[", 
                 RowBox[{"detectedCS", ",", "3"}], "]"}], "]"}]}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"totalData", "[", 
                RowBox[{"m", ",", "\"\<Q\>\""}], "]"}], "=", 
               RowBox[{
                RowBox[{"ksIds", "[", 
                 RowBox[{"[", 
                  RowBox[{"detectedCS", ",", "3"}], "]"}], "]"}], "-", 
                RowBox[{"Sum", "[", 
                 RowBox[{
                  RowBox[{"totalData", "[", 
                   RowBox[{
                    RowBox[{"commonLastVerticesLocal", "[", 
                    RowBox[{"[", "ss", "]"}], "]"}], ",", "\"\<Q\>\""}], 
                   "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"ss", ",", "numCommonLastVertices"}], "}"}]}], 
                 "]"}], "-", "1"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"calculatedDirections", "=", 
               RowBox[{"Insert", "[", 
                RowBox[{"calculatedDirections", ",", "m", ",", 
                 RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"writeDataToDataInfo", "[", 
               RowBox[{"m", ",", 
                RowBox[{"{", "5", "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"totalData", "[", 
                  RowBox[{"m", ",", "\"\<Q\>\""}], "]"}], "}"}]}], "]"}], ";",
               "\[IndentingNewLine]", 
              RowBox[{"detected", "=", "True"}], ";", "\[IndentingNewLine]", 
              RowBox[{"Break", "[", "]"}], ";"}]}], "\[IndentingNewLine]", 
            "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "detected", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", 
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**"}], "******)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"forwardProcedure", "[", 
      RowBox[{
      "distance_", ",", "diam_", ",", "kLCoef_", ",", "TSoilValue_", ",", 
       "Q_", ",", 
       RowBox[{"(*", 
        RowBox[{"gas", " ", "properties"}], "*)"}], "rhon_", ",", "Mmolar_", 
       ",", "Rspecific_", ",", "p1_", ",", "T1_", ",", "CO2_", ",", "hs_", 
       ",", "H2_", ",", "roughness_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "p2", ",", "T2", ",", "S", ",", "Reyn", ",", "f", ",", "cp", ",", 
         "beta", ",", "V", ",", "M", ",", "JouleThomsonCoef", ",", "Kcoef", 
         ",", "Zcurrent"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Set", " ", "data"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"S", "=", 
         RowBox[{"Pi", "*", 
          RowBox[{
           RowBox[{"diam", "^", "2"}], "/", "4"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"M", "=", 
         RowBox[{"Q", "*", "rhon"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Zcurrent", "=", 
         RowBox[{"calculateZ", 
          RowBox[{"(*", 
           RowBox[{"[", "9", "]"}], "*)"}], "[", 
          RowBox[{"rhon", ",", 
           RowBox[{"p1", "*", 
            RowBox[{"10", "^", 
             RowBox[{"(", 
              RowBox[{"-", "6"}], ")"}]}]}], ",", "T1", ",", "Rspecific"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Zcurrent", "=", 
           RowBox[{"SGERG", "[", 
            RowBox[{"CO2", ",", "hs", ",", "H2", ",", 
             RowBox[{"p1", "*", 
              RowBox[{"10", "^", 
               RowBox[{"(", 
                RowBox[{"-", "5"}], ")"}]}]}], ",", 
             RowBox[{"T1", "-", "273.15"}], ",", "rhon", ",", "1"}], "]"}]}], 
          " ", ";"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Reyn", "=", 
         RowBox[{"calculateReynolds", 
          RowBox[{"(*", 
           RowBox[{"[", "8", "]"}], "*)"}], "[", 
          RowBox[{"rhon", ",", 
           RowBox[{"p1", "*", 
            RowBox[{"10", "^", 
             RowBox[{"(", 
              RowBox[{"-", "6"}], ")"}]}]}], ",", "T1", ",", "Rspecific", ",",
            "Q", ",", "diam"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"f", "=", 
         RowBox[{"calculateFanningFrictionFactor", "[", 
          RowBox[{"Reyn", ",", "roughness", ",", "diam"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"cp", "=", 
         RowBox[{"calculateCp", "[", 
          RowBox[{"rhon", ",", 
           RowBox[{"p1", "*", 
            RowBox[{"10", "^", 
             RowBox[{"(", 
              RowBox[{"-", "6"}], ")"}]}]}], ",", "T1", ",", "Rspecific"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"beta", "=", 
         RowBox[{"kLCoef", "/", 
          RowBox[{"(", 
           RowBox[{"cp", "*", "M"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"T2", "=", 
         RowBox[{"TSoilValue", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"T1", "-", "TSoilValue"}], ")"}], "*", 
           RowBox[{"Exp", "[", 
            RowBox[{
             RowBox[{"-", "beta"}], "*", "distance"}], "]"}]}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Kcoef", "=", 
         RowBox[{"Zcurrent", "*", 
          RowBox[{"Rspecific", "/", 
           RowBox[{"S", "^", "2"}]}], "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"4", "*", 
             RowBox[{"f", "/", "diam"}], "*", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"TSoilValue", "*", "distance"}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"T1", "-", "TSoilValue"}], ")"}], "/", "beta"}], "-", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"T1", "-", "TSoilValue"}], ")"}], "/", "beta"}], 
                "*", 
                RowBox[{"Exp", "[", 
                 RowBox[{
                  RowBox[{"-", "beta"}], "*", "distance"}], "]"}]}]}], 
              ")"}]}], "-", 
            RowBox[{"2", "*", 
             RowBox[{"(", 
              RowBox[{"T1", "-", "T2"}], ")"}]}]}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"p2", "=", 
         RowBox[{
          RowBox[{"Sqrt", "[", 
           RowBox[{
            RowBox[{"p1", "^", "2"}], "-", 
            RowBox[{"Kcoef", "*", 
             RowBox[{"M", "^", "2"}]}]}], "]"}], "//", "N"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"{", 
          RowBox[{"p2", ",", "T2"}], "}"}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.844301030216963*^9, 3.844301459621871*^9}, {
   3.844301653392332*^9, 3.8443016675874662`*^9}, {3.844302142051642*^9, 
   3.844302153818379*^9}, {3.844302231802095*^9, 3.8443022339743633`*^9}, {
   3.85065059690524*^9, 3.850650628540502*^9}, {3.850652772655059*^9, 
   3.850652773658661*^9}, {3.850652808197589*^9, 3.850652809031773*^9}, 
   3.8506562264674807`*^9, {3.850739366694963*^9, 3.850739367073865*^9}, {
   3.85440535957613*^9, 3.854405434843298*^9}, {3.8544054743120947`*^9, 
   3.854405626022084*^9}, {3.8544057775927896`*^9, 3.85440605934652*^9}, {
   3.8544061722495728`*^9, 3.854406286512548*^9}, {3.854406379551087*^9, 
   3.854406535147407*^9}, {3.854406580017994*^9, 3.854406585872776*^9}, {
   3.854406732758593*^9, 3.8544067338048964`*^9}, {3.8544074116714907`*^9, 
   3.854407432970388*^9}, {3.8544078214055967`*^9, 3.854407831016*^9}, {
   3.8544080047446127`*^9, 3.85440806398973*^9}, {3.8544110450053587`*^9, 
   3.8544111579776287`*^9}, {3.854411193252489*^9, 3.8544112363052397`*^9}, {
   3.854411308179736*^9, 3.854411369881238*^9}, {3.854411457299429*^9, 
   3.854411498707567*^9}, {3.8544115386991158`*^9, 3.854411896613909*^9}, {
   3.854411930897047*^9, 3.854411977233452*^9}, {3.8544120447242727`*^9, 
   3.854412045131937*^9}, {3.854412121539112*^9, 3.854412133192136*^9}, 
   3.85441232374492*^9, {3.854681980709074*^9, 3.854681981422544*^9}, {
   3.854682012803069*^9, 3.854682057962758*^9}, 3.854682093659693*^9, {
   3.854682619383943*^9, 3.8546826205328083`*^9}, {3.854682712074712*^9, 
   3.854682712569284*^9}, {3.8546827438484297`*^9, 3.8546828122117558`*^9}, {
   3.8546830400953407`*^9, 3.854683100186597*^9}, {3.854683144339985*^9, 
   3.854683182711131*^9}, {3.854683972072763*^9, 3.854683973709793*^9}, {
   3.854684124629043*^9, 3.8546841407602863`*^9}, {3.854684273144763*^9, 
   3.8546843991564503`*^9}, {3.8546853592144136`*^9, 
   3.8546853747119207`*^9}, {3.854686239719728*^9, 3.8546862748442*^9}, {
   3.854686323369358*^9, 3.854686327153007*^9}, {3.854686376938984*^9, 
   3.85468638502931*^9}, {3.85468645495592*^9, 3.854686456519495*^9}, {
   3.854686973111412*^9, 3.854686974669692*^9}, {3.854687054332877*^9, 
   3.854687060067134*^9}, {3.8546871375698137`*^9, 3.8546871586382847`*^9}, {
   3.854687205124083*^9, 3.854687205511366*^9}, {3.854687384278184*^9, 
   3.854687397192172*^9}, {3.8546874291914454`*^9, 3.854687450086689*^9}, {
   3.854690186071875*^9, 3.854690187606947*^9}, {3.8546902643456593`*^9, 
   3.854690280322281*^9}, {3.854690747337398*^9, 3.8546907488201714`*^9}, {
   3.854691063526143*^9, 3.85469107653004*^9}, {3.854691437608219*^9, 
   3.8546914458371153`*^9}, {3.8547116595334053`*^9, 3.854711696791366*^9}, {
   3.854711808138336*^9, 3.8547118616396923`*^9}, {3.854712090695487*^9, 
   3.854712091000827*^9}, 3.854712125277587*^9, {3.854712237679554*^9, 
   3.8547123044540586`*^9}, {3.854712412182953*^9, 3.854712585660697*^9}, {
   3.854712714869236*^9, 3.8547127533462477`*^9}, {3.8547128136529207`*^9, 
   3.854712855540949*^9}, {3.854712886112153*^9, 3.854712889954905*^9}, {
   3.854712949407312*^9, 3.8547129778729753`*^9}, 3.854713034997758*^9, 
   3.85471310802913*^9, {3.854713712645834*^9, 3.854713753650779*^9}, {
   3.854713789581697*^9, 3.8547140120417757`*^9}, {3.854714672880787*^9, 
   3.854714689023993*^9}, 3.854714777157576*^9, {3.854714963090672*^9, 
   3.854714987037239*^9}, {3.854715096008129*^9, 3.8547151436310797`*^9}, {
   3.854715184276884*^9, 3.8547152172473383`*^9}, {3.854715302015184*^9, 
   3.854715311875731*^9}, {3.8547153446781282`*^9, 3.854715345120222*^9}, {
   3.8547153837845793`*^9, 3.854715457402726*^9}, {3.8547162894210176`*^9, 
   3.854716301555221*^9}, {3.854781246938787*^9, 3.854781251053689*^9}, {
   3.854781345742187*^9, 3.854781352649727*^9}, 3.854783435579916*^9, {
   3.854783518773425*^9, 3.854783519954913*^9}, {3.854849475914605*^9, 
   3.854849483966035*^9}, 3.8548501413001137`*^9, {3.854850522814412*^9, 
   3.8548505232002153`*^9}, {3.8548506560383863`*^9, 3.854850656400333*^9}, {
   3.854851026902473*^9, 3.854851027341463*^9}, {3.854851126759778*^9, 
   3.854851127137506*^9}, {3.854851202827841*^9, 3.854851217840962*^9}, {
   3.8548514651363983`*^9, 3.854851481412012*^9}, {3.8548519094745197`*^9, 
   3.854851909936582*^9}, {3.854880444544751*^9, 3.854880444926921*^9}, {
   3.854880610101099*^9, 3.854880610395651*^9}, {3.854880651370489*^9, 
   3.854880652329624*^9}, {3.854880682700284*^9, 3.854880682988433*^9}, {
   3.854880771366261*^9, 3.854880771720666*^9}, {3.854880845269113*^9, 
   3.854880845962475*^9}, {3.854880881428747*^9, 3.8548809226251907`*^9}, {
   3.8548811570694647`*^9, 3.854881173958109*^9}, {3.854882000530143*^9, 
   3.854882001032207*^9}, {3.854884563547015*^9, 3.8548845710541677`*^9}, {
   3.854885614760005*^9, 3.854885661752727*^9}, {3.854885714531826*^9, 
   3.854885732549642*^9}, {3.8548857909476767`*^9, 3.854885809075644*^9}, {
   3.854885839397562*^9, 3.854885840029984*^9}, {3.854886530399356*^9, 
   3.854886550693851*^9}, {3.8548869432628527`*^9, 3.854886944128002*^9}, {
   3.854886996178473*^9, 3.854887072452106*^9}, {3.854887188633676*^9, 
   3.85488727730832*^9}, {3.854887321872641*^9, 3.854887327077032*^9}, {
   3.854887392921393*^9, 3.85488741587073*^9}, {3.854936961524578*^9, 
   3.85493696184907*^9}, 3.8549370068781767`*^9, {3.8549370945945177`*^9, 
   3.854937195846792*^9}, {3.854937283551252*^9, 3.8549372985540867`*^9}, {
   3.854940399043853*^9, 3.854940418908814*^9}, {3.854940605878166*^9, 
   3.854940610720964*^9}, {3.854956812424203*^9, 3.854956825355339*^9}, {
   3.854972092964396*^9, 3.854972099863659*^9}, {3.8549722436056137`*^9, 
   3.854972273534685*^9}, {3.854972422183898*^9, 3.854972566566319*^9}, {
   3.8549729923811407`*^9, 3.854973053245429*^9}, {3.854973114752328*^9, 
   3.854973140054694*^9}, {3.854973179989028*^9, 3.854973316109791*^9}, {
   3.854973427907515*^9, 3.8549734405205584`*^9}, {3.855024070152286*^9, 
   3.855024077522664*^9}, {3.855024112919911*^9, 3.8550241285888863`*^9}, {
   3.855034174603668*^9, 3.855034210568791*^9}, {3.8550342624928207`*^9, 
   3.85503426647051*^9}, {3.855034368726523*^9, 3.855034470155752*^9}, {
   3.855034639453755*^9, 3.855034660128104*^9}, {3.855034695557406*^9, 
   3.855034704005522*^9}, 3.8550348756571617`*^9, {3.855035011690463*^9, 
   3.85503501213912*^9}, {3.855035044922871*^9, 3.855035045683288*^9}, {
   3.855035076650773*^9, 3.855035170410828*^9}, {3.8550352004416933`*^9, 
   3.855035333278058*^9}, {3.855035425396892*^9, 3.855035457187641*^9}, {
   3.855035915739931*^9, 3.855036043061378*^9}, {3.855036157312944*^9, 
   3.855036175996356*^9}, {3.855036274864118*^9, 3.8550362768615932`*^9}, {
   3.855036334052018*^9, 3.855036339362615*^9}, {3.85503641213551*^9, 
   3.855036415518034*^9}, {3.8550366986932163`*^9, 3.85503670241236*^9}, {
   3.855058769105645*^9, 3.855058786612443*^9}, {3.855058865449679*^9, 
   3.855058900638214*^9}, {3.855058935022134*^9, 3.855058945831465*^9}, {
   3.855059261348454*^9, 3.855059263491572*^9}, {3.855059300731574*^9, 
   3.855059347410871*^9}, {3.8550593797149153`*^9, 3.855059383239019*^9}, {
   3.855059432818185*^9, 3.855059483810005*^9}, {3.855059998848138*^9, 
   3.855060046709566*^9}, {3.85506042461357*^9, 3.855060527609756*^9}, {
   3.855060648294915*^9, 3.855060757773108*^9}, {3.8550607879211397`*^9, 
   3.85506100122613*^9}, {3.8550610905305567`*^9, 3.855061128637195*^9}, {
   3.855061277998641*^9, 3.8550612788679237`*^9}, {3.8550622595109997`*^9, 
   3.855062292295204*^9}, {3.8550623878821487`*^9, 3.855062391819599*^9}, {
   3.85506327999936*^9, 3.855063509243183*^9}, {3.855063582023786*^9, 
   3.855063583104556*^9}, {3.855063639025766*^9, 3.855063716587731*^9}, {
   3.855063795250618*^9, 3.855063852028973*^9}, {3.85506391253695*^9, 
   3.85506403404379*^9}, {3.855064110962606*^9, 3.8550641327660418`*^9}, {
   3.855100111513048*^9, 3.8551001217833977`*^9}, {3.855101021345109*^9, 
   3.8551010362980413`*^9}, {3.8551010733730917`*^9, 3.855101115710445*^9}, {
   3.8551011518558483`*^9, 3.855101202356303*^9}, {3.855101247227944*^9, 
   3.8551012633481216`*^9}, {3.855101410511571*^9, 3.8551014438155117`*^9}, {
   3.855101579458902*^9, 3.8551016087413797`*^9}, {3.855101722104929*^9, 
   3.8551017521437597`*^9}, {3.85510179056455*^9, 3.855101872311181*^9}, {
   3.855101920590228*^9, 3.855101927447248*^9}, {3.855102147668253*^9, 
   3.8551021987150793`*^9}, {3.85510223175959*^9, 3.855102459657392*^9}, {
   3.855102494541494*^9, 3.855102526645506*^9}, {3.855102574127392*^9, 
   3.85510257987643*^9}, {3.855102631115484*^9, 3.855102653923291*^9}, {
   3.855102782315469*^9, 3.855102817073922*^9}, {3.855103476450375*^9, 
   3.855103480283885*^9}, {3.85510357431741*^9, 3.85510362344013*^9}, {
   3.855103697595965*^9, 3.8551037512133627`*^9}, {3.855103784487578*^9, 
   3.855103819586083*^9}, {3.8551038924265957`*^9, 3.8551040613584557`*^9}, {
   3.855104135117037*^9, 3.8551041356821623`*^9}, {3.8551041826584597`*^9, 
   3.855104248072196*^9}, {3.85510430713443*^9, 3.855104355344665*^9}, {
   3.855104395630753*^9, 3.8551045019868317`*^9}, {3.855104599785718*^9, 
   3.8551046557283154`*^9}, {3.8551047822921124`*^9, 3.855104827175393*^9}, {
   3.855104866943569*^9, 3.855104868911395*^9}, {3.855104967378511*^9, 
   3.855105012396803*^9}, 3.8551051700076857`*^9, {3.855105237202026*^9, 
   3.8551052406334763`*^9}, {3.855105278283392*^9, 3.8551052838274117`*^9}, {
   3.855105318133919*^9, 3.8551054439472027`*^9}, {3.855106609737709*^9, 
   3.855106710534878*^9}, {3.855106892618868*^9, 3.855106924166053*^9}, {
   3.855107023137188*^9, 3.855107033083714*^9}, 3.855115852645097*^9, {
   3.855116199019414*^9, 3.855116218074134*^9}, 3.855116432098319*^9, 
   3.855121066797777*^9, {3.8551217911451693`*^9, 3.8551218220386877`*^9}, {
   3.855121929135829*^9, 3.855121960534528*^9}, {3.855124650635552*^9, 
   3.8551246617007513`*^9}, {3.855124772375699*^9, 3.855124782692182*^9}, 
   3.855124846437751*^9, {3.8551248925822763`*^9, 3.855124907490471*^9}, {
   3.8551249932451887`*^9, 3.8551250010821533`*^9}, {3.8551250652419243`*^9, 
   3.855125087419894*^9}, {3.8551251323228407`*^9, 3.855125133455344*^9}, 
   3.855125321730235*^9, {3.855126422799637*^9, 3.855126423060554*^9}, {
   3.855127255581162*^9, 3.855127256626292*^9}, {3.855129830536983*^9, 
   3.855129919876943*^9}, {3.855130031989223*^9, 3.855130037332561*^9}, 
   3.855130268122211*^9, {3.855130882603526*^9, 3.855130882813828*^9}, {
   3.8552734225709867`*^9, 3.855273428656583*^9}, 3.8552737737692537`*^9, {
   3.85527392104799*^9, 3.8552739213842907`*^9}, {3.8552740715579653`*^9, 
   3.855274076271028*^9}, {3.855274942518157*^9, 3.8552749623417807`*^9}, {
   3.85527512018132*^9, 3.855275120394286*^9}, {3.855275240380535*^9, 
   3.855275244668581*^9}, {3.85527611884687*^9, 3.8552761451923656`*^9}, {
   3.855278160612568*^9, 3.855278167635577*^9}, {3.8552783301544123`*^9, 
   3.855278407196154*^9}, {3.855295610839752*^9, 3.8552956209044237`*^9}, {
   3.855295747047317*^9, 3.855295779531238*^9}, {3.855295826747756*^9, 
   3.855295917162333*^9}, {3.8552959472085533`*^9, 3.855295958765527*^9}, {
   3.8552959986201*^9, 3.855296020258643*^9}, {3.855296055375629*^9, 
   3.855296058723667*^9}, {3.855316734310034*^9, 3.855316734601873*^9}, {
   3.8553167787254744`*^9, 3.855316779112934*^9}, {3.85531682297817*^9, 
   3.855316841943869*^9}, {3.855317155936*^9, 3.855317168681531*^9}, {
   3.8553174615194683`*^9, 3.8553174669864693`*^9}, {3.8553179400510683`*^9, 
   3.855317940536159*^9}, {3.855317994437333*^9, 3.855318002397956*^9}, {
   3.8553181469123096`*^9, 3.8553182058282423`*^9}, {3.855318312112473*^9, 
   3.855318334490343*^9}, {3.855318428508724*^9, 3.855318445651052*^9}, {
   3.855318484584827*^9, 3.855318492862952*^9}, {3.8553185633618097`*^9, 
   3.855318564227148*^9}, {3.8553186072580433`*^9, 3.855318692756619*^9}, {
   3.8553188397249317`*^9, 3.8553188957430763`*^9}, {3.8553189456209373`*^9, 
   3.855318955234332*^9}, 3.8553201118180227`*^9, {3.8553213276843653`*^9, 
   3.855321332552853*^9}, {3.8553241324410257`*^9, 3.855324180451992*^9}, 
   3.855355493162472*^9, {3.855356277940199*^9, 3.855356298675818*^9}, {
   3.8553596702187347`*^9, 3.855359680456646*^9}, {3.8553786791581497`*^9, 
   3.855378688706521*^9}, {3.855382722330674*^9, 3.855382860003661*^9}, {
   3.855383329333397*^9, 3.855383378518725*^9}, {3.8553838919049587`*^9, 
   3.855384022761484*^9}, {3.855404224617279*^9, 3.855404353415875*^9}, {
   3.8554044394288797`*^9, 3.8554044696414623`*^9}, {3.8554051962332983`*^9, 
   3.855405201997848*^9}, {3.855406311532298*^9, 3.8554063129898243`*^9}, {
   3.8554069068211946`*^9, 3.855406911562422*^9}, {3.855408189871387*^9, 
   3.855408196997981*^9}, 3.855409283786666*^9, {3.855409334693042*^9, 
   3.855409351133946*^9}, {3.855409648589571*^9, 3.855409698688569*^9}, {
   3.855409737675804*^9, 3.85540975667065*^9}, {3.8554099731402473`*^9, 
   3.8554099750632133`*^9}, {3.8554102940478897`*^9, 3.855410299441038*^9}, {
   3.855411018777753*^9, 3.85541105565869*^9}, {3.855474633921815*^9, 
   3.855474641169527*^9}, {3.8554876949933777`*^9, 3.855487746150983*^9}, {
   3.855488063099729*^9, 3.855488127975787*^9}, 3.855489930773211*^9, 
   3.855490769498474*^9, {3.855491137778841*^9, 3.855491162013947*^9}, {
   3.855491257147089*^9, 3.855491265063205*^9}, 3.855491454138117*^9, {
   3.8554916036766768`*^9, 3.8554916148494368`*^9}, {3.8554925950482616`*^9, 
   3.8554925971423388`*^9}, {3.855494791163097*^9, 3.855494794075598*^9}, {
   3.855494936424749*^9, 3.855494937084743*^9}, 3.8554950145516644`*^9, {
   3.8554960678474007`*^9, 3.855496073548897*^9}, {3.85553178823322*^9, 
   3.855531789929819*^9}, {3.855533957472704*^9, 3.85553395961872*^9}, {
   3.855534445247386*^9, 3.855534447026658*^9}, {3.85553547453465*^9, 
   3.855535510692828*^9}, {3.8555358660877666`*^9, 3.855535948962785*^9}, {
   3.85553597917316*^9, 3.855535988068576*^9}, {3.855536022462899*^9, 
   3.855536057734664*^9}, {3.8555363340158854`*^9, 3.855536334431295*^9}, {
   3.855536392921605*^9, 3.855536399214592*^9}, {3.855536509229567*^9, 
   3.855536511311253*^9}, {3.855536588056922*^9, 3.8555366035582743`*^9}, {
   3.855536710559331*^9, 3.85553671197316*^9}, 3.855536753845838*^9, {
   3.855537016636015*^9, 3.855537060608127*^9}, {3.855538455476735*^9, 
   3.85553846094792*^9}, {3.855538497907013*^9, 3.855538501989105*^9}, {
   3.855538694995284*^9, 3.855538752747396*^9}, 3.855539512057033*^9, {
   3.855539678140437*^9, 3.855539685363573*^9}, {3.85553979318847*^9, 
   3.855539795249404*^9}, {3.8555404348791733`*^9, 3.8555404443164797`*^9}, {
   3.8555405944443817`*^9, 3.8555406002063293`*^9}, {3.855540796314834*^9, 
   3.855540804540811*^9}, {3.8555418262140827`*^9, 3.855541830672749*^9}, {
   3.8555420044197702`*^9, 3.855542009046331*^9}, {3.85554229631553*^9, 
   3.85554229756866*^9}, {3.855542751182419*^9, 3.855542755038919*^9}, {
   3.8555450188709307`*^9, 3.855545092437167*^9}, {3.855546007408824*^9, 
   3.855546124572761*^9}, {3.855546250567981*^9, 3.855546303080995*^9}, {
   3.8555463572837143`*^9, 3.855546429546914*^9}, {3.855546746213217*^9, 
   3.855546761740986*^9}, {3.855547027261187*^9, 3.855547038083465*^9}, 
   3.855547260901512*^9, 3.8555473050156813`*^9, {3.855559920141809*^9, 
   3.855559980556068*^9}, {3.855561715635684*^9, 3.85556176068641*^9}, 
   3.855562902111548*^9, 3.855574665838238*^9, {3.855615291742302*^9, 
   3.855615325623843*^9}, 3.8556153612432203`*^9, {3.855615557494134*^9, 
   3.8556155824106913`*^9}, {3.8556156788731813`*^9, 3.85561568981083*^9}, {
   3.855615765648778*^9, 3.8556157671185827`*^9}, {3.855615871706065*^9, 
   3.8556158719821033`*^9}, {3.855616036085287*^9, 3.8556161933160267`*^9}, {
   3.855616245517577*^9, 3.8556163769273653`*^9}, {3.855616453975863*^9, 
   3.855616506992337*^9}, {3.855616587710908*^9, 3.855616655034267*^9}, {
   3.8556372851866302`*^9, 3.855637311897156*^9}, {3.855637751662116*^9, 
   3.855637786660404*^9}, {3.855638060670773*^9, 3.8556381110127974`*^9}, {
   3.855638276466155*^9, 3.855638281849669*^9}, 3.8556384072178507`*^9, {
   3.855638439476063*^9, 3.855638441186989*^9}, {3.855638713408608*^9, 
   3.85563874992929*^9}, {3.8556478246804934`*^9, 3.85564783631329*^9}, {
   3.855648079680004*^9, 3.855648082961576*^9}, {3.8556481174967833`*^9, 
   3.8556481417676773`*^9}, {3.855648172044242*^9, 3.855648252109297*^9}, {
   3.855648297540244*^9, 3.8556484153704777`*^9}, {3.855648464424817*^9, 
   3.8556484802389174`*^9}, {3.855648525566763*^9, 3.855648526026038*^9}, {
   3.8556488245144987`*^9, 3.855648832835333*^9}, {3.8556488940900803`*^9, 
   3.855648900556561*^9}, {3.855649116002531*^9, 3.855649161700132*^9}, {
   3.8556492028795958`*^9, 3.855649203187312*^9}, {3.855649356928687*^9, 
   3.855649421417861*^9}, {3.855659344511129*^9, 3.85565934493943*^9}, {
   3.855659386558003*^9, 3.855659397188389*^9}, {3.855661142513356*^9, 
   3.8556612803090677`*^9}, {3.855661346343655*^9, 3.855661384777792*^9}, {
   3.855661495659274*^9, 3.855661567922373*^9}, {3.855662462703165*^9, 
   3.855662463173849*^9}, {3.8557100619956923`*^9, 3.855710123665626*^9}, {
   3.855710491799528*^9, 3.855710524482589*^9}, {3.8557105560719223`*^9, 
   3.855710839012783*^9}, {3.855710929977378*^9, 3.855710980641437*^9}, {
   3.8557110537832108`*^9, 3.8557110796925087`*^9}, {3.855711168431837*^9, 
   3.8557112453705807`*^9}, {3.8557113436127872`*^9, 3.855711348727696*^9}, {
   3.855711381539637*^9, 3.855711440201503*^9}, {3.8557114942616377`*^9, 
   3.855711547878173*^9}, {3.855711621072256*^9, 3.855711747381295*^9}, {
   3.8557117851705*^9, 3.85571180548665*^9}, {3.855711856821862*^9, 
   3.855711915038179*^9}, {3.855711946506761*^9, 3.8557120125985947`*^9}, {
   3.8557120439922047`*^9, 3.8557120626279497`*^9}, {3.855712104140275*^9, 
   3.855712132972739*^9}, {3.855712196009749*^9, 3.855712196582713*^9}, {
   3.855712241680725*^9, 3.8557122797725887`*^9}, {3.855712383282146*^9, 
   3.855712386001195*^9}, {3.855714625942724*^9, 3.855714642035211*^9}, {
   3.855714897862656*^9, 3.8557149075343723`*^9}, {3.855715144550708*^9, 
   3.855715160770286*^9}, {3.855715368142387*^9, 3.855715384330315*^9}, {
   3.855715567823206*^9, 3.855715569165489*^9}, {3.8557157288110533`*^9, 
   3.855715729486215*^9}, {3.855716131560913*^9, 3.855716131806734*^9}, {
   3.855728986051735*^9, 3.855728993011703*^9}, {3.855729080280632*^9, 
   3.855729085790988*^9}, {3.85572942661943*^9, 3.855729465100444*^9}, 
   3.855729554401623*^9, 3.855731317599875*^9, {3.8557317851637993`*^9, 
   3.855731793406644*^9}, {3.855731826396419*^9, 3.855731832056737*^9}, {
   3.855731905783925*^9, 3.855731915295929*^9}, 3.855734430110154*^9, {
   3.855734665991352*^9, 3.855734698783154*^9}, {3.8557348988645067`*^9, 
   3.8557349956769333`*^9}, {3.855735096635489*^9, 3.8557351337572203`*^9}, {
   3.855735183697557*^9, 3.85573523553612*^9}, {3.8557353694376287`*^9, 
   3.855735375432255*^9}, {3.85573572526086*^9, 3.85573592892426*^9}, {
   3.8557359640004168`*^9, 3.855735968146085*^9}, {3.8557360014041758`*^9, 
   3.85573601479854*^9}, {3.8557360792352543`*^9, 3.8557362112012043`*^9}, {
   3.8557362739375677`*^9, 3.855736274289247*^9}, {3.855736474299205*^9, 
   3.855736475060768*^9}, {3.8557491559423513`*^9, 3.855749207116458*^9}, {
   3.855749256788673*^9, 3.8557492718484373`*^9}, {3.855749325949367*^9, 
   3.8557493786952744`*^9}, {3.855749435962922*^9, 3.85574953705083*^9}, {
   3.855749624646214*^9, 3.8557496773674107`*^9}, {3.85575395053083*^9, 
   3.8557540436620703`*^9}, {3.855868462798053*^9, 3.855868782166224*^9}, {
   3.855869180203588*^9, 3.855869234531865*^9}, {3.8558694986892776`*^9, 
   3.85586949994776*^9}, {3.855869968675503*^9, 3.8558699741689777`*^9}, {
   3.855870096936564*^9, 3.855870104460335*^9}, {3.855870178501136*^9, 
   3.855870181805151*^9}, {3.855870251671032*^9, 3.855870284905613*^9}, {
   3.855870595196888*^9, 3.855870595912045*^9}, {3.8558706831067057`*^9, 
   3.855870777674137*^9}, {3.855871743664282*^9, 3.8558718033560266`*^9}, {
   3.856013136235216*^9, 3.856013153213316*^9}, {3.856081711281673*^9, 
   3.85608171626272*^9}, {3.856082304276105*^9, 3.856082306889675*^9}, {
   3.856082603421586*^9, 3.856082671416169*^9}, {3.856082708039398*^9, 
   3.856082732738716*^9}, {3.856082804236607*^9, 3.856082843991975*^9}, {
   3.856091629804368*^9, 3.85609163221349*^9}, {3.85648029756981*^9, 
   3.856480304730558*^9}, {3.856683519660359*^9, 3.856683545249341*^9}, {
   3.856683601498674*^9, 3.856683649265587*^9}, {3.856683682364008*^9, 
   3.856683743644767*^9}, {3.856684189641642*^9, 3.856684240569618*^9}, {
   3.8566845733100357`*^9, 3.856685144504325*^9}, {3.856685209204421*^9, 
   3.85668536327485*^9}, {3.8566854171835947`*^9, 3.8566855094661703`*^9}, {
   3.8566855454324303`*^9, 3.85668590848208*^9}, {3.8566859432218*^9, 
   3.856685943616379*^9}, {3.856685988833084*^9, 3.8566860659189377`*^9}, {
   3.856686222998597*^9, 3.856686229522258*^9}, {3.857366557512169*^9, 
   3.857366614614468*^9}, {3.857366654822186*^9, 3.857366657234324*^9}, 
   3.857384546455752*^9, {3.8573848034896584`*^9, 3.8573848173475533`*^9}, {
   3.857384852406868*^9, 3.857384873066366*^9}, {3.857385231347693*^9, 
   3.8573852694885397`*^9}, {3.8573855189873667`*^9, 
   3.857385519188966*^9}},ExpressionUUID->"a788c37d-0db0-4be2-bf7d-\
ae9035ab4fb8"]
},
WindowSize->{1389.75, 768.75},
WindowMargins->{{0, Automatic}, {0, Automatic}},
Magnification:>1.25 Inherited,
FrontEndVersion->"12.3 for Linux x86 (64-bit) (June 19, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"dc557b65-05f6-48e7-832e-2d734193289f"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 433152, 9394, 33300, "Input",ExpressionUUID->"a788c37d-0db0-4be2-bf7d-ae9035ab4fb8"]
}
]
*)

